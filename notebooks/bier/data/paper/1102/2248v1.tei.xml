<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2018-12-04T16:08+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Micro-pixel accuracy centroid displacement estimation and detector calibration</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2018-05-30">May 30, 2018</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Chengxing</forename><surname>Zhai</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Jet Propulsion Laboratory</orgName>
								<orgName type="institution">California Institute of Technology</orgName>
								<address>
									<postCode>91109</postCode>
									<settlement>Pasadena</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Mike</forename><surname>Shao</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Jet Propulsion Laboratory</orgName>
								<orgName type="institution">California Institute of Technology</orgName>
								<address>
									<postCode>91109</postCode>
									<settlement>Pasadena</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Renaud</forename><surname>Goullioud</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Jet Propulsion Laboratory</orgName>
								<orgName type="institution">California Institute of Technology</orgName>
								<address>
									<postCode>91109</postCode>
									<settlement>Pasadena</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Bijan</forename><surname>Nemati</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Jet Propulsion Laboratory</orgName>
								<orgName type="institution">California Institute of Technology</orgName>
								<address>
									<postCode>91109</postCode>
									<settlement>Pasadena</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Micro-pixel accuracy centroid displacement estimation and detector calibration</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2018-05-30">May 30, 2018</date>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Precise centroid estimation plays a critical role in accurate astrometry using telescope images. Conventional centroid estimation fits a template point spread function (PSF) to the image data. Because the PSF is typically not known to high accuracy due to wavefront aberrations and uncertainties in optical system, a simple Gaussian function is commonly used. PSF knowledge error leads to systematic errors in the conventional centroid estimation. In this paper, we present an accurate centroid estimation algorithm by reconstructing the PSF from well sampled (above Nyquist frequency) pixelated images. In the limit of an ideal focal plane array whose pixels have identical response function (no inter-pixel variation), this method can estimate centroid displacement between two 32×32 images to sub-micropixel accuracy. Inter-pixel response variations exist in real detectors, e.g. CCDs, which we can calibrate by measuring the pixel response of each pixel in Fourier space. The Fourier transforms of the inter-pixel variations of pixel response functions can be conveniently expressed in terms of powers of spatial wave numbers using their Taylor series expansions. Calibrating up to the third order terms in this expansion, we show that our centroid displacement estimation is accurate to a few micro-pixels using simulated data. This algorithm is applicable to the new proposed mission concept Nearest Earth Astrometry Telescope (NEAT) to achieve mirco-arcsecond accuracy in relative astrometry for detecting terrestrial exoplanets. This technology is also applicable to high precision photometry missions.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Consider an N ×N detector array with coordinate (m, n) labeling the pixel in m-th row and n-th column. Given the intensities I mn measured by pixels (m, n), m, n = 1, 2, · · · , N , a straight forward estimate of centroid is </p><p>where (x mn , y mn ) are the x and y coordinates of the center of pixel (m, n) and the summation is over all the pixels relevant to the centroid estimation. Typically only a small array of pixels is used for estimation because enlarging the size of array degrades the signal to noise ratio (SNR) significantly. The pixels at large distances from the center of the image detect very little photons but are heavily weighted by their large coordinates. Estimation (1) suffers systematic errors from using a relatively small array of pixels. The point spread function (PSF) fitting algorithms <ref type="bibr" target="#b0">[1]</ref> supersede this straight forward centroid estimation because it avoids amplification of noise from multiplying large coordinates. The main challenge for the PSF fitting approach is the knowledge of the PSF. Computing PSF using a diffraction model requires both knowledge of the optical system and wave front aberrations that both are usually hard to obtain. In the past, Gaussian functions has been popularly used <ref type="bibr" target="#b0">[1]</ref> However, in order to achieve a highly accurate centroid estimation, a more precise PSF is needed. Mighell has done work on PSF fitting using the digital images by using 21-point damped sinc interpolation <ref type="bibr" target="#b1">[2]</ref>. In this paper, we work along the same line to reconstruct the PSF from the pixelated images using the fact that the PSF is a bandwidth limited signal. Theoretically, bandwidth limited signal can be reconstructed to any accuracy as far as the sampling is above the Nyquist frequency and the number of the sample is sufficiently large. Using 32×32 images, the truncation error causes less than a micro-pixel error in centroid displacement estimation. Due to the complex micro-structure of detectors and charge diffusion effect between pixels, the pixel detection response varies over the physical detection area of a pixel <ref type="bibr" target="#b2">[3]</ref>, which is referred as intra-pixel variation. The pixel counts is a convolution of the pixel response function with the photon energy flux function. If each pixel has identical response function, pixel counts still represents a bandwidth limited function sampled at the pixel grid and thus the sampling theorem is still applicable for reconstructing an effective PSF for the detector. Past measurements found dominant intra-pixel detection variation is indeed common to pixels <ref type="bibr" target="#b3">[4]</ref>. For micro-pixel centroid estimation, we still need to take into account the inter-pixel differences of the pixel response functions. The inter-pixel response variations make the pixel counts no longer represent sample values of a strictly bandwidth limited function. To characterize interpixel variations, we use laser metrology to measure the pixel responses in Fourier space. It is convenient to parametrize the Fourier transforms of the pixel response functions in terms of powers of spatial wave numbers using their Taylor series expansions. The leading order effect of inter-pixel variations is the average pixel response or flat-field response, which can be measured as response to a uniform E-field. The first order correction is an effective geometric pixel location shift for each pixel. The second and third order corrections are quadratic and cubic polynomials of the spatial wave numbers. As we include more terms in the expansion, the model becomes more accurate and the centroid estimation becomes more accurate.</p><p>In this paper, we present results based on simulations to demonstrate the capability of calibrating the inter-pixel variations for performing micro-pixel level centroid estimations by including up to third order terms in the Taylor series expansion of the Fourier transforms of the pixel response functions. This algorithm can be utilized by the proposed mission NEAT <ref type="bibr" target="#b6">[7]</ref> to perform micro-arcsecond level relative astrometry with a one meter telescope and thus detect terrestrial exo-planets in habitable zone.</p><p>In addition to precise astrometry, our pixel calibration technique is also applicable to high precision photometry, which requires to characterize the pixel response functions. With the calibration of pixel responses and the reconstruction of PSF, the photometry is no longer sensitive to pointing errors and detector response variations, which limit the performance. Because we measure the pixel responses in Fourier space, it is especially convenient for studying photometry when the images are not too undersampled because we only need to measure the pixel response to a modest spatial frequency range to cover the bandwidth of the PSF.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Model and Algorithm description 2.1 Pixel intensity model description</head><p>To simplify the formulation, we assume that the image is stable over a sampling period so that the temporal integration by the detector is simply an overall factor of the duration of the sampling period.</p><p>The image is represented by photo-electron counts recorded by the pixels. A model describing the photo-electron counts recorded by pixel in the m-th row and n-th column is expressed as</p><formula xml:id="formula_1">I mn (x c , y c ) = ∞ −∞ dx ∞ −∞ dyI(x − x c , y − y c )Q mn (x, y)<label>(2)</label></formula><p>where Q mn (x, y) is the pixel response function (PRF) of pixel (m, n) to a point illumination at (x, y) in the detector plane <ref type="bibr" target="#b3">[4,</ref><ref type="bibr" target="#b4">5]</ref>, I(x, y) is an input intensity function, and (x c , y c ) is the location of the centroid of the image. For a point source, which we will consider exclusively, I(x, y) is the point spread function (PSF) related to the focal plane E-field via</p><formula xml:id="formula_2">I(x, y) = |E(x, y)| 2 .<label>(3)</label></formula><p>By Fourier optics, E(x, y) is related to the E-field at the input pupil of the telescope E i (x, y) via a Fourier transform</p><formula xml:id="formula_3">E(x, y) = N ∞ −∞ dx ∞ −∞ dy P (x , y )E i (x , y ) exp i2π λf (xx + yy ) (4)</formula><p>where N is a normalization factor, λ is the wavelength of the light, f is the focal length of the telescope, and P (x, y) is the aperture function, whose value is 1 inside the aperture and 0 outside the aperture. We will focus on monochromatic light case and briefly discuss about the polychromatic case in section 5. Polychromatic case requires one extra integral over the wave number, which makes the formulation slightly complicated. The main steps of derivation remain the same. Performing a change of variable (k x , k y ) = 2π/ (λf ) (x , y ), expression (4) becomes a two dimensional Fourier integral for E(x, y) as</p><formula xml:id="formula_4">E(x, y) = N λf 2π 2 ∞ −∞ dk x ∞ −∞ dk y P λf 2π k x , λf 2π k y E i λf 2π k x , λf 2π k y e i(kxx+kyy)<label>(5)</label></formula><p>where (k x , k y ) represents the spatial frequency. Because P (x, y) vanishes outside the aperture of the telescope, E(x, y) is a two dimensional bandwidth limited signal. By the theorem of convolution, the Fourier transform of I(x, y) is the Fourier transforms of E(x, y) convolved with its complex conjugate. Therefore, I(x, y) is also a bandwidth limited function with bandwidth being twice of that of E(x, y) from the process of convolution. Let D be the diameter of the aperture of the telescope, the bandwidth of I(x, y) is then limited by |k x | &lt; 2πD/(λf ), |k y | &lt; 2πD/(λf ). 1 Assuming the pixel size is smaller than the Nyquist sampling spacing f λ/(2D), by sampling theorem, the intensity function I(x, y) can be precisely reconstructed from a pixelated image given an infinitely large detection array. In practice, this is complicated by two things. First of all, we can not have infinite samples. Therefore, we have to truncate the reconstruction process at some finite size, which introduces truncation error. We found that for 32×32 array size (including about the 7th Airy ring) the truncation errors are small enough for micro-pixel centroid estimation. Secondly, the pixel intensity model involves pixel response functions Q mn (x, y), which depend on pixels. If Q mn (x, y) does not depend on pixels, as we will see later, the intensities measured still correspond to sampled values of a new bandwidth limited function at the pixel grid. Treating the new bandwidth limited function as an effective PSF, we can reconstruct it by sampling theorem. In fact, experiments found that the leading order intra-pixel variation is common for all the pixels <ref type="bibr" target="#b3">[4]</ref>. For micro-pixel level centrioding, however, we can not ignore the inter-pixel variations of Q mn (x, y). The pixel counts no longer strictly correspond to sampled values of a bandwidth limited function. Fortunately, the inter-pixel variation is only a small fraction of the total response, whose Fourier transform can be characterized by laser metrology fringe measurements.</p><p>1 In fact, it can be shown that the non-zero Fourier frequencies satisfies</p><formula xml:id="formula_5">k 2 x + k 2 y ≤ (2πD/(λf )) 2 .</formula><p>To illustrate this, we rewrite the pixel intensity model as</p><formula xml:id="formula_6">I mn (x c , y c ) = ∞ −∞ dx ∞ −∞ dy ∞ −∞ dk x ∞ −∞ dk y I(k x , k y )e i(kx(x−xc)+ky(y−yc)) Q mn (x, y) = ∞ −∞ dk x ∞ −∞ dk y I(k x , k y )e i(kx((m+1/2)a−xc)+ky((n+1/2)a−yc)) ∞ −∞ dx ∞ −∞ dyQ mn ((m+1/2)a+x, (n+1/2)a+y) e i(kxx+kyy) = ∞ −∞ dk x ∞ −∞ dk y I(k x , k y ) ˜ Q mn (k x , k y )e i[kx((m+1/2)a−xc)+ky((n+1/2)a−yc)]<label>(6)</label></formula><p>where</p><formula xml:id="formula_7">I(k x , k y ) is the Fourier transform of I(x, y) and˜Qand˜ and˜Q mn (k x , k y ) is defined by ˜ Q mn (k x , k y ) ≡ ∞ −∞ dx ∞ −∞ dy Q mn ((m+1/2)a+x, (n+1/2)a+y) e i(kxx+kyy) .<label>(7)</label></formula><p>The pixel response function related effects are all captured by the Fourier transform˜Qtransform˜ transform˜Q mn (k x , k y ).</p><p>For the case that all pixels have identical response function,</p><formula xml:id="formula_8">Q mn ((m+1/2)a+x, (n+1/2)a+y) = Q 00 (a/2+x, a/2+y) ;<label>(8)</label></formula><p>and Q mn (k x , k y ) no longer depends on indices m, n,</p><formula xml:id="formula_9">Q mn (k x , k y ) = Q 00 (k x , k y ) .<label>(9)</label></formula><p>Putting this in the expression (6), we obtain</p><formula xml:id="formula_10">I mn (x c , y c ) = ∞ −∞ dk x ∞ −∞ dk y I(k x , k y )Q 00 (k x , k y )e i(kx((m+1/2)a−xc)+ky((n+1/2)a−yc)) .<label>(10)</label></formula><p>Defining an effective PSF ¯ I(x, y)</p><formula xml:id="formula_11">¯ I(x, y) ≡ ∞ −∞ dk x ∞ −∞ dk y I(k x , k y )Q 00 (k x , k y )e i(kxx+kyy) ,<label>(11)</label></formula><formula xml:id="formula_12">I mn (x c , y c ) corresponds to values of function ¯ I(x, y) at grid points (x, y)= ((m+1/2)a−x c , (n+1/2)a−y c ), m, n = 0, ±1, ±2, · · ·. Because I(k x , k y ) vanishes for |k x | ≥ 2πD/(λf ) or |k y | ≥ 2πD/(λf ), ¯</formula><p>I(x, y) is bandwidth limited and the sampling theorem is applicable for reconstructing the effective PSF ¯ I(x, y) using I mn (x c , y c ).</p><p>In general, response function</p><formula xml:id="formula_13">Q mn (x, y) depends on (m, n). It is useful to define an average response function ¯ Q(x, y) ¯ Q(x, y) ≡ 1 N 2 m,n Q mn ((m + 1/2)a + x, (n + 1/2)a + y) .<label>(12)</label></formula><p>and its Fourier transform˜¯ transform˜transform˜¯</p><formula xml:id="formula_14">Q(k x , k y ) ≡ dx dy ¯ Q(x, y)e i(kxx+kyy) .<label>(13)</label></formula><p>Because the common intra-pixel response function does not affect the property of being sampled values of a bandwidth limited signal, it is convenient to factor out the common pixel response to parametrize the pixel dependent terms as</p><formula xml:id="formula_15">˜ Q mn (k x , k y )/ ˜ ¯ Q(k x , k y ) = q mn e ikx∆xmn+iky∆ymn 1 + α mn k 2 x + β mn k 2 y + γ mn k x k y + a mn k 3 x + b mn k 2 x k y + c mn k x k 2 y + d mn k 3 y + · · · ,<label>(14)</label></formula><p>where q mn represents the flat field response of pixel (m, n), ∆x mn and ∆y mn represent effective geometric pixel location shifts along x and y directions for pixel (m, n) to deviate from a regular pixel grid location ((m + 1/2)a, (n + 1/2)a). α mn , β mn , γ mn are parameters specifying quadratic behavior in the amplitude of Q mn (k x , k y ) that are pixel dependent. a mn , b mn , c mn , d mn are third order term coefficients. This parametrization is based on a Tayler series expansion of˜Qof˜ of˜Q mn (k x , k y ) in terms of polynomials of k x and k y .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Centroid displacement estimation algorithm</head><p>We now turn to present the algorithm for estimating the centroid displacement between two images. The main idea is to resample one of the two images at a grid shifted from the default grid by an offset. When the resampled image best matches the second image, the offset at which we resampled the first image is the estimated centroid displacement. We call the first image (the image to be resampled) reference image.</p><p>Based on pixel grids, we use the following discrete frequencies</p><formula xml:id="formula_16">(k j , k l ) = 2π N a (j, l) , j = −N/2, · · · , 0, 1, N/2 − 1 , l = −N/2, · · · , 0, 1, N/2 − 1 .<label>(15)</label></formula><p>With this, our model is expressed as</p><formula xml:id="formula_17">I mn (x c , y c ) = N/2−1 j=−N/2 N/2−1 l=−N/2 M jl˜Q jl˜ jl˜Q mn (k j , k l ) ˜ ¯ Q(k j , k l ) e ik j [(m+1/2)a−xc]+ik l [(n+1/2)a−yc]<label>(16)</label></formula><p>where</p><formula xml:id="formula_18">M jl = I(k j , k l ) ˜ ¯ Q(k j , k l ) .<label>(17)</label></formula><p>Pixel response calibration measures˜Qmeasures˜ measures˜Q mn (k x , k y )/ ˜ ¯ Q(k x , k y ) at a set of spatial frequencies covering the bandwidth of PSF. It is convenient to parametrize˜Qparametrize˜ parametrize˜Q mn (k x , k y )/ ˜ ¯ Q(k x , k y ) using low order terms in expression <ref type="bibr">(14)</ref>. If keeping the terms up to the third power, we have then parameters q mn , ∆x mn , ∆y mn , α mn , β mn , γ mn , a mn , b mn , c mn , d mn . They can be estimated by fitting expansion <ref type="formula" target="#formula_0">(14)</ref> to calibration measurements, which are values at a set of spatial frequencies pre-determined by the metrology system for pixel response calibration.</p><p>To reconstruct the PSF, we need to estimate M jl . Let us choose the coordinate so that the centroid of the reference image is at the origin, i.e. x c = 0, y c = 0 and its pixel intensities are represented by I 0 mn . Detector calibration measures flat pixel responses q mn , effective pixel offsets ∆x mn , ∆y mn , quadratic amplitude coefficients α mn , β mn and γ mn , and the third order phase parameters a mn , b mn , c mn , d mn . Relation (16)</p><formula xml:id="formula_19">I 0 mn = N/2−1 j=−N/2 N/2−1 l=−N/2 M jl˜Q jl˜ jl˜Q mn (k j , k l ) ˜ ¯ Q(k j , k l ) e ik j (m+1/2)a+ik l (n+1/2)a<label>(18)</label></formula><p>can be inverted to solve for M jl , which is the frequency representation of the image. We use expression (16) to resample the reference image. The centroid displacement of the second image I mn relative to the first image can be estimated by solving a weighted nonlinear least-squares fitting as</p><formula xml:id="formula_20">(x c , y c ) = min xc,yc mn |I mn − I mn (x c , y c )| 2 W mn<label>(19)</label></formula><p>where W mn is weight factor for pixel (m, n). The choice of W mn affects sensitivity to noise. Here we simply use equal weights and save optimizing the weights to achieve best noise sensitivity as a future topic.</p><p>When we use discrete frequencies (15), the signal is parametrized as periodical function in space with period N a. For N = 32, the image encircles the 7th Airy ring; the PSF is small enough at the boundary so that the truncation error is negligible.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Pixel response calibration using laser metrology</head><p>We measure the pixel response functions in Fourier space by observing the response of the detector to a sinusoidal intensity illumination pattern. The sinusoidal pattern is generated by fringes from interfering two laser metrology beams far away so that the wavefront is close to a plane wave over the spatial extension of the detector. To make the identification of the laser fringes easier, we use Acoustic Modulation Oscillator (AMO) to offset one of the laser's frequency from the other by a few Hz so that the fringes move across the CCD. Therefore, the illuminating intensity may be modeled as</p><formula xml:id="formula_21">I(x, y, t) = I met 1 + I met 2 + 2 I met 1 I met 2 Ree i(k met x x+k met y y+∆ωt) ,<label>(20)</label></formula><p>where I met 1 and I met 2 are the intensities of the two lasers, (k met x , k met y ) is the spatial wave number of the laser fringes, and ∆ω is the angular frequency difference between the two lasers introduced by the AMO. The output counts of pixel (m, n) is then</p><formula xml:id="formula_22">I met mn (t) = dx dy I(x, y, t)Q mn (x, y) = (I met 1 +I met 2 ) ˜ Q mn (0, 0)+2 I met 1 I met 2 Re˜Q Re˜ Re˜Q mn (k met x , k met y )e i(k met x (m+1/2)a+k met y (n+1/2)a+∆ωt) ,<label>(21)</label></formula><p>where we have used the definition (7). The temporal variation of the intensity at each pixel is a sinusoidal function plus a constant. By estimating the amplitude and phase of the sinusoidal temporal variation, we get the complex Fourier transform˜Qtransform˜ transform˜Q mn (k met x , k met y ) because the overall intensities of the two metrology beams I met 1 and I met 2 can be easily measured. By having different separations between the laser beams and distances between the laser source and the CCD, we can generate fringes of different spatial frequencies and thus measure˜Qmeasure˜ measure˜Q mn (k met x , k met y ) at various values of (k met x , k met y ). Note that we only need to measure the Fourier transform of the the pixel response functions to the highest frequency in the PSF, which is limited by the aperture size of the optics. For Nyquist sampled images, it is only necessary to measure the spatial frequency to π/a, where a is the spacing between pixels.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Results using simulated data</head><p>We use simulated data to validate our concept of the algorithm. In subsection 4.1, we first show that for an ideal detector whose pixels have the same response function, we can achieve sub-micro-pixel level accuracy in centroid estimation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Results for an ideal detector</head><p>In our simulation, the diameter of the telescope D=1m with focal length f = 40m to be consistent with NEAT <ref type="bibr" target="#b6">[7]</ref>. We focus on monochromatic source with the wavelength λ = 600nm. In section 5, we discuss the case of polychromatic source. We only consider an array of 32×32 pixels, i.e. the dimension N=32 because this is sufficient for achieving micro-pixel centroid estimation. The corresponding λ/D at the focal plane is 24µm. The pixel size is 10µm, which samples above the Nyquist frequency (1/(12µm)). All the pixels have the same pixel response function, which is displayed in the left plot in <ref type="figure" target="#fig_1">Fig. 1</ref>. It is modeled as a Gaussian function multiplied by low order polynomials (up to 4th order),</p><formula xml:id="formula_23">Q(x, y) = exp(−(x 2 + y 2 )/r 2 g ) c 0 + c 1 x + c 2 y + c 3 x 2 + c 4 y 2 + c 5 xy + · · ·<label>(22)</label></formula><p>where x, y are coordinates in the detector plane in unit of pixel, r g = 0.5, and the coefficients c i are drawn from Gaussian random number generators with standard deviation being 0.05. The mean values are all 0 except for c 0 whose mean is 0.8. This pixel response function is roughly similar to the the intra-pixel variation for a backside-illuminated CCD <ref type="bibr" target="#b5">[6]</ref>. We include λ/20 RMS low order wavefront aberrations parametrized by the first 15 Zernike polynomials, whose amplitudes are randomly generated. The right plot in <ref type="figure" target="#fig_1">Fig. 1</ref> displays the phase aberration over the telescope pupil used in our simulation. The two plots (left for X centroid and right for Y centroid) in <ref type="figure" target="#fig_3">Fig. 2</ref> displays the centroid estimation errors for a grid of X and Y offsets between the two images within range [-0.5, 0.5] pixel. These errors are due to truncation and are no more than 0.1 micro-pixel.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Pixel response calibration and results</head><p>For realistic detectors, pixel response functions vary from pixel to pixel, which we call inter-pixel variations. Pixel response calibration measures the pixel response functions of all the pixels. The Fourier transforms˜Qtransforms˜ transforms˜Q mn (k x , k y ) of the pixel response functions Q mn (x, y) of all pixels are measured at various spatial frequencies. To do this, we illuminate the detector using a cosine intensity pattern. For NEAT, this is achieved by interfering two metrology lasers at various spatial frequencies . The fringe pattern gives a sinusoidal illumination on the pixel array and the separation of the two lasers determines the wavelengths of the fringes. AMO is used to offset the frequency of one laser from the other by a few Hz. The temporal variation of the pixel intensities are then used to estimate Fourier transforms˜Qtransforms˜ transforms˜Q mn (k x , k y ) as discussed in section 3. We use expansion <ref type="formula" target="#formula_0">(14)</ref> to parametrize˜Qparametrize˜ parametrize˜Q mn (k x , k y ). For micro-arcsecond accuracy, we nominally keep the terms up to second order or third order in k x and k y .</p><p>To simulate the inter-pixel response variations, we make the low order coefficients c i in Eq.  Gaussian random number generators with standard deviation being 0.01. We also add 2% white noise to the pixel response as a multiplicative factor as well as random geometric pixel location shifts for all the pixels along both x and y directions with 0.01 pixel RMS. The left plot in <ref type="figure" target="#fig_5">Fig. 3</ref>  to the phase of the estimated Fourier transform˜Qtransform˜ transform˜Q mn (k met x , k met y ) at different values of spatial frequency (k met x , k met y ) available from the metrology system. <ref type="figure" target="#fig_7">Fig. 5</ref> displays the estimated the effective pixel location deviating from a regular grid. Now the errors shown in <ref type="figure" target="#fig_8">Fig. 6</ref> are significantly reduced to tens of micro-pixels after including the effective pixel locations in estimation. However, the errors are still large for micropixel level astrometry. We further include the second order amplitude terms in expansion <ref type="formula" target="#formula_0">(14)</ref> and estimate coefficients α mn , β mn , and γ mn by fitting expansion <ref type="formula" target="#formula_0">(14)</ref> to the estimated Fourier transforms˜Q transforms˜ transforms˜Q mn (k met x , k met y ) at different values of (k met x , k met y ). The second order coefficients are displayed in <ref type="figure" target="#fig_9">Fig. 7</ref>. The two plots in <ref type="figure" target="#fig_10">Fig. 8</ref> displays the centroid estimation errors for performing pixel response calibration that estimates the flat field response, the effective pixel locations, and the second order amplitude corrections. Including the third order terms in expansion <ref type="bibr">(14)</ref> in our pixel response calibration enables us to achieve centroid estimation accuracy to be a few micro-pixels over [0.5, 0.5] pixel range along both x and y directions. The corresponding coefficients are displayed in <ref type="figure" target="#fig_11">Fig. 9</ref>. <ref type="figure" target="#fig_1">Fig. 10</ref> shows systematic centroid displacement estimation errors for including through the third order phase terms. The RMS is only a few micro-pixels.         </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Noise sensitivity</head><p>So far, we have not included any noise. We now study the sensitivity to photon shot noise, which is the dominant source of random errors. We set the total number of photons for each image to be 10 8 and use Poisson random number generator to simulate the photon shot noise. We simulated 1000 images with their centroid positions randomly distributed within ± 0.5 pixel relative to a reference image along both x and y directions. The reference image have the same level of photon and shot noise. <ref type="figure" target="#fig_1">Fig. 11</ref> displays the Allan deviation of the estimated centroid displacements relative to a reference image as function of the total number of photons integrated. The green dash line shows an empirical sensitivity formula</p><formula xml:id="formula_24">σ ≈ 1.5/ N ph<label>(23)</label></formula><p>for uncertainty of centroid estimation using an equal weight in the least-squares fitting, where N ph is the total number of photons. To reach 10 mirco-pixel precision, we shall need about 2.2×10 10 photons. The Allan deviation shows the variation between 1000 images with respect to the same reference image. How does the noise in the reference image affect the results? It turns out that the noise in the reference image causes mostly an overall offset to all the centroid displacements, or it is an excellent approximation that</p><formula xml:id="formula_25">d(A, R 1 ) − d(B, R 1 ) ≈ d(A, R 2 ) − d(B, R 2 ) ,<label>(24)</label></formula><p>where d(A, R 1 ) represents the displacement of centroid of image A relative to reference image R 1 and so on. <ref type="figure" target="#fig_1">Fig. 12</ref> shows the centroid displacements relative to two reference images, which are the same image with two different realization of photon noise. It is easy to see that the difference of the centroid displacements is insensitive to the uncertainties in the reference image( less than 1 micro-pixel). We are performing an equal weight least-squares fitting, it is possible to optimize weights W mn to achieve the best sensitivity to noise, which will be a subject for future study.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Wave front stability</head><p>In this section, we study the sensitivity of our algorithm to wave front changes, i.e. the two images are taken with slightly different wavefront aberrations. The left plot in <ref type="figure" target="#fig_1">Fig. 13</ref> shows a low order small wavefront change with λ/1350 RMS. (High order wave front aberrations generates speckles in the image <ref type="figure" target="#fig_1">Figure 12</ref>: X centroid displacement error using reference image with different noise realizations.</p><p>plane while the low order wavefront change generates a change in the shape of the PSF. For PSF fitting, the centriod estimation is more sensitive to low order wavefront aberrations.) The main effect of a wavefront change between the two images is an overall constant, which is not a problem for differential astrometry. However, this overall constant depends on the pixel response functions. We shall need to show that this pixel dependency in the overall constant is small so that it is common for different portions of the detector. To do this, we instantiate a second detector whose pixel response function is slightly different from our nominal detector as a result of the random feature of our simulation. The right plot in <ref type="figure" target="#fig_1">Fig. 13</ref> shows the difference of the pixel responses between the two cameras which comes from the randomly instantiated low order polynomials. We now consider the case where the wavefront changes by an amount of λ/1350 RMS, as shown in the left plot in <ref type="figure" target="#fig_1">Fig. 13</ref>, between taking the two images whose centroid displacement we are interested to estimate. <ref type="figure" target="#fig_1">Fig. 14</ref> displays the centroid displacement errors due to the λ/1350 RMS low order wavefront change for a grid of centroid offsets between the two images. The main effect of a wavefront change between the two images is an overall constant independent of the actual displacement between the two images; the variation is only a few micro-pixels. If the overall constant is common for both stars, this effect cancels for differential astrometry.</p><p>Because the images of the two stars are at different locations in the focal plane array, we examine whether the different pixel response functions at different portions of the detector coupled with the wavefront change leads to significant error. <ref type="figure" target="#fig_1">Fig. 15</ref> displays the centroid errors for using the second detector. To avoid common error cancellation, we put the reference image at [0.25, 0.25]pixel instead of <ref type="bibr">[0,</ref><ref type="bibr">0]</ref> pixel as for the first detector. Again, we can see that the dominant effect of wavefront change between the two images is an overall offset in the centroid estimation. Because the overall offset is not sensitive to the difference between two detectors, the overall differential displacement caused by the wavefront difference cancels leaving a residual of a few micro-pixel RMS. See      </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Polychromatic effect</head><p>In this section, we discuss the polychromatic effect. For white light source like stars, image intensity model (6) needs an extra integration over the photon wavelengths weighed with the source spectrum,</p><formula xml:id="formula_26">I mn (x c , y c ) = ∞ −∞ dk x ∞ −∞ dk y ∞ 0 dλS(λ)I(k x , k y , λ) ˜ Q mn (k x , k y , λ)e i[kx((m+1/2)a−xc)+ky((n+1/2)a−yc)]</formula><p>(25) where S(λ) is the source spectral energy density function and we have included the wavelength dependencies in Fourier transforms of the monochromatic PSF function I(k x , k y , λ) and the pixel detection functioñ Q mn (k x , k y , λ). As a leading order approximation, we ignore the spectral dependency in the pixel detection function. The broadband image model has the same expression as the monochromatic model with the following replacement</p><formula xml:id="formula_27">I(k x , k y ) → ∞ 0 dλS(λ)I(k x , k y , λ) .<label>(26)</label></formula><p>Because the integral over the photon wavelength is a linear operation, the polychromatic signal is still a bandwidth limited signal, whose bandwidth is determined by the shortest wavelength. As far as the pixelated images are Nyquist sampled, our algorithms works as for the case of monochromatic source. <ref type="figure" target="#fig_1">Fig. 17</ref> displays the centroid offset estimation errors for simulated chromatic pixelated images pairs displaced by various offsets along x and y directions assuming an ideal tophat pixel response detection. We note that the error is sub-micro pixel. A slight complication comes from the dependency of pixel response on the wavelength, which requires pixel response calibration using metrology at multiple wavelengths. The results in reference <ref type="bibr" target="#b5">[6]</ref> for backside illuminated CCD shows weak dependency on the wavelengths especially at the longer wavelength. Because we only need to calibrate the pixel to pixel variations of the pixel response functions, for differential astrometry, only the spectral dependency in the inter-pixel variations of the response functions coupled with the star spectral difference could cause systematic errors. We expect this effect to be small in general and can be calibrated using laser metrology at a few wavelengths. We defer the study of this to a future work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">Conclusions</head><p>We have presented a systematic frame work for accurate centroid displacement estimation and detector characterization. For an ideal detector with all the pixels having the same pixel response function, the PSF can be accurately reconstructed without any detector calibration. For realistic detectors whose pixel response functions share a dominant common portion and small pixel to pixel variations, it is possible to measure the pixel responses functions in Fourier space using laser metrology fringes. Measuring the pixel response in Fourier space is especially convenient for well sampled images. Keeping a few low order terms (e.g. 3rd order) in the Taylor series expansion of the Fourier transform in wave numbers, we can achieve centroid estimations accurate to a few micro-pixels. This enables micro-arcsecond level astrometry using telescope images of stars and thus detect earth-like exo-planets. This method is also applicable to precise photometry.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">Acknowledgments</head><p>This work was prepared at the Jet Propulsion Laboratory, California Institute of Technology, under a contract with the National Aeronautics and Space Administration.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>ˆ</head><label></label><figDesc>x c = m,n x mn I mn mn I mn , ˆ y c = m,n y mn I mn mn I mn ,</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: A common pixel response function for all the pixels used in the simulation (left) and low order phase aberration (right) in radian used in simulation with RMS ∼ λ/20.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>(22) pixel dependent by replacing c i with c i + c mn i , where c mn i are random numbers drawn from zero mean</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: Centroid offset estimation errors X (left) and Y (right) in micro-pixel unit for an ideal CCD and wave front with λ/20 RMS low order aberrations parametrized by the first 15 Zernike polynomials. The pixel size is 10µm.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><label></label><figDesc>displays a typical intra pixel responses of a 10×10 pixel array at the upper left corner of the 32×32 array. Here the interpixel cross talk from diffusion is not displayed to avoid overlap. The zeroth order calibration measures the pixel response to a flat field, i.e. Fourier transform of the pixel response function at spatial wave number (k x , k y ) = (0, 0). The right plot in Fig. 3 displays a typical flat field calibration results. Fig. 4 shows systematic centroid displacement estimation errors with only flat field response calibration for different centroid offsets between the two images, whose range is [-0.5, 0.5] pixel along both x and y directions. The next level of calibration measures the effective pixel locations deviating from a regular grid. The effective location of pixel (m, n) is estimated by fitting ∆x mn k met x + ∆y mn k met y</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 3 :</head><label>3</label><figDesc>Figure 3: Simulated intrapixel detection variation for a 10×10 array (left) and flat field response calibration result 32×32 (right).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: Centroid offset estimation errors X (left) and Y (right) in micro-pixel unit. The wavefront error is λ/20 specified by the first 15 Zernikes polynomials. Only a flat field calibration is applied.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: Effective pixel offsets along x (left) and y directions, the units are pixel</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 6 :</head><label>6</label><figDesc>Figure 6: Centroid offset estimation errors X (left) and Y (right) in micro-pixel unit. The wavefront error is λ/20 specified by the first 15 Zernikes polynomials. A flat field and pixel effective location calibration is applied.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Figure 7 :</head><label>7</label><figDesc>Figure 7: Second order amplitudes α mn (left), β mn (middle), and γ mn (right), coefficients for terms k 2 x , k 2 y , and k x k y .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Figure 8 :</head><label>8</label><figDesc>Figure 8: Centroid offset estimation errors X (left) and Y (right) in micro-pixel unit. The wavefront error is λ/20 specified by the first 15 Zernikes polynomials. Calibration includes second order terms.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Figure 9 :</head><label>9</label><figDesc>Figure 9: Third order term coefficients, ak 3 x (top, left), bk 2 x k y (top, right), ck x k 2 y (bottom, left), and dk 3 y</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Figure 10 :</head><label>10</label><figDesc>Figure 10: Centroid offset estimation errors X (left) and Y (right) in micro-pixel unit. The wavefront error is λ/20 specified by the first 15 Zernikes polynomials.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13"><head>Figure 11 :</head><label>11</label><figDesc>Figure 11: Centroid estimation error Allan deviations vs number of photons integrated.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_14"><head>Fig. 16 .</head><label>16</label><figDesc></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15"><head>Figure 13 :</head><label>13</label><figDesc>Figure 13: Pixel response difference between two detectors in a 10×10 array (left). Wavefront variations between two observations, RMS ∼ λ/1350, simulated by low order polynomials with randomly generated coefficients.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_16"><head>Figure 14 :</head><label>14</label><figDesc>Figure 14: Centroid displacement estimation errors X (left) and Y (right) in micro-pixel unit. Both images are taken with a common low order wavefront error of λ/20 RMS specified by the first 15 Zernikes polynomials. The low order wavefront difference between the two images has RMS ∼ λ/1350.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_17"><head>Figure 15 :</head><label>15</label><figDesc>Figure 15: Centroid estimation errors X (left) and Y (right) in micro-pixel unit for the second detector. The images are taken with a common low order wavefront error of λ/20 RMS specified by the first 15 Zernikes polynomials and a differential low order wavefront error of RMS λ/1350.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_18"><head>Figure 16 :</head><label>16</label><figDesc>Figure 16: The difference between the centroid displacement estimation errors X (left) and Y (right) in micropixel unit for two different simulated detectors. For each detector, the images are taken with a common low order wavefront error of λ/20 RMS specified by the first 15 Zernikes polynomials and a differential low order wavefront error of RMS λ/1350.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_19"><head>Figure 17 :</head><label>17</label><figDesc>Figure 17: The estimation errors of the centroid offsets for broadband images.</figDesc></figure>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">A comparison of digital centering algorithms</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">C</forename><surname>Stone</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">AJ</title>
		<imprint>
			<biblScope unit="volume">97</biblScope>
			<biblScope unit="page">1227</biblScope>
			<date type="published" when="1989" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Stellar photometry and astrometry with discrete point spread functions</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">J</forename><surname>Mighell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">MNRAS</title>
		<imprint>
			<biblScope unit="volume">361</biblScope>
			<biblScope unit="page" from="861" to="878" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">The non-uniformity of CCD&apos;s and the effects of spatial undersampling</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">R</forename><surname>Jorden</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J.-M</forename><surname>Deltron</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">P</forename><surname>Oates</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. SPIE</title>
		<meeting>SPIE</meeting>
		<imprint>
			<date type="published" when="1994" />
			<biblScope unit="volume">2198</biblScope>
			<biblScope unit="page">836</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Subpixel sensitivity map for a charge-coupled device sensor</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Kavaldjiev</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Ninkov</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optical Engineering</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page">948</biblScope>
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Influence of nonuniform charge-coupled device pixel response on aperture photometry</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Kavaldjiev</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Ninkov</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optical Engineering</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page">162</biblScope>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Subpixel sensitivity maps for a back-illuminated charge-coupled device and the effects of nonuniform response on measurement accuracy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Piterman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Z</forename><surname>Ninkov</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optical Engineering</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page">1192</biblScope>
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">High precision astrometry mission for the detection and characterization of nearby habitable planetary systems with the Nearby Earth Astrometric Telescope (NEAT)</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Malbet</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proposal to the 2010 ESA Cosmic Vision call for M mission</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
