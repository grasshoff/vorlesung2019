<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2018-12-04T16:13+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Kalman filtering techniques for focal plane electric field estimation</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Tyler</forename><forename type="middle">D</forename><surname>Groff</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Depatment of MAE</orgName>
								<address>
									<addrLine>EQuad, Olden St Princeton</addrLine>
									<postCode>08544</postCode>
									<region>NJ</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">Jeremy</forename><surname>Kasdin</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Depatment of MAE</orgName>
								<address>
									<addrLine>EQuad, Olden St Princeton</addrLine>
									<postCode>08544</postCode>
									<region>NJ</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Kalman filtering techniques for focal plane electric field estimation</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>For a coronagraph to detect faint exoplanets, it will require focal plane wavefront control techniques to continue reaching smaller angular separations and higher contrast levels. These correction algorithms are iterative and the control methods need an estimate of the electric field at the science camera, which requires nearly all of the images taken for the correction. The best way to make such algorithms the least disruptive to science exposures is to reduce the number required to estimate the field. We demonstrate a Kalman filter estimator that uses prior knowledge to create the estimate of the electric field, dramatically reducing the number of exposures required to estimate the image plane electric field while stabilizing the suppression against poor signal-to-noise (SNR). In addition to a significant reduction in exposures, we discuss the relative merit of this algorithm to estimation schemes that do not incorporate prior state estimate history, particularly in regard to estimate error and covariance. Ultimately the filter will lead to an adap-tive algorithm which can estimate physical parameters in the laboratory for robustness to variance in the optical train.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>The desire to directly image extrasolar terrestrial planets has motivated much research into space-based missions. One approach proposed for direct imaging in visible to near-infrared light is a coronagraph, which use internal masks and stops to change the point spread function of the telescope, creating regions in the image of high contrast where a dim planet can be seen. However, coronagraphs possess an extreme sensitivity to wavefront aberrations generated by the errors in the system optics. This necessitates wavefront control algorithms to correct for the aberrations and relax manufacturing tolerances and stability requirements within the observatory. Of the two, stability is of particular importance as noted by Shaklan <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b1">2]</ref>. In this paper we discuss the challenges associated with wavefront estimation and control using deformable mirrors (DMs) in a coronagraphic imager, and how we can improve the robustness of such a system to observatory instability. Advances in these correction algorithms have primarily focused on development of the controller, by choosing some criterion that decides how best to suppress aberrations given an estimate of the electric field at that point in time. This estimate is found by modulating the system in a predicable fashion so that there is adequate phase modulation to solve for the expected value of the electric field at the image plane. Whether this modulation is from observations at multiple planes, or by modulating the the surface of a DM, the observations are made in the presence of the all prior control signals sent to the DMs. Since existing estimation schemes do not predict the effect of a perturbation induced by the DM they must abandon all prior knowledge of the electric field estimate, and as such require a large number of images to reconstruct the estimate. By utilizing both prior estimates and the control history we develop a method that requires fewer images to update the estimate, simultaneously improving the efficiency of the correction algorithm and its robustness to observatory instability. The High Contrast Imaging Laboratory (HCIL) at Princeton tests coronagraphs and wave-front control algorithms for quasi-static speckle suppression. The collimating optic is a six inch off-axis parabola (OAP) followed by two DMs in series and a coronagraph, which is imaged with a second six inch OAP <ref type="figure" target="#fig_0">(Fig. 1)</ref>. We use a shaped pupil coronagraph, shown in <ref type="figure" target="#fig_1">Fig. 2</ref>(a), and described in detail in Belikov et al. <ref type="bibr" target="#b2">[3]</ref>. This coronagraph produces a discovery space with a theoretical contrast of 3.3×10 −10 in two 90 • regions as shown in <ref type="figure" target="#fig_1">Fig. 2(b)</ref>. At the Princeton HCIL, the aberrations in the system result in an uncorrected average contrast of ∼ 1 × 10 −4 in the area immediately surrounding the core of the point spread function (PSF), which agrees with the simulations shown in <ref type="figure" target="#fig_1">Fig. 2(d)</ref>. Since the coronagraph is a binary mask, its contrast performance is fundamentally achromatic, subject only to the physical scaling of the PSF with wavelength. The figures are in a log scale, and the log of contrast is shown in the colorbars.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Experimental Setup: Princeton High Contrast Imaging Laboratory</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Modeling the HCIL</head><p>The estimation and control algorithms in this paper are dependent on a model of the optical system, specifically the transfer function between the DM and image plane. We detail a common approach to this mapping, where the field is linearized to describe the problem as discrete perturbations beginning at the pupil plane <ref type="bibr" target="#b3">[4]</ref><ref type="bibr" target="#b4">[5]</ref><ref type="bibr" target="#b5">[6]</ref><ref type="bibr" target="#b6">[7]</ref><ref type="bibr" target="#b7">[8]</ref><ref type="bibr" target="#b8">[9]</ref>. Most commonly, the field is linearized about the current DM surface shape. In the Princeton HCIL neither DM is conjugate to the pupil plane, requiring that we account for this propagation in our model. Beginning with arbitrary complex aberrated field, g(u, v), incident on arbitrary aperture, A(u, v), and a phase perturbation induced by the DM surface, ˜ φ(u, v), the field at the DM plane is given by</p><formula xml:id="formula_0">E 0 (u, v) = A(u, v)(1 + g(u, v))e i ˜ φ(u,v) .<label>(1)</label></formula><p>The DM perturbation commanded by the controller, φ(u, v), will be added to the prior (also referred to as "nominal") DM shape, φ 0 (u, v), so that˜φthat˜ that˜φ = φ + φ 0 . Linearizing about the nominal DM shape, the field at the pupil plane is given by</p><formula xml:id="formula_1">E 0 (u, v) ∼ = A(u, v)e iφ 0 (1 + g(u, v) + iφ(u, v)).<label>(2)</label></formula><p>The resultant image plane electric field, E im (x, y), is described by an arbitrary linear operator, C{·}, as</p><formula xml:id="formula_2">E im (x, y) = C{E 0 (u, v)} (3) = C{A(u, v)e iφ 0 } + C{A(u, v)e iφ 0 g(u, v)} + iC{A(u, v)e iφ 0 φ(u, v)}.<label>(4)</label></formula><p>The intensity distribution of this field is given by</p><formula xml:id="formula_3">I im (x, y) = C{A(u, v)e iφ 0 } + C{A(u, v)e iφ 0 g(u, v)} + iC{A(u, v)e iφ 0 φ(u, v)}. 2 .<label>(5)</label></formula><p>Rewriting Eq. 5 as an inner product and absorbing e iφ 0 into C{·}, the intensity distribution in the image plane is represented as</p><formula xml:id="formula_4">I im =&lt; C{Aφ}, C{Aφ} &gt; +2{&lt; C{A(1 + g)}, iC{Aφ} &gt;} + &lt; C{A(1 + g)}, C{A(1 + g)} &gt; .<label>(6)</label></formula><p>It is important to note that to re-linearize about the current DM shape at any control step, k, C{·} must be re-evaluated. Fortunately, this is as simple as convolving C{e iφ k−1 } with each component of Eq. 6. For the estimator we impose a scalar inner product to each element in the two-dimensional plane, (x, y), to compute the intensity distribution across the image plane. For the control algorithm we seek an average contrast value inside the dark hole as a metric for the control law. Thus, we impose a matrix inner product to describe the image plane electric field, C{Ag}, and the DM control effect, C{Aφ}, our state and control variables respectively, as column matrices. These are formed by stacking the columns of the two-dimensional fields to create a single column matrix. However, we have yet to parameterize the DM commands into a control matrix, u. At the moment we could solve for C{Aφ} but what we seek are actuation commands for the DM, not its field at the image plane. To solve for the actuator commands, we introduce a physical model of the DM to directly optimize the amplitude of each DM actuator. Letting H(x, y) be the height of the DM surface, the resulting phase perturbation induced by the DM, φ(u, v), is</p><formula xml:id="formula_5">φ(u, v) = 2π λ 0 H(x, y).<label>(7)</label></formula><p>For control, we wish to describe H(x, y) as a combination of the two-dimensional height maps imposed by each actuator. Since we are using a DM with a continuous face sheet, the contribution of any actuator will be highly localized but still deforms the entire DM surface. As a result, we must describe the contribution of the q th actuator as a two-dimensional phase map over the entire plane of the DM surface, h q (x, y). The combination of all actuators is nonlinear, and very complicated to compute <ref type="bibr" target="#b9">[10]</ref>, but in the presence of small aberrations our deformations will be small. Thus, we assume that superposition of actuators is valid and describe H(x, y) as a sum of h q (x, y) over all actuators, N act . The phase contribution of the DM is then given by</p><formula xml:id="formula_6">φ(u, v) = 2π λ 0 Nact q=1 h q (u, v).<label>(8)</label></formula><p>Finally, we wish to make our control matrix, u, a column matrix made up of the control signal from each actuator, u q . To do so we describe h q (u, v) as a characteristic shape with unitary amplitude, commonly referred to as an influence function, f q (u, v). To find h q (u, v) we simply multiply f q (u, v) by the control amplitude, a q . Describing h q (u, v) with influence functions, the phase perturbation induced by the DM is</p><formula xml:id="formula_7">φ(u, v) = 2π λ 0 Nact q=1 a q f q (u, v),<label>(9)</label></formula><p>which sums the q th 2-D phase map, or influence function f q (u, v), for all N act actuators to reconstruct φ(u, v). The strength of each influence function is determined by a q . Substituting Eq. 9 into Eq. 6, we write C{Aφ} = C{Af }u, where u is a column matrix of actuator strengths, u = [a 1 . . . a k ] T , and C{Af } can be written as a matrix of dimension N pix × N act . To simplify the notation we define this matrix as the control effect matrix,</p><formula xml:id="formula_8">G = C{Af } ∈ [N pix × N act ].<label>(10)</label></formula><p>This allows us to write</p><formula xml:id="formula_9">&lt; C{Aφ}, C{Aφ} &gt;= u T G * Gu,<label>(11)</label></formula><p>where * denotes the conjugate transpose. Applying the matrix form of the control amplitudes to Eq. 6, the scalar value for the average intensity in the dark hole, I DH , is given by</p><formula xml:id="formula_10">I DH = 4π 2 λ 2 u T M u + 4π λ u T {b} + d.<label>(12)</label></formula><p>Where</p><formula xml:id="formula_11">M =&lt; C{Af }, C{Af } &gt;= G * G (13) b =&lt; C{A(1 + g)}, C{Af } &gt;= G * C{A(1 + g)} (14) d =&lt; C{A(1 + g)}, C{A(1 + g)} &gt;= C{A(1 + g)} * C{A(1 + g)}.<label>(15)</label></formula><p>Conceptually, d is the column matrix of the intensity contribution from the aberrated field, b is a matrix representing the interaction of the DM electric field with the aberrated field, and M describes the additive contribution of the DM to the image plane intensity. Having represented I DH in a quadratic form we can use Eq. 12 to produce an optimal control strategy, but we must first estimate C{A(1 + g)} to compute b at each control step. Doing so optimally is the main topic of this paper.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Stroke Minimization in Monochromatic Light</head><p>In general, focal plane wavefront correction methods are broken down into a wavefront estimation step followed by a control step where the DM surface height is determined. In this paper we use the stroke minimizing algorithm described in Pueyo et al. <ref type="bibr" target="#b7">[8]</ref> as the controller to test the estimation schemes. Stroke minimization corrects the wavefront by minimizing the actuator stroke on the DMs subject to a target contrast value <ref type="bibr" target="#b7">[8]</ref>. Using a single deformable mirror to control the field, these algorithms are capable of correcting both amplitude and phase aberrations on a single side of the image plane. Pueyo et al. <ref type="bibr" target="#b7">[8]</ref> showed that, to first order, two DMs in series are capable of correcting both amplitude and phase aberrations symmetrically about the optical axis, doubling the discovery space in the image plane. Physically, this is due to the phase-to-amplitude mixing from propagating the field between non-conjugate planes (the first DM to the second). Expressing the actuator amplitudes of both DMs as a vector, u, the optimization problem is written as</p><formula xml:id="formula_12">minimize N k=1 a 2 k = u T u subject to I DH ≤ 10 −C .<label>(16)</label></formula><p>Using the quadratic form for I DH in Eq. 12, and applying the constraint to the minimization via the Lagrange multiplier, µ, the quadratic cost function is given by</p><formula xml:id="formula_13">J = u T I + µ 4π 2 λ 2 M u + µ 4π λ u T {b} + µ d − 10 −C .<label>(17)</label></formula><p>The corresponding optimal command that minimizes Eq. 17 is given by</p><formula xml:id="formula_14">u opt = −µ λ 2π I + µ 2π λ M −1 {b}.<label>(18)</label></formula><p>We find the optimal actuator commands via a line search on µ to minimize the augmented cost function, Eq. 17. Since this is a quadratic subprogram of the full nonlinear problem we can iterate to reach any target contrast <ref type="bibr" target="#b7">[8]</ref>. In addition to regularizing the problem of minimizing the contrast in the search area, minimizing the stroke has the added advantage of keeping the actuation small and thus within the linear approximation. If the DM model and its transformation to the electric field (embedded in the M matrix) were perfectly known, the achievable monochromatic contrast would be limited only by estimation error. Note that using the derivation shown in §3 we have only explicitly derived the control law for a single DM. However, Pueyo et al. <ref type="bibr" target="#b7">[8]</ref> have shown that M and b only need to be augmented to account for additional DMs at non-conjugate planes. Thus the form of the control law remains the same, and only the dimension of the matrices change.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Least-Squares Estimation Using Pairwise Measurements</head><p>To date, almost all high-contrast wavefront control approaches use the DM diversity algorithm developed by Give'on et al. <ref type="bibr" target="#b5">[6]</ref> to estimate the wavefront. Up to this point DM diversity had given the best results at the Princeton HCIL in both monochromatic and broadband light <ref type="bibr" target="#b7">[8,</ref><ref type="bibr" target="#b10">11]</ref>, making it the baseline of comparison for the Kalman filter estimation scheme. The DM diversity algorithm solves for the electric field by modulating a single DM while measuring the variation in intensity at the image plane. We then solve for the field by constructing an observation matrix based on a model of how that DM perturbs the electric field at the image plane.</p><p>The linearized interaction of the DM actuation with the aberrated electric field can be written in matrix form by taking difference images using j pre-determined shapes with amplitudes prescribed by the normalized intensity of the aberrated field <ref type="bibr" target="#b11">[12,</ref><ref type="bibr" target="#b12">13]</ref>. The image I + j is taken with one deformable mirror shape, φ j , while I − j is the image taken with the negative of that shape, −φ j , applied to the deformable mirror. Applying Eq. 6, the resulting measurement is given by</p><formula xml:id="formula_15">I + − I − = 4{&lt; C{A(1 + g)}, iC{Aφ} &gt;}.<label>(19)</label></formula><p>Taking j measurements, each with a different conjugate pair of DM shapes, a vector of noisy measurements at the k th time step is constructed as</p><formula xml:id="formula_16">z k =    I + 1,k − I − 1,k . . . I + j,k − I − j,k    .<label>(20)</label></formula><p>We construct the observation matrix, H k , so that it contains the real and imaginary parts of the j th DM perturbation, C{Aφ j }, in each row. With j DM probe shapes, the observation matrix at the k th time step is given by</p><formula xml:id="formula_17">H k = 4    {C{Aφ 1,k }} {C{Aφ 1,k }} . . . . . . {C{Aφ j,k }} }{C{Aφ j,k }}    .<label>(21)</label></formula><p>Having defined the form of H k , it follows from Eq. 19 that the image plane electric field is separated into real and imaginary parts. The state vector describing the image plane electric field of a specific pixel at the k th time step is given by</p><formula xml:id="formula_18">x k = {C{Ag k }} {C{Ag k }} .<label>(22)</label></formula><p>Assuming our measurement noise, n k , is additive the observation is given by</p><formula xml:id="formula_19">z k = H k x k + n k .<label>(23)</label></formula><p>The true electric field, x k , is the unknown in Eq. 23. Using the observation matrix, H k , we seek an estimate of the electric field, ˆ x k , based on the noisy intensity measurements defined in Eq. 20. The estimator will attempt to minimize the error between the estimated and true state. Since the control system does not have access to the true state, the metric defining this error is necessarily based off the measurement residual,</p><formula xml:id="formula_20">H k ˆ x k − z k .</formula><p>Given a batch of measurements at the current time step, k, the cost function used to define the DM diversity algorithm is given by</p><formula xml:id="formula_21">J = 1 2 [H k ˆ x k − z k ] T R −1 k [H k ˆ x k − z k ],<label>(24)</label></formula><p>where we have weighted the cost function by the measurement covariance, defined as</p><formula xml:id="formula_22">R k = E[n k n T k ].<label>(25)</label></formula><p>The solution that minimizes the weighted quadratic form of the estimated measurement residual is given by the left pseudo-inverse of H k ,</p><formula xml:id="formula_23">ˆ x k = (H T k R −1 k H k ) −1 H T k R −1 k z k .<label>(26)</label></formula><p>If the measurement noise is assumed to be white, gaussian noise with a standard deviation of σ k , the measurement covariance is given by</p><formula xml:id="formula_24">R k = σ 2 k I,<label>(27)</label></formula><p>and the state estimate provided by calculating the left-pseudo inverse reduces to</p><formula xml:id="formula_25">ˆ x k = (H T k H k ) −1 H T k z k .<label>(28)</label></formula><p>With an estimator in hand we wish to quantify its uncertainty by computing its covariance, defined as the expected value of the square estimate error, x k − ˆ x k . Looking back to the weighted form of the estimator in Eq. 26, the covariance of the estimate is given by</p><formula xml:id="formula_26">P k = E (x k − ˆ x k )(x k − ˆ x k ) T (29) = H T k R −1 k H k −1 .<label>(30)</label></formula><p>Since this estimator relies on a new batch of measurements at each control step, the covariance also resets after every control step. Thus the uncertainty in the estimate is tied to the SNR and the quality of the observation (the meaning of which is discussed further in §10) in that particular set of measurements. With this formulation of the estimator, we can estimate the real and imaginary parts of the aberrated field at each pixel in the image plane with least-squares minimal error on the measurement residual, and by extension minimize the error between the estimated and true state of the image plane electric field. A minimum of 2 image pairs must be used to produce a unique estimate that minimizes the cost function in Eq. 24. The probe shapes rely on an analytical form intended to evenly modulate two rectangular regions of width w x and height w y , offset from the optical axis by (a, b) <ref type="bibr" target="#b5">[6,</ref><ref type="bibr" target="#b13">14]</ref>. Appealing to the Fourier convolution theorem, the DM perturbation that will modulate the image plane in this manner is given by</p><formula xml:id="formula_27">φ(u, v) = sinc(w x u) sinc(w y v) cos(au + θ u ) cos(bv + θ v ),<label>(31)</label></formula><p>where θ u and θ v are arbitrary phase shifts that are changed for each probe pair. Practically, we find that 4 probe pairs must be used to get a good enough estimate at the Princeton HCIL. This is partially a result of the ad-hoc nature with which the phase shift of each probe pair may be computed, and each phase shift is not guaranteed to adequately modulate the aberrated field. Consequently, 8 images are taken per iteration to estimate the electric field when using the DM diversity algorithm. An optimal probing scheme that solves this limitation is discussed in §10.</p><p>Experimental results using the DM diversity estimator with the stroke minimization algorithm are shown in  . Using the least-squares estimation technique it is capable of reaching an average contrast of 2.3 × 10 −7 in a (7-10)x(-2-2) λ/D region within 30 iterations <ref type="figure" target="#fig_3">(Fig. 3(c)</ref>) on both sides of the image plane, a unique capability that is a result of the two deformable mirrors in the system. In 20 iterations of the algorithm, requiring a total of 160 estimation exposures, the system reached a contrast level of 3.5 × 10 −7 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Constructing the Kalman Filter Estimator</head><p>The DM diversity algorithm <ref type="bibr" target="#b12">[13]</ref> is quite effective, but is limited in that it does not close the loop on the state estimate, as shown in <ref type="figure" target="#fig_4">Fig. 4</ref>. Therefore all state estimate information, ˆ x, acquired about the electric field in the prior control step is lost, requiring a full set of probe images to estimate the field at each time step. In addition to being very costly with regard to exposures, the measurements will become progressively noisier as higher contrast levels are reached. Including feedback of the state estimate at each iteration will add a degree of robustness to new, noisy measurements and will reduce the number of exposures required to update the electric field estimate at each control step. Thus, incorporating prior history means the estimator will reach its final contrast target with a minimal set of exposures and will be less sensitive to poor SNR measurements as the controller suppresses the field. To include state feedback we must extrapolate the controller's perturbation to field from the last control step using the model in §3. Since the estimate will now be formed by combining an extrapolation of the prior estimate with a smaller set of measurement updates, we must consider the relative effect of process and detector noise to optimally combine the two. This is exactly the problem a discrete time Kalman filter solves. The noisy measurement updates, z k = y k +n k , will still be difference images of probe pairs with a covariance defined by Eq. 25. The conjugate pairs allow us to construct a linear observation matrix, H k . If we were not in a low aberration regime our observer would have to be nonlinear. This is not impossible for a Kalman filter, but can make it highly biased <ref type="bibr" target="#b14">[15]</ref> and computationally expensive. Like the DM diversity estimator <ref type="bibr" target="#b5">[6,</ref><ref type="bibr" target="#b12">13]</ref>, the Kalman filter produces an estimate with leastsquares minimal error. Since the Kalman filter operates on the estimate in closed loop, the weighted cost function given in Eq. 24 will not adequately represent the error contributions in the system. To account for the noise included in forward propagating our prior state estimate history in time, we must also include an estimate of the state covariance, defined in Eq. 29. Since the covariance as yet has not been updated with a measurement, we denote it as P k (−), the minus sign indicating that it is an extrapolation from our model. Defining the error as both the difference between the noisy observation and the estimated observation, H k ˆ x k (+)−z, and the difference between our current estimate and the estimate extrapolation, ˆ x k − ˆ x k (−), the new quadratic cost function is given by</p><formula xml:id="formula_28">J = 1 2 ˆ x k − ˆ x k (−)] T P k (−) −1 [ˆ x k − ˆ x k (−) + 1 2 [H k ˆ x k − z k ] T R −1 k [H k ˆ x k − z k ] .<label>(32)</label></formula><p>We formulate the cost in matrix form as</p><formula xml:id="formula_29">J = 1 2 ˆ x k − ˆ x k (−) H k ˆ x k − z k T P k (−) 0 0 R k −1 ˆ x k − ˆ x k (−) H k ˆ x k − z k<label>(33)</label></formula><formula xml:id="formula_30">= 1 2 ( ˜ H k ˆ x k − ˜ z k ) T ˜ R −1 k ( ˜ H k ˆ x k − ˜ z k ),<label>(34)</label></formula><p>where we have now defined a new set of augmented matrices as</p><formula xml:id="formula_31">˜ H k = I H k ,<label>(35)</label></formula><formula xml:id="formula_32">˜ z k = ˆ x k (−) z k ,<label>(36)</label></formula><formula xml:id="formula_33">˜ R k = P k (−) 0 0 R k .<label>(37)</label></formula><p>Evaluating the partial derivative of Eq. 34 the state estimate update is given by</p><formula xml:id="formula_34">ˆ x k (+) = ˆ x k (−) + P k (−)H T k H k P k (−)H T k + R k −1 [z k − H k ˆ x k (−)] .<label>(38)</label></formula><p>From Eq. 38, we define the optimal gain to be</p><formula xml:id="formula_35">K k = P k (−)H T k [H k P k (−)H T k + R k ] −1 .<label>(39)</label></formula><p>Finally, we update the state covariance estimate, P k (+), by applying Eq. 38 to the expected value of the covariance,</p><formula xml:id="formula_36">P k (+) = E[(ˆ x k (+) − x k )(ˆ x k (+) − x k ) T ],<label>(40)</label></formula><p>which gives</p><formula xml:id="formula_37">P k (+) = [P k (−) −1 + H T k R −1 k H k ] −1 .<label>(41)</label></formula><p>To complete the filter we need to propagate the prior estimate, ˆ x k−1 (+), to the current time step. The filter extrapolates to the current state estimate, ˆ x k (−), by applying a time update to the prior state estimate via the state transition matrix, Φ k−1 , and numerically propagating the control output from stroke minimization at the prior iteration, u k−1 , via a linear transformation described by Γ k−1 . We also have a disturbance from the process noise, w k−1 , which is propagated to the current state of the electric field via the linear transformation, Λ k−1 . Assuming these components are additive, the state estimate extrapolation is given byˆx byˆ</p><formula xml:id="formula_38">byˆx k (−) = Φ k−1 ˆ x k−1 (+) + Γ k−1 u k−1 + Λ k−1 w k−1 .<label>(42)</label></formula><p>To determine these matrices, we apply the linearized optical model developed in §3. Using a linearized model avoids generating arbitrary bias in the estimate at each pixel, a common problem with a nonlinear filter <ref type="bibr" target="#b15">[16]</ref>. The first step in propagating the state forward in time is to update any dynamic variation between the discrete time steps with the state transition matrix, Φ k−1 . In this system, Φ k−1 captures any variation of the field due to temperature fluctuations, vibration, or air turbulence that perturb the optical system. To simplify the model, we recognize that there is no reliable way to measure or approximate small changes in the optical system over time with alternate sensors; we assume that the state remains constant between control steps, making the state transition matrix the identity, Φ k−1 = Φ = I. However, it is very important to note that Φ k−1 provides a simple mechanism to incorporate time updates from alternative high speed sensors, such as residuals measured by the adaptive optics wavefront sensor, between image plane measurements. Each submatrix for Γ, shown in <ref type="table">Table 1</ref>, is of dimension 2 × 2N DM . Every pair of rows is found by separating the real and imaginary parts of Eq. 10 into individual rows. Making the standard assumption that the process noise is gaussian white noise, the expected value of the state when we</p><formula xml:id="formula_39">extrapolate isˆx isˆ isˆx k (−) = Φ k−1 ˆ x k−1 (+) + Γ k−1 u k−1 .<label>(43)</label></formula><p>It's associated covariance extrapolation is then given by</p><formula xml:id="formula_40">P k (−) = Φ k−1 P k−1 (+)Φ T k−1 + Q k−1 .<label>(44)</label></formula><p>Combining Eq. 38, Eq. 39, and, Eq. 41 with the extrapolation equations, this form of the filter consists of five equations that describe the state estimate extrapolation, covariance estimate extrapolation, filter gain computation, state estimate update, and covariance estimate update at the k th iteration <ref type="bibr" target="#b14">[15]</ref>:</p><formula xml:id="formula_41">ˆ x k (−) = Φ k−1 ˆ x k−1 (+) + Γ k−1 u k−1 .<label>(45)</label></formula><formula xml:id="formula_42">P k (−) = Φ k−1 P k−1 (+)Φ T k−1 + Q k−1<label>(46)</label></formula><formula xml:id="formula_43">K k = P k (−)H T k H k P k (−)H T k + R k −1<label>(47)</label></formula><formula xml:id="formula_44">ˆ x k (+) = ˆ x k (−) + K k [z k − H k ˆ x k (−)]<label>(48)</label></formula><formula xml:id="formula_45">P k (+) = P k (−) −1 + H T k R −1 k H k −1<label>(49)</label></formula><p>The focal plane measurements z k are identical to that of §3, and are constructed into a column vector of j difference images for n pixels. Likewise H k takes on a similar form, and is a matrix constructed from the effect of a specific deformable mirror shape φ j,k on the real and imaginary parts of the electric field in the image plane. Finally, we compute the covariance update, P k (+), based on the added noise from the new measurements. As with the DM diversity estimator, the estimated state is a column vector of the real and imaginary parts of the electric field at each pixel of the dark hole. The control signal u remains a column vector of the DM actuator strengths as defined in §3, with DM1 commands being stacked on top of the DM2 commands. The dimension and form of the rest of the filter equations follows from these. They are all listed in detail in <ref type="table">Table 1 and Table 2</ref>. Since we are only considering process noise at the DMs, the process disturbance w is a vertical stack of the variance expected from each actuator. The only remaining step critical to the filter's performance is initializing the covariance, P 0 . In our system this cannot be measured, so we must initialize with a reasonable guess.</p><p>The Kalman filter gain, Eq. 47, optimally combines the prior estimate history with measurement updates to minimize the total error contributions based on the expected state and measurement covariance. A fundamental property of the Kalman filter is that the optimal gain, Eq. 47, is not based on measurements, but rather estimates of the state covariance, P k (−), process noise from the actuation Q k−1 , and sensor noise R k . This means that the optimality of the estimate is closely related to the accuracy and form of these matrices; this will be discussed in §8. Much like the batch process method the purpose of the gain in the Kalman filter is to minimize a quadratic cost function, Eq. 32, but it is also subject to the constraining dynamic equations definingˆxdefiningˆ definingˆx k (−) and P k (−). However, looking at Eq. 35 there is a major advantage of the Kalman filter in its minimization of the cost function. For the batch process method, the observation matrix will be underdetermined if less than 2 probe pairs are applied. Thus the solution to cost function in Eq. 24 is non-unique. However the solution for the Kalman filter is guaranteed to be critically determined even with no measurement update, and˜Hand˜ and˜H k only requires a single measurement to provide an overdetermined solution to the cost function in Eq. 34. Thus, the Kalman filter is formulated in such a way that it solves a least squares error, left pseudo-inverse problem, regardless of the number of measurements taken. This gives us the freedom to minimize the total number of exposures required to estimate the field with enough accuracy to reach the target contrast level.</p><p>Referring back to Eq. 30, we see that in both cases the covariance depends on the current observation, but the Kalman filter is also a function of the prior state covariance. Looking at Eq. 49 the final term, H T k R −1 k H k , is guaranteed to be positive definite, meaning that additional measurements can do nothing but reduce the magnitude of the covariance, P k (+). In the event of a measurement with a poor SNR the covariance may not get better, but it is guaranteed not to get worse because H T k R −1 k H k is positive definite. This is indicative of the estimator's robustness to bad measurements at later time steps. In contrast, Eq. 30 demonstrates that if the left-pseudo inverse solution is given measurements with a poor SNR the new estimate will have a large covariance at this time step. In this case the control will not be effective, which is why we often see jumps in contrast when the DM Diversity estimator reaches low contrast levels, as seen in <ref type="figure" target="#fig_3">Fig. 3</ref>. In the case of the Kalman filter, the high covariance contributed by a poor measurement update is dampened by the contribution of prior covariance estimates via P k (−), stabilizing the state estimate and its covariance in the event of a bad measurement. Since we cannot guarantee that a probe will provide a high enough SNR, particularly at high contrast levels where we have reduced the number of photons per speckle, this is an extremely attractive component of the Kalman filter estimator. <ref type="table">Table 1</ref>. Definition of all propagation Matrices. N DM is the number of actuators on a single DM, N pixels is the number of pixels in the area targeted for dark hole generation, and N pairs is the number of image pairs taken while applying positive and negative shapes to the deformable mirror. j indexes the probe shape, k the discrete time step, and n the pixel the dark hole.</p><formula xml:id="formula_46">Matrix Dimension Φ = I (2 · N pixels ) × (2 · N pixels ) Γ =          {G DM 1 } {G DM 2 } {G DM 1 } }{G DM 2 } 1 . . . {G DM 1 } }{G DM 2 } {G DM 1 } }{G DM 2 } n          (2 · N pixels ) × (2 · N DM ) H k = diag        {G DM 2 φ 1,k } }{G DM 2 φ 1,k } . . . . . . {G DM 2 φ j,k } }{G DM 2 φ j,k }    n     (N pixels ) · (N pairs ) × (2 · N pixels ) K k is computed (2 · N pixels ) × (N pixels ) · (N pairs ) u = DM 1 DM 2 (2 · N DM ) × 1 z =                  I + 1 − I − 1 . . . I + j − I − j    1 . . .    I + 1 − I − 1 . . . I + j − I − j    n               (N pixels ) · (N pairs ) × 1 ˆ x T = {E 1 } }{E 1 } · · · {E n } }{E n } T (2 · N pixels ) × 1</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Matrix</head><p>Dimension <ref type="table">Table 2</ref>. Definition of all noise Matrices. N DM is the number of actuators on a single DM, N pixels is the number of pixels in the area targeted for dark hole generation, and N pairs is the number of image pairs taken while applying positive and negative shapes to the deformable mirror. j indexes the probe shape, k the discrete time step, and n the pixel the dark hole.</p><formula xml:id="formula_47">P 0 = E[(x 0 − ˆ x 0 )(x 0 − ˆ x 0 ) T ] (2 · N pixels ) × (2 · N pixels ) Q k = ΛE[w k w T k ]Λ T (2 · N pixels ) × (2 · N pixels ) R k = E[n k n T k ] (N pixels ) · (N pairs ) × (N pixels ) · (N pairs ) Λ = Γ (2 · N pixels ) × (2 · N DM ) w = σ DM 1 σ DM 2 (2 · N DM ) × 1</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.">Iterative Kalman Filter</head><p>Since we had to linearize the field to obtain Γ k−1 and H k , we iterate the filter on itself to account for some of the nonlinearity not captured in the initial linearization. We do so by feeding the newly computed statê x k (+) and covariance update P k (+) back into the filter again, setting u k−1 to zero. Applying feedback to the filter in this manner is purely computational, and comes at no cost with regard to exposures. For sufficiently small control this additional computation will account for nonlinearity in the actuation and better filter noise in the system, limited only by the accuracy of the observation matrix, H k . Improving the accuracy at each time step means the correction algorithm will require fewer iterations, and hence fewer exposures, to reach its final contrast target. For a severely photon-limited exoplanet imager, such a reduction minimizes the time required to suppress the speckle field. Following a notation similar to Gelb <ref type="bibr" target="#b15">[16]</ref>, the p th iteration (for p ≥ 2) of numerical feedback into the iterative Kalman filter at the k th control step is</p><formula xml:id="formula_48">ˆ x p,k (−) = ˆ x p−1,k (+)<label>(50)</label></formula><formula xml:id="formula_49">P p,k (−) = Φ p−1,k P p−1,k (+)Φ T p−1,k + Q p−1,k<label>(51)</label></formula><formula xml:id="formula_50">K p,k = P p,k (−)H T p,k H p,k P p,k (−)H T p,k + R p,k −1 (52) ˆ x p,k (+) = ˆ x p,k (−) + K p,k [z p,k − H p,k ˆ x p,k (−)]<label>(53)</label></formula><formula xml:id="formula_51">P p,k (+) = P p,k (−) −1 + H T p,k R −1 p,k H p,k −1 .<label>(54)</label></formula><p>The power of iterating the filter lies in what we are fundamentally trying to achieve. For a successful control signal, we will have suppressed the field. This means that the magnitude of the probe signal will be lower than the control perturbation. This guarantees that H k will better satisfy the linearity condition than Γu. As a result, if we iterate the filter on itself during a given control step we can use the discrepancy between the image predicted by H k ˆ x k (+) and the measurements, z k , in Eq. 53 to filter out any error due to nonlinear terms not accounted for in Γ. In this way, we can accommodate a small amount of nonlinearity in our extrapolation of the state without having to resort to a nonlinear, or extended, Kalman filter. This means that in the work presented here we did not have to re-linearize within a single control step, k, as would be the case for an iterative extended Kalman filter (IEKF). It also avoided having to concern ourselves with any bias introduced into the estimate by a nonlinear filter. While we have chosen not to in this case, we can move to an IEKF in the future by simply re-linearizing about the current DM shape and iterating on p until the estimate converges. Something very important to point out is that unlike many IEKF problems, this has a unique flexibility with regard to the linearization. A conventional IEKF has been linearized about the state, ˆ x k , meaning that the new matrices in the IEKF must remain within an allowable radius of convergence, oftentimes requiring that the estimate be re-linearized at every iteration on p <ref type="bibr" target="#b15">[16]</ref>. Looking back to Eq. 2 however, we recall that we have actually linearized about the control signal. Since we did not linearize about the state and the problem assumes no dynamics at this point, we need only re-linearize Γ k−1 and H k . This re-linearization need not wait for the estimate to begin. Once the control at (k − 1) is applied we can re-linearize Γ k−1 and H k in parallel with taking new measurements for the current time step, z k .Thus for an adequately long exposure, re-linearizing these matrices can be scheduled in such a way that they have negligible impact on the time required to estimate the field. Additionally, Eq. 46 and Eq. 47 are measurement independent. Thus, their computation can be scheduled in parallel to taking the new measurements, further improving the efficiency of the estimator with regard to time.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.">Sensor and Process Noise</head><p>Two important design parameters for the performance of the filter are the process noise, Q k−1 , and the sensor noise, R k . For the laboratory experiments we make reasonable assumptions by appealing to physical scaling of the two largest known sources of error in the system. The sensor noise will be determined by the dark current and read noise inherent to our detector. In a space observatory, and possibly even on the ground, the sensor noise will also be determined by photon noise. We assume that the process noise is dominated by errors in the commanded DM shapes. Thus, the process noise is isolated to poor knowledge of the DM surface, which comes from the inherent nonlinearity in the voltage-to-actuation gain as a function of voltage, the variance in this gain from actuator to actuator, and the accuracy of the superposition model used to construct the mirror surface that covers the 32x32 actuator array of the Boston Micromachines kilo-DM. Treating actuation errors as additive process noise, the Kalman filter can account for them in a statistical fashion, rather than deterministically in a physical model. Since there is no physical reasoning to justify varying Q k at each iteration, it will be kept constant throughout the entire control history (Q k−1 = Q = constant). Two versions of process noise can be considered in this case. The first is where there is no correlation between actuators, giving a purely diagonal matrix with a magnitude corresponding to the square of the actuation variance, σ u . The second version of Q has symmetric off-diagonal elements, which treats uncertainty due to interactuator coupling and errors in the superposition model statistically. As a first step, we will not consider inter-actuator coupling to help avoid a poorly conditioned matrix. This helps guarantee that the Kalman filter itself will be well behaved. Thus the process noise for the filter will be</p><formula xml:id="formula_52">Q = σ 2 u ΓIΓ T .<label>(55)</label></formula><p>Following Howell [17] the noise from both the incident light and dark noise in a CCD detector follows a Poisson distribution. Since each measurement is a difference of pairwise images the noise is zero-mean and will become more Gaussian as the exposure time increases. We simplify the noise statistics by assuming it is uncorrelated and constant from pixel to pixel. The measurement error covariance, R k , is thus a diagonal matrix of the mean pixel covariance, σ CCD , given by</p><formula xml:id="formula_53">R = σ 2 CCD I 00 I N pairs ×N pairs ,<label>(56)</label></formula><p>where I 00 is the peak count rate of the PSF's core (allowing us to describe R in units of contrast). Having appealed to physical scaling in the HCIL, we now have close approximations of the true process and sensor noise exhibited in the experiment.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="9.">Experimental Results for the Kalman Filter Estimator in Monochromatic Light</head><p>We corrected the field using the Kalman filter estimator using four, three, two, and one pair of images as a measurement update to assess the degradation in performance as information is lost. We began with four measurements (four image pairs), to compare its performance using the same number of measurements as were used in the DM diversity estimator. Using 4 pairs, the filter achieved a contrast of 4.0 × 10 −7 in (7-10)x(-2-2) λ/D symmetric dark holes within 20 iterations of the controller, shown in <ref type="figure" target="#fig_5">Fig. 5</ref>. Note that this used a total of 160 estimation images, which is the same amount of information available to the DM diversity estimator when it achieved a contrast of 3.5 × 10 −7 in 20 iterations. Reducing the number of image pairs to three, the correction algorithm reached a contrast level of 5.0 × 10 −7 using only 120 estimation images, as shown in <ref type="figure">Fig.6</ref>. After fine tuning the covariance and noise matrices, the correction algorithm achieves a contrast of 2.3 × 10 −7 in 30 iterations using only two image pairs per iteration, shown in <ref type="figure">Fig. 7</ref>. The results are better than the three and four pair cases because we improved the covariance initialization and increased the number of numerical iterations (p from §7) of the Kalman filter for a single control step. As discussed in §7, numerically iterating the filter is critical to its performance, despite the fact that no additional measurements are taken, because it accounts for nonlinearity not captured when numerically propagating the control signal via Γ k−1 . Reducing the number of measurements to a single pair we find a very interesting result. The quality of the measurement at any particular time step of the algorithm is now dependent on the quality of that particular probe shape. If a probe does not happen to modulate the field well H k drops rank, adding noise to the gain computation and estimate update of Eq. 47 and Eq. 48. As a result, the controller can actually degrade the contrast in the dark hole at that time step. Additionally, a single probe may not modulate a specific location of the field well, so we must choose a different probe shape at each iteration to guarantee good coverage of the entire dark hole in closed loop. Starting from an aberrated field with an average contrast of 9.418 × 10 −5 , <ref type="figure" target="#fig_7">Fig. 8(a)</ref>, we achieved a contrast of 3.1 × 10 −7 in 30 iterations and 2.5 × 10 −7 in 43 iterations of control, <ref type="figure" target="#fig_7">Fig. 8(c)</ref>. Looking at the contrast plot in <ref type="figure" target="#fig_7">Fig. 8(b)</ref>, the sensitivity of a single measurement update to the quality of the probe is very clear. What is interesting, however, is that the modulation in contrast damps out over the control history. While we do not suppress as quickly with regard to iteration we achieve our ultimate contrast levels with fewer total measurements, which is the ultimate performance metric for efficiency of the estimation and control algorithm. Thus, even with one measurement update per iteration the prior history stabilizes the estimate in the presence of the measurement update's poor signal-to-noise at high contrast levels. More encouraging is that these results use the analytical probe shapes described by Eq. 31. The choice in phase shifts, θ u and θ v , is somewhat arbitrary, with no criteria to evaluate how effectively each modulates the field. In fact, we had to carefully choose our phase shifts to improve the convergence rate of the single probe pair results. If we could choose probe shapes that are guaranteed to modulate the dark hole well, we would see a dramatic improvement in the rate of convergence for a single measurement update.</p><p>A very promising aspect of this estimation scheme is that its performance did not degrade as the amount of measurement data was reduced. With only 86 estimation images it was capable of reaching the same final contrast achieved by the DM diversity algorithm in §3, which required 240 images to maintain an estimate of the entire control history. Thus by making the estimation method more dependent on a model we were able to reduce our need to measure deterministic perturbations in the image plane electric field.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="10.">Optimal Probes: Using the Control Signal</head><p>The results of §9 use the analytical probe shapes described by Eq. 31. As discussed in §9, the choice of the probe shape used for estimation is critical to create a well-posed problem, and has been somewhat of an art in the high contrast imaging community. These shapes are intended to modulate the field as uniformly as possible so that H k is full rank. However, no formalism has been proposed to determine the "best" shapes to probe the dark hole. In any dark hole there are discrete aberrations that are much brighter than others, requiring that we apply more amplitude to those spatial frequencies. Conversely the bright speckles raise the amplitude of the probe shape, making it too bright to measure the dim speckles with an adequate SNR. Excluding this issue, we also cannot truly generate the analytical functions, as the actual surface is a sum of individual influence functions. Even the DM with the highest actuator density available, the Boston Micromachines 4K-DM c , can only approximate each function with 64 actuators. We account for the true shape in our model but this shape does not truly probe each pixel in the dark hole with equal weight, which was the primary advantage of using the analytical function for a probe shape in the first place. Fortunately, we can once again appeal to our mathematical model for estimation and control to help determine an adequate probe shape. In closed loop, the control law incorporates the influence function model of the surface to determine a shape that necessarily modulates the aberrated field in the dark hole. In principle, if we apply the conjugate of the control shape we will increase the energy of the aberrated field. Instead of applying probes in addition to the control shape, we use the control shape itself (and its negative) to probe the elecric field in the dark hole. Thus, we can rely on the controller to compute optimal probe shapes that will inherently modulate brighter speckles more strongly than dimmer speckles and we have confidence that the shape will adequately perturb the dark hole field. <ref type="figure" target="#fig_8">Fig. 9</ref> shows preliminary results using the control and its conjugate shape as the probe pair for estimating the field with the Kalman filter. The current contrast level is limited to 2.30 × 10 −6 on both sides of the image plane. The asymmetry of the dark holes actually hints at the reason for not achieving a higher contrast level. In a 2-DM system, the idea that the optimal control signal can be used as the probe shape requires that we use both mirrors to probe the field. Since the estimator is currently written assuming one mirror is probing the field, we were forced to collapse both control shapes onto the same DM. This means that we are not fully perturbing the field as we would have expected, leaving a particular set of aberrations unprobed. This is not a problem for a single sided dark hole using one DM, where the control and probe surfaces are one and the same. For a two DM system, we simply need to reformulate the estimator as a function of both DMs for this concept to be effective.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="11.">Conclusions</head><p>We have demonstrated a discrete time iterative Kalman filter to estimate the image plane electric field in closed loop. The experimental results only required a single linearization for the estimator, and we have mathematically demonstrated a suitable extension to an IEKF in the event that we must re-linearize about a new DM shape. This type of progress is critical for improving the efficiency and robustness of future coronagraphic missions, thereby maximizing the likelihood of planetary detections. We demonstrate the fastest suppression to date in the Princeton HCIL, only requiring a single measurement at each iteration. This represents a ≈70% reduction in the number of images required to estimate the image plane electric field. Having increased the speed of the estimator, this makes it a feasible focal plane estimation technique for ground-based coronagraphic instruments. The closed loop nature of the estimator is attractive because it also stabilizes the estimate to measurement noise. So long as the probe adequately modulates the intended dark hole area, a measurement update with poor signal-to-noise does not adversely affect the covariance of the state estimate.</p><p>Having controlled the field with only a single measurement update, we have demonstrated that not all probe shapes are best for estimation, motivating us to attempt using the control shape as the probing function. Preliminary results for using the control shape as a probe signal are promising, and may further reduce the number of required exposures to one image per iteration. The Kalman filter also opens up the possibility of adaptive control techniques to learn laboratory physical parameters, sensor fusion concepts for integration with extreme adaptive optics systems, and bias estimation to gain certainty in planetary detection using only the control history.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Optical Layout of the Princeton HCIL. Collimated light is incident on two DMs in series, which propagates through a Shaped Pupil, the core of the PSF is removed with an image plane mask, and the 90 • search areas are reimaged on the final camera.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. (a) A shaped pupil. (b) The ideal PSF from a system using a shapedpupil coronagraph. (c) Shaped Pupil with aberrations generated by Fresnel propagating the measured nominal shapes of the DMs to the pupil plane. Other sources of aberrations are not included because they have not been measured. (d) The PSF of the shaped pupil with the simulated aberrations. The figures are in a log scale, and the log of contrast is shown in the colorbars.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 3 .Fig. 3 .</head><label>33</label><figDesc>Fig. 3. Experimental results of sequential DM correction using the DM diversity estimation algorithm. The dark hole is a square opening from 7-10 x -2-2 λ/D on both sides of the image plane. (a) The aberrated image. (b) Contrast plot. (c) The corrected image. Image units are log(contrast).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 3 (a)</head><label>3</label><figDesc>Fig. 3(a). Using the least-squares estimation technique it is capable of reaching an average contrast of 2.3 × 10 −7 in a (7-10)x(-2-2) λ/D region within 30 iterations (Fig. 3(c)) on both sides of the image plane, a unique capability that is a result of the two deformable mirrors in the system. In 20 iterations of the algorithm, requiring a total of 160 estimation exposures, the system reached a contrast level of 3.5 × 10 −7 .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Block diagram of a standard FPWC control loop. At time step k, only the intensity measurements, z k , provide any feedback to estimate the current state, x k . The dashed lines show additional feedback included in this paper from the prior electric field (or state) estimate, ˆ x k , and the control signal, u k .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 5 .</head><label>5</label><figDesc>Fig. 5. Experimental results of sequential DM correction using the discrete time extended Kalman filter with 4 image pairs to build the image plane measurement, z k . The dark hole is a square opening from 7-10 × -2-2 λ/D on both sides of the image plane. (a) The aberrated image. (b) Contrast plot. (c) The corrected image. Image units are log(contrast).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig. 6 .Fig. 7 .</head><label>67</label><figDesc>Fig. 6. Experimental results of sequential DM correction using the discrete time extended Kalman filter with 3 image pairs to build the image plane measurement, z k . The dark hole is a square opening from 7-10 × -2-2 λ/D on both sides of the image plane. (a) The aberrated image. (b) Contrast plot. (c) The corrected image. Image units are log(contrast).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 8 .</head><label>8</label><figDesc>Fig. 8. Experimental results of sequential DM correction using the discrete time extended Kalman filter with one image pair to build the image plane measurement, z k . The dark hole is a square opening from 7-10 × -2-2 λ/D on both sides of the image plane. (a) The aberrated image. (b) Contrast plot. (c) The corrected image. Image units are log(contrast).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig. 9 .</head><label>9</label><figDesc>Fig. 9. Experimental results of sequential DM correction using the discrete time extended Kalman filter with the control effect and it's conjugate shape used as the only probe pair for the measurement update, z k . The dark hole is a square opening from 7-10 × -2-2 λ/D on both sides of the image plane. (a) The aberrated image. (b) Contrast plot. (c) The corrected image. Image units are log(contrast).</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>This work was funded by NASA Grant # NNX09AB96G and the NASA Earth and Space Science Fellowship</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Reflectivity and optical surface height requirements in a broadband coronagraph. 1.Contrast floor due to controllable spatial frequencies</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">B</forename><surname>Shaklan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">J</forename><surname>Green</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Applied Optics</title>
		<imprint>
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="page" from="5143" to="5153" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Stability error budget for an aggressive coronagraph on a 3.8 m telescope</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shaklan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Marchen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Krist</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Rud</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proceedings of SPIE</title>
		<imprint>
			<biblScope unit="volume">8151</biblScope>
			<biblScope unit="page">815109</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Demonstration of high contrast in 10% broadband light with the shaped pupil coronagraph</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Belikov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Give&amp;apos;on</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Kern</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Cady</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carr</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shaklan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Balasubramanian</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>White</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Echternach</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Dickie</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Trauger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Kuhnert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proceedings of SPIE</title>
		<imprint>
			<biblScope unit="volume">6693</biblScope>
			<biblScope unit="page" from="66930" to="66931" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">High-dynamic-range imaging using a deformable mirror for space coronography</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Malbet</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Shao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Publications of the Astronomical Society of the Pacific</title>
		<imprint>
			<biblScope unit="volume">107</biblScope>
			<biblScope unit="page" from="386" to="398" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Coronagraph contrast demonstrations with the high-contrast imaging testbed</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Trauger</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Burrows</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Gordon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Green</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Lowman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Moody</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Niessner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Shi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Wilson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proceedings of SPIE</title>
		<imprint>
			<biblScope unit="volume">5487</biblScope>
			<biblScope unit="page">1330</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Broadband wavefront correction algorithm for high-contrast imaging systems</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Give&amp;apos;on</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Kern</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shaklan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Moody</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Pueyo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proceedings of SPIE</title>
		<imprint>
			<biblScope unit="volume">6691</biblScope>
			<biblScope unit="page" from="66910" to="66911" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Closed loop, dm diversitybased wavefront correction algorithm for high contrast imaging systems</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Give&amp;apos;on</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Belikov</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shaklan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optics Express</title>
		<imprint>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Optimal dark hole generation via two deformable mirrors with stroke minimization</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Pueyo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kay</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Kasdin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Groff</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Mcelwain</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Give&amp;apos;on</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Belikov</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Applied Optics</title>
		<imprint>
			<biblScope unit="volume">48</biblScope>
			<biblScope unit="page" from="6296" to="6312" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">High-contrast imaging and wavefront control with a piaa coronagraph: Laboratory system validation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Guyon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Pluzhnik</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Martinache</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Totems</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Tanaka</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Matsuo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Blain</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Belikov</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Publications of the Astronomical Society of the Pacific</title>
		<imprint>
			<biblScope unit="volume">122</biblScope>
			<biblScope unit="page" from="71" to="84" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Characterisation of the influence function non-additivities for a 1024-actuator mems deformable mirror</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Blain</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Conan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Bradley</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O</forename><surname>Guyon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Vogel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 1st AO for ELT conference</title>
		<meeting>the 1st AO for ELT conference</meeting>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Optimal wavefront estimation and control using adaptive techniques</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Groff</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Kasdin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Aerospace Conference</title>
		<imprint>
			<publisher>IEEE</publisher>
			<date type="published" when="2012" />
			<biblScope unit="page" from="1" to="9" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">High-contrast imaging from space: Speckle nulling in a low aberration regime</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Borde</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Traub</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Applied Physics Journal</title>
		<imprint>
			<biblScope unit="volume">638</biblScope>
			<biblScope unit="page" from="488" to="498" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Pair-wise, deformable mirror, image plane-based diversity electric field estimation for high contrast coronagraphy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Give&amp;apos;on</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Kern</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shaklan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proceedings of SPIE</title>
		<imprint>
			<biblScope unit="volume">8151</biblScope>
			<biblScope unit="page">815110</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">Optimal electric field estimation and control for coronagraphy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Groff</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
		</imprint>
		<respStmt>
			<orgName>Princeton University</orgName>
		</respStmt>
	</monogr>
<note type="report_type">Ph.D. thesis</note>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Stengel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optimal Control and Estimation</title>
		<imprint>
			<date type="published" when="1994" />
			<publisher>Dover Publications</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Gelb</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kasper</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Nash</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Price</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Sutherland</surname></persName>
		</author>
		<title level="m">Applied Optimal Estimation</title>
		<imprint>
			<publisher>M.I.T Press</publisher>
			<date type="published" when="1974" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">Handbook of CCD astronomy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Howell</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="volume">2</biblScope>
		</imprint>
		<respStmt>
			<orgName>Cambridge Univ Pr</orgName>
		</respStmt>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
