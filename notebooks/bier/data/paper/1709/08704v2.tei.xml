<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2019-01-22T13:45+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">PYLIMA : AN OPEN SOURCE PACKAGE FOR MICROLENSING MODELING.I. PRESENTATION OF THE SOFTWARE AND ANALYSIS ON SINGLE LENS MODELS</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2017-09-29">September 29, 2017 September 29, 2017</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Bachelet</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Las Cumbres Observatory</orgName>
								<address>
									<addrLine>6740 Cortona Drive, Suite 102</addrLine>
									<postCode>93117</postCode>
									<settlement>Goleta</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Norbury</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Las Cumbres Observatory</orgName>
								<address>
									<addrLine>6740 Cortona Drive, Suite 102</addrLine>
									<postCode>93117</postCode>
									<settlement>Goleta</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Bozza</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Dipartimento di Fisica &quot;E.R. Caianiello&quot;</orgName>
								<orgName type="institution">Università di Salerno</orgName>
								<address>
									<addrLine>Via Giovanni Paolo II 132</addrLine>
									<postCode>84084</postCode>
									<region>Fisciano (SA)</region>
									<country key="IT">Italy</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Istituto Nazionale di Fisica Nucleare</orgName>
								<orgName type="institution">Sezione di Napoli</orgName>
								<address>
									<postCode>80126</postCode>
									<settlement>Napoli</settlement>
									<country key="IT">Italy</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Street</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">Las Cumbres Observatory</orgName>
								<address>
									<addrLine>6740 Cortona Drive, Suite 102</addrLine>
									<postCode>93117</postCode>
									<settlement>Goleta</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">PYLIMA : AN OPEN SOURCE PACKAGE FOR MICROLENSING MODELING.I. PRESENTATION OF THE SOFTWARE AND ANALYSIS ON SINGLE LENS MODELS</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2017-09-29">September 29, 2017 September 29, 2017</date>
						</imprint>
					</monogr>
					<note type="submission">(Received receipt date; Revised revision date; Accepted acceptance date)</note>
					<note>Draft version Preprint typeset using L A T E X style emulateapj v. 12/16/11 Draft version</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords></keywords>
			</textClass>
			<abstract>
				<p>Microlensing is a unique tool, capable of detecting the &quot;cold&quot; planets between ∼1-10AU from their host stars, and even unbound &quot;free-floating&quot; planets. This regime has been poorly sampled to date owing to the limitations of alternative planet-finding methods, but a watershed in discoveries is anticipated in the near future thanks to the planned microlensing surveys of WFIRST-AFTA and Euclid&apos;s Extended Mission. Of the many challenges inherent in these missions, the modeling of microlensing events will be of primary importance, yet is often time consuming, complex and perceived as a daunting barrier to participation in the field. The large scale of future survey data products will require thorough but efficient modeling software, but unlike other areas of exoplanet research, microlensing currently lacks a publicly-available, well-documented package to conduct this type of analysis. We present first version 1.0 of pyLIMA: Python Lightcurve Identification and Microlensing Analysis 1. This software is written in Python and uses existing packages as much as possible, to make it widely accessible. In this paper, we describe the overall architecture of the software and the core modules for modeling single-lens events. To verify the performance of this software, we use it to model both real datasets from events published in the literature and generated test data, produced using pyLIMA&apos;s simulation module. Results demonstrate that pyLIMA is an efficient tool for microlensing modeling. We will expand pyLIMA to consider more complex phenomena in the following papers.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">INTRODUCTION</head><p>At time of writing, 3413 confirmed planets have been discovered in various planetary systems. The majority of these planets have been discovered through the transit (2693, with a large proportion thanks to the Kepler/K2 missions <ref type="bibr" target="#b6">Batalha et al. (2013)</ref>; <ref type="bibr" target="#b16">Coughlin et al. (2015)</ref>) and the radial velocitiy (609) methods <ref type="bibr">1</ref> . While other techniques, including astrometry, microlensing and direct imaging, have contributed relatively few detections so far, they probe complementary regions of parameter space. This large sample of planets has enabled several studies to derive planetary distributions, see for example <ref type="bibr" target="#b11">(Cassan et al. 2012;</ref><ref type="bibr" target="#b6">Batalha et al. 2013;</ref><ref type="bibr" target="#b14">Clanton &amp; Gaudi 2014)</ref>, constraining the formation and evolution of planets. The future space missions TESS ( <ref type="bibr" target="#b43">Ricker et al. 2015</ref>) and PLATO ( <ref type="bibr" target="#b12">Catala et al. 2011</ref>) will complete the statistics for this part of the parameter space and will also conduct studies of these new worlds to an unprecedent level of detail, knowing that the atmospheres of these new planets will be perfectly suited for spectroscopic transit follow-up ( <ref type="bibr" target="#b42">Ricker et al. 2014</ref>).</p><p>However, the transit and radial velocity methods are intrinsically most sensitive to planets orbiting close their parent star, while direct imaging cannot survey many targets at separations less than ∼10AU, leaving a gap in our understanding of the distribution of "cold" planets at separations between ∼1-10AU where they efficiently form. Fortunately, the sensitivity of the microlensing method peaks around these separations for galactic host stars and is independent of the lens brightness, meaning that it is uniquely capable of detecting objects anywhere along the line of sight from Earth to <ref type="bibr">1</ref> https://github.com/ebachelet/pyLIMA 1 http://exoplanetarchive.ipac.caltech.edu/index.html sources in the Galactic Bulge. Microlensing's capability to complete the planetary census was therefore identified as a priority in last decadal survey <ref type="bibr">(New Worlds, New Horizons, 2010)</ref>. In addition, microlensing recently showed its potential to discover "free-floating planets" ( <ref type="bibr" target="#b47">Sumi et al. 2011</ref>). If these events prove to be caused by truly unbound planets, then the observed distribution of these objects requires that all planetary systems eject about two planets, at least one magnitude higher than predictions ( <ref type="bibr" target="#b36">Ma et al. 2016</ref>).</p><p>The WFIRST-AFTA mission has been predicted to detect around 3000 "cold" planets by surveying about 100 million stars in six observing windows of 70 days ( <ref type="bibr" target="#b45">Spergel et al. 2015</ref>), for a total number of ∼ 37000 microlensing events. One of the many challenges related to the mission is therefore the need to model microlensing events in a reasonable time.</p><p>However, while the modeling of single lens event is relatively fast and quite easy, the analysis of multiple lens events such as planetary or stellar binary systems -is much more difficult. One key problem is encountered when summing the magnification of the background source images due to N l multiple bodies in a lensing system, when it is necessary to solve a N 2 l + 1 polynomial for each source position. Moreover, the lens mapping presents singularities (called caustics) where the magnification of a point source diverges. The treatment of these singularities, discussed in detail in <ref type="bibr" target="#b58">Wambsganss et al. (1992)</ref>; <ref type="bibr" target="#b9">Bozza (2010)</ref>; <ref type="bibr" target="#b20">Dong et al. (2006)</ref>, require methods which are time consuming, and often depend on large cluster computing facilities.</p><p>In addition, the large parameter space that must be searched (at least 7 parameters describe a binary lens) suffers from several perfect degeneracies, discussed in <ref type="bibr" target="#b27">Gould (2004)</ref>; <ref type="bibr" target="#b50">Thomas &amp; Griest (2006)</ref>; <ref type="bibr" target="#b18">Dominik (2009)</ref> a number of second order effects (such as parallax and orbital motion) must be taken into account. Robustly identifying the best-fitting model can be very challenging, as recent examples can attest (e.g. OGLE-2013-BLG-0723, see <ref type="bibr" target="#b29">Han et al. (2016)</ref>).</p><p>To date, very few people have developed or used microlensing analysis software. Little systematic testing has been performed of the existing (proprietary) packages, for which little or no documentation is available, exacerbating the perceived "barrier to entry" for newcomers in the field. This stands in marked contrast with other areas of exoplanet research, where public codes for detection and analysis have been developed, and systematic data challenges conducted to stimulate development ( <ref type="bibr" target="#b40">Moutou et al. 2005;</ref><ref type="bibr" target="#b22">Dumusque 2016;</ref><ref type="bibr" target="#b23">Dumusque et al. 2017)</ref>. This standard of published testing and verification is not only good scientific practice, it also serves to build confidence in the results.</p><p>Our aim is therefore to develop a robust, well-tested and publicly-available software package for the modeling of microlensing events, capable of answering the needs of future large-scale surveys as well as existing ground-based programs. Our plan is to devellop the python Lightcurve Identification and Microlensing Analysis (pyLIMA) software which adopts the following philosophy :</p><p>• high performance, capable of analyzing multiple-lens events within reasonable time-frames</p><p>• well tested</p><p>• well documented</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>• easy to use</head><p>• open for community use and participation in development</p><p>The first important step, described in this paper, is to develop a flexible code architecture which incorporates the fundamental elements of microlensing models and solution finding modules, which will be built upon as more complex models are introduced in subsequent publications. While the point source point lens (PSPL) and finite source point lens (FSPL) models presented here are straight-forward, their implementation depends on a number of important elements, including the combination of data for events observed from multiple facilities and initial-guess assumptions on source stars colors. These aspects, while rarely discussed, are non trivial, and will form the foundation of the code for modeling more complex events.</p><p>In the Section 2, we outline examples of how such software might be used to derive the design requirements for it, before introducing a general overview of pyLIMA's architecture. The microlensing models are presented in the Section 3 while the implemented fitting methods are detailled in the Section 4. Section 5 presents the results obtained on both simulated and real datasets. We conclude and present future plans in Section 6.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">PYLIMA DESCRIPTION</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.">Use cases examples</head><p>Here we outline several common scenarios in which the modeling of microlensing events is required, and infer the corresponding requirements placed on the design of pyLIMA. It should be noted that while only single lenses are considered in the current version of the code, binary and higher-order multiple lenses will be incorporated in subsequent versions, which requires the code design be flexible enough to handle a range of lens types. Use-case 1: "As a ground-based observer, I have time-series photometric measurements from a number of different telescopes of an ongoing microlensing event, and I wish to measure the observed and physical parameters of that event and plot the data overlaid with a model lightcurve, in order to judge whether to continue observations."</p><p>This scenario is typical of ground-based microlensing observations where data from multiple longitudinally-separated sites must be combined to fully sample the event lightcurve. We can deduce several requirements from this case:</p><p>• the software should accept mutlitple photometrictimeseries datasets, potentially taken with different filters, to be combined into a single lightcurve, implying the need to properly align the datasets taking into account the different degree of blending (overlapping stellar PSFs or problems with or lack of absolute flux calibrations) in data from instruments with different pixel scales.</p><p>• because each dataset could have its own format, the user needs to be able to describe this format during data input</p><p>• some single-lens models, particularly those including parallax, require information on the location of each observatory, meaning the user needs a way to specify this for each dataset.</p><p>• the software should output both a text summary of all model parameters and a lightcurve plot with the model overlaid.</p><p>Use-case 2: "As a new post-graduate, I have access to time-series photometry from a space-based telescope from a publicly-accessible data archive which includes a number of known single-lens microlensing events. I have a rudimentary knowledge of both Python, and microlensing theory. I would like to determine the observed and physical parameters for all of these events, and I have a single desktop computer with &lt;10 CPUs." This use-case provides more insight into the circumstances under which the code will be used:</p><p>• users also have basic but not expert familiarity with microlensing theory, so the documentation should explain the steps of the process and include links to relevant publications.</p><p>• establishes the use of space-based photometry, telescope resources and survey cadences</p><p>• establishes limits on available computing power -fitting procedures cannot depend on large-scale parallelization or high-end processors to compensate for efficiency.</p><p>Use-case 3: "As the post-doctorate or faculty-level operator of a survey facility producing time-series photometry, I would like to search for microlensing events within my data, which comprises a database of millions of lightcurves. I have rudimentary knowledge of Python and expert knowledge of microlensing theory, but I do not have the time to fit each lightcurve manually." We can outline these needs :</p><p>• establishes different user group which the documentation and user-interface should accomodate.</p><p>• requires that the code be useable as a library, from which the user can choose models and fitting algorithms to build into software they develop for their own use.</p><p>• implies the fitting procedures must be robust in returning sensible output even for lightcurves which may or may not contain a lensing event.</p><p>• requires that software be able to fit large numbers of lightcurves in an automated manner, which implies that it must be able to robustly establish reasonable initial values for the fitted parameters without human intervention.</p><p>Use-case 4: "As a professor, my team and I would like to conduct a microlensing survey using telescope facilities available to my institution, which may be both ground-or space-based. I would like to maxmize the science return of this project by simulating the data produced by different possible observing strategies, in order to optimize my use of the facilities." In addition to the requirements above, this implies that:</p><p>• the user should be able to specify the characteristics of the telescope(s) and observing strategy to be used, including telescope aperture, location, observing cadence, etc.</p><p>• the user should be able to specify the range of microlensing parameters for the events to be simulated</p><p>• the software should be able to generate timeseries photometric datasets with realistic noise characteristics and cadence</p><p>We note the utility of this simulation module in also providing a means to test the performance of the software itself.</p><p>2.2. Architecture To be applicable in these use-cases, pyLIMA's architecture needs to be efficient and capable of rapidly analyzing large numbers of events in an automated fashion, but also highly flexible, to enable users to easily conduct detailed analyses. To address this, pyLIMA's architecture follows three principles:</p><p>• It should be possible to use the software to analyse large datasets in an automatic way.</p><p>• The code should be constructed in a modular manner, so that users can implement analysis functions of their own design easily simply by adding the desired functions.</p><p>• The code should be open source and structured in such a way that, as new theories and techniques become available, they can be easily integrated within this framework. Community contributions are welcomed.</p><p>• The code should be well documented, to enable new users to learn both microlensing theory and the software functions quickly and easily.</p><p>Python was adopted as the base programming language because it is free, available, and has been widely adopted in astronomy and there are a number of excellent libraries already available (e.g. numpy, scipy and Astropy). It is also trivial for Python to interface with libraries written in other languages, including C and Fortran. In the following, we briefly describe the main modules that are already implemented in pyLIMA. A more complete description can be found in the pyLIMA documentation 2 : -events : The fundamental starting block of pyLIMA's analysis centers around an Event, which is a class with a set of descriptive attributes, including the name, ra and dec (used in the estimation of parallax or extinction along the line of sight). Since an event may be observed from multiple telescopes and/or with multiple filters, the event can have multiple datasets associated with it. Each dataset is described as as separate instance of the Telescope class (see below). The principal function of the Event class is fit, which provides the user with a range of options to fit microlensing models to the data.</p><p>-telescopes : this module define the class Telescope. This class groups all the characteristics of an observatory which obtains data on a specific event. The user-specified name and filter distinguish different datasets, representing the filter used for the observations. Currently pyLIMA supports lightcurve data, which can be provided in units of flux or magnitude, as this class provides methods to automatically convert between these units. The user also specifies a location ('Space' or 'Earth') for the observatory, accepting altitude, longitude and latitude in cases where this is needed for parallax estimation. If the telescope location is 'Space', then the spacecraft position are estimated through the JPL Horizon system : https://ssd.jpl.nasa.gov/horizons.cgi in an automatic manner.</p><p>-microlmodels : the user can select a number of different lensing models to fit to the data on a given event, described in the MLModel class from this module. The models currently supported are : Paczynski model (point-source point lens model) and finite-source point lens model (FSPL). Future versions of the software will provide more complex model options. The user is able to optionally include a range of second order effects, including microlensing parallax, the orbital motion of the lens etc. The main function of this class is to compute the microlensing model associated to the parameters.</p><p>-microlfits : A number of well-documented procedures exist for identifying the best-fit model to a given dataset. pyLIMA is structured to provide users with access to commonly-used fitting methods as well as an easy way to implement their own, new techniques if they wish by adding to the MLFits class in the microlfits module. The user is able to indicate their prefered fitting method, which produce outputs appropriate to the method applied. The three methods that are already integrated in the package, based on the scipy package (Jones et al. 01 ), are detailed in the Appendix. Note that several fits, with different models or/and methods, can be performed on the same Event.</p><p>-microloutputs : Upon completing an analysis, there are a number of diagnostic plots commonly used in microlensing. The user is able to produce these using the functions of the microloutputs module, which is based on the matplotlib package <ref type="bibr" target="#b30">(Hunter 2007)</ref>.</p><p>-microlsimulator : In addition to fitting real data on microlensing events, a number of important use-cases require the ability to generate simulated data. pyLIMA provides the microlsimulator module for this purpose, incorporating a series of functions which enable the user to produce realistic simulations of how events of given parameters would be observed from the observatories they specify. This module is based on the astropy package <ref type="bibr">(Astropy Collaboration et al. 2013</ref>).</p><p>pyLIMA makes extensive use of the astropy (Astropy <ref type="bibr">Col- laboration et al. 2013</ref>) and numpy (van der <ref type="bibr" target="#b61">Walt et al. 2011</ref>) packages, both of which are being widely adopted in the community, so the functions, attributes and behavior of the software are as familiar as possible. <ref type="figure" target="#fig_1">Figure 1</ref> provides a schematic overview of the architecture, and the code excert below gives an example of these modules in use. More sophisticated examples are provided in the pyLIMA documentation <ref type="bibr">3</ref>  Good coding practice When developing software, it is good practice to maintain a clear structure, and to adopt consistent naming conventions for variables, functions etc, to ensure that the code is readable. This pays off in the long-term in making it substantially easier to maintain and upgrade. These and other considerations lead to the introduction of the PEP8 standards <ref type="bibr">4</ref> . As pyLIMA is intended to be accessible to the entire community, we have adopted this standard for our development, while al- lowing a certain degree of flexibility. We have assigned standard astronomical names for variables where they exist, even if they do not respect the PEP8 standards. An example of this is the ra variable, which in principle should be written as right ascension. The pyLIMA package is made publicly available via GitHub <ref type="bibr">5</ref> , which also facilitates the community contributing to the software development. Extensive documentation is generated automatically based on mark-up within the code, using SPHINX, making it easier to keep it up to date. The package also includes some Jupyter notebook-based examples as a guide to users.</p><p>However, as with any substantial package, it is always possible to inadvertantly introduce bugs in the course of implementing new features. This can be addressed by developing functions which can be run automatically to systematically test all parts of the code and verify that it produces the expected results. Python provides a framework that enables users to develop these unit-tests. Thanks to the Travis CI portal, these unit-test are run automatically through GitHub at each new code upgrade.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">IMPLEMENTATION OF PSPL AND FSPL MODELS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">Point Source, Point Lens (PSPL) model</head><p>In microlensing, the lens object is in general a star crossing the line of sight between the observer and a background star. The majority of microlensing events detected are in the region of the Galactic Bulge because this densely-populated background field presents the hightest event probability. Even there, the microlensing optical depth is still low τ ∼ 10 −6 ( <ref type="bibr" target="#b54">Udalski et al. 1994;</ref><ref type="bibr" target="#b2">Alcock et al. 2000;</ref><ref type="bibr" target="#b47">Sumi et al. 2011</ref><ref type="bibr" target="#b48">Sumi et al. , 2013</ref>. If the lens is a single massive object, it deflects the light from the background source star into two images separated by several θ E , the angular Einstein ring radius <ref type="bibr" target="#b26">(Gould 2000)</ref>:</p><formula xml:id="formula_0">θ E = κMπ rel (1)</formula><p>where M is the total lens mass, π rel is the lens-source relative parallax and κ a constant. For typical events toward the Galactic Bulge, θ E is order of few milliarcsec, leading to images that are undistinguishable with current capabilites. However, each image are magnified and then the source flux increase by the total magnification factor A(t), which for a PSPL model is given by <ref type="bibr" target="#b41">(Paczy´nskiPaczy´nski 1986;</ref><ref type="bibr" target="#b26">Gould 2000)</ref> :</p><formula xml:id="formula_1">A PSPL (t) = u(t) 2 + 2 u(t) u(t) 2 + 4 ; u(t) = u 2 o + (t − t o ) 2 t 2 E (2)</formula><p>where u(t) is the source-lens impact parameter and u o = u(t o ) is the minimum impact parameter (linked to the maximum amplification A o ) at the time t o . t E is the Einstein ring crossing time :</p><formula xml:id="formula_2">t E = θ E µ (3)</formula><p>where µ is the relative proper motion between the source and lens (i.e. due to the proper motions of Earth, lens and source). It is interesting to note the following properties :  The crowded fields where microlensing is typically observed suffer from a high degree of blending, meaning that the source star point spread function (PSF) usually overlaps those of other stars (including the lens itself). In combining data provided by telescopes which may have different pixel scales and seeing characteristics, it is necessary to take into account the different degree of blended flux f b,i observed by telescope i as well as the flux from the source, f s,i , to give the total flux as a function of time, f i (t), (Gaudi 2012):</p><formula xml:id="formula_3">A PSPL          ∼ 1 u ; u → 0 ∼ 1 ; u → ∞<label>(4</label></formula><formula xml:id="formula_4">f i (t) = f s,i A(t) + f b,i = f s,i (A(t) + g i ) ; g i = f b,i f s,i .<label>(5)</label></formula><p>Therefore, a PSPL model is described by 3 + 2n i parameters where n i is the number of observatories.</p><p>3.2. Finite Source, Point Lens (FSPL) model The PSPL models assume that the source is a point. However, this hypothesis breaks down when the source-lens separation becomes small enough to be comparable to the normalised angular source radius ρ = θ * θ E ( <ref type="bibr" target="#b61">Yoo et al. 2004</ref>). For a typical source star in the Galactic Bulge and a typical lens in the Galactic Disk, ρ ∼ 10 −3 . This indicates that the effects of finite source size appear when an event becomes highly magnified (i.e u approaches zero). Following <ref type="bibr" target="#b59">Witt &amp; Mao (1994)</ref>; <ref type="bibr" target="#b61">Yoo et al. (2004)</ref>; <ref type="bibr" target="#b10">Cassan et al. (2006)</ref>, we used the high-magnification approximation to express the magnification of an extended source with a linear limb-darkening law <ref type="bibr" target="#b38">(Milne 1921;</ref><ref type="bibr" target="#b3">An et al. 2002)</ref> for the wavelenght λ:</p><formula xml:id="formula_5">A FSPL (t, λ) = A PSPL (t)[B 0 (z) − Γ λ B 1 (z)] ; z = u ρ<label>(6)</label></formula><p>where</p><formula xml:id="formula_6">Γ λ = 2u λ 3−u λ</formula><p>is the microlensing linear limb-darkening coefficient (u λ is the Milne linear limb-darkening coefficient for the wavelength λ), B 0 (z) and B 1 (z) are completely defined in <ref type="bibr" target="#b61">Yoo et al. (2004)</ref> and <ref type="bibr" target="#b10">Cassan et al. (2006)</ref>.</p><p>We implemented a numerical table for B 0 (z) and B 1 (z) and their derivative terms within pyLIMA and use a linear interpolation to derive appropriate appropriate coefficients for each computation. The functions B 0 (z) and B 1 (z) are define by incomplete elliptic integrals, which are slow and computational intensive to calculate on the fly, explaining our choice of a pregenerated table. This infrastructure makes it straight forward to implement a higher-order limb darkening law if needed in the future. As noted by <ref type="bibr" target="#b34">Lee et al. (2009)</ref>, this approach breaks when ρ ≥ 0.1, because the approximation A ∼ 1 u breaks for u ≥ 0.1. Fortunately, it is extremely rare to observe ρ &gt; 0.05 for events in the Galactic Bulge. <ref type="bibr" target="#b34">Lee et al. (2009)</ref> proposed a more robust algorithm but this is more time consuming for most purposes since it requires the computation of double integrals. Nevertheless, we plan make this algorithm available as an option to the user in future versions. Currently, the user can either specify values of Γ λ for each telescope manually, or allow the code to calculate it automatically from the userdefined telescope filter, source star effective temperature T eff and surface gravity log g, using Claret &amp; Bloemen (2011).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">FITTING ALGORITHMS</head><p>To date, we have implemented three main solution-finding techniques to fit events. Note that all methods are applicable to all type of models.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">Implementation of Levenberg-Marquardt algorithm</head><p>This method, called 'LM' in pyLIMA, is based on the Levenberg-Marquardt algorithm <ref type="bibr" target="#b35">(Levenberg 1944;</ref><ref type="bibr">Mar- quardt 1963)</ref>. In python, this function is part of the scipy.optimize.leastsq package which itself is a wrapper of the C library MINPACK. Following Newton's method, this algorithm uses the gradient to reach the local minimum. The objective function for this method is simply the χ 2 :</p><formula xml:id="formula_7">χ 2 = i (d i − m i ) 2 σ 2 i (7)</formula><p>where d i is the i-th data point, m i is the predicted model value and σ i is the uncertainty on d i . For PSPL and FSPL, we decided to pass the analytical Jacobian matrix (i.e the analytical derivatives of each parameters) to speed-up the convergence.</p><p>In theory the method should stop when the gradient derivatives reach zero, that is, when the algorithm reaches a critical point. However the convergence of this algorithm is set differently. The algorithm stops if : f tol (the relative objective function improvement), x tol (the parameters absolute difference) and/or g tol (the angle between the Jacobian vectors and residuals) are below given thresholds. Note that all of these parameters can be modified easily by the user if needed.</p><p>The main difficulty for this method is the requirement for a good initial guess of the parameters. In pyLIMA, the user can provide these guess, but we also developed a method for an automatic estimation. While this can be straightforward for our simulated data, where the noise was often negligible relative the signal, it can be difficult for real data. Here we describe the methods we use to estimate each parameter.</p><p>• t o : This parameter may appear to be the simplest one to find, because a good intial guess should be the brightest point in the lightcurve. However, this approach can easily fail for noisy datasets, so we choose a different approach. Note that we perform this method for all available lightcurves present in the event. For each lightcurve, we first temporarily remove data points with high photometric errors(i.e σ ≤ min(0.1, ¯ σ). Next, we construct a smooth lightcurve using a Savitzky-Golay filter of degree one on the photometry. Then, we perform a loop by selecting points with a flux higher than the actual median and presenting the best photometry as previously described. The loop stops if there is less than 100 points or if the standard deviation of the time is less than five days. t o for each lightcurve is then the median in time of the remaining points. The final t o value is chosen to be the mean, weighted by the magnitude uncertainty, for all the telescope's datasets. In fact, weighting the different t o estimation with the magnitude uncertainty gives more weight to datasets with better photometric precsion, where one would expect this algorithm to have greater success.</p><p>• f s : Secondly, we try to find the baseline flux for the survey telescope. This is done in a loop by selecting points below (or within the errobar) of the median flux. Then, by assuming no blending, the source flux for the survey dataset is just equal to the baseline flux.</p><p>• u o : Knowing f s , it is possible to compute A max = max( f lux)/ f s , the maximum magnification in the survey dataset at the point selected by the t o estimation, and then</p><formula xml:id="formula_8">u o = −2 + 2 1 − 1/(1 − A 2 max ).</formula><p>• t E : The estimation of t E is made using three different methods, the final value being the median of the three. The first method use the fact than when A = A max /2,</p><formula xml:id="formula_9">then t E = ± t demi −t o −2+2 √ 1+1/(B 2 −1)−u 2 o , with B = 1 2(A max +1) . The second uses the fact that A(t E ) = u 2 o +3 (u 2 o +1) √ u 2 o +5</formula><p>. The algorithm tries to find points closest to this value. The last estimation is a very rough approximation that finds the closest point after/before t o consistant with the baseline flux and use this as a t E approximation.</p><p>• f s and g : These parameters are found for each telescope by using the parameters estimated above, and conducting a linear fit. Note that if f s &lt; 0, then the minimum flux value is return as f s and g are set to zero. <ref type="bibr" target="#b46">Storn &amp; Price (1997)</ref>. This method is really robust for a vast range of problems, see for example <ref type="bibr" target="#b57">Vesterstrom &amp; Thomsen (2004)</ref>, but is more time consuming than 'LM'. This method is called 'DE' within pyLIMA. Again, we used the χ 2 as the objective function. The covergence condition is set by the parameter tol = ¯ χ 2 σ tol &gt; 1 where ¯ χ 2 is the mean of the objective function for all population members and σ is its standard deviation. We set this parameter to 10 −5 . This method is used to find robust guess, which are then used in the method 'LM' presented previously. Note that we slightly changed our fitting strategy in this method. f s and g are not considered as standard parameters (i.e a full differential evolution search), but they are computed for each step as a linear regression of the flux over the magnification. This is due to the fact that if these parameters are set free, the parameter space volume increases dramatically for a small range of potential correct values.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2.">The differential evolution This method is a global optimizer originally presented by</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.">A Monte-Carlo Markov Chain algorithm</head><p>It is useful to generate the posterior distributions for an event and thus be aware of all plausible models. We implemented MCMC based on the python module emcee <ref type="bibr" target="#b24">(Foreman-Mackey et al. 2013</ref>). This method requires good initial parameters, which are produced by the method 'DE' in pyLIMA. The user can select whether f s and g are used as MCMC parameters or computed using a linear regression of the telescope's flux versus the magnification. This method can be called using the 'MCMC' option. Note that this method tries to maximize the log-likelihood, so we set the objective function in this case to be :</p><formula xml:id="formula_10">log L = −χ 2 /2<label>(8)</label></formula><p>4.4. Speed performace As can be seen from <ref type="table">Table 1</ref>, the median time for the Ground, Space and FSPL fits is of order 0.01, 0.02 and 0.1 seconds respectively. The fits to Space datasets are slower owing to them having higher numbers of points on average. The FSPL dataset is ten times slower for two main reasons. First, the magnification computation is slower due to the linear interpolation necessary to take account of finite source effects. Second, there are two datasets leading to a more complex model and also more data points. Note that the 'DE' method converges in general in about 15 seconds, which is reasonable given the volume of parameters space it explores. For reference, all our modeling was conducted using an Intel Core i7 CPU 860 @ 2.80GHz, 8 processor and 16 GB of memory.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">PYLIMA FITS ON VARIOUS DATASETS</head><p>It is crucial to understand how a modeling code performs, we then decide to conduct various tests on both simulated and real datasets. This is a standard method used to test modeling codes on planet detections using the radial velocity and/or the transit method ( <ref type="bibr" target="#b17">Díaz et al. 2014;</ref><ref type="bibr" target="#b8">Borsato et al. 2014</ref>; Dumusque 2016; <ref type="bibr" target="#b23">Dumusque et al. 2017</ref>).The details of simulations can be found in the Appendix A, where we also define the quality fits metric.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1.">The Ground and Space datasets</head><p>The Σ x results for the Ground and Space datasets can be seen in <ref type="table">Table 1</ref>, <ref type="figure" target="#fig_2">Figure 2</ref> and <ref type="figure">Figure 9</ref>. From these metrics, it can be seen that pyLIMA accurately recovered the injected models. However, several trends were observed. First, it appears that the fits to the Space dataset are more accurate though at the expense of requiring extra computation time (pyLIMA is about 1.8 slower for this dataset). Both features are explained by the fact that the Space dataset contains more data points (i.e continuous coverage), with a better photometric quality on average (no red noise and photometric precision limited to 0.1%). Note that this last point also explains why the χ 2 dof distribution of the Ground dataset is skewed, while the Space one is not. The photometric limitation of 1% for the Ground dataset induce events with error bar overestimation. This straight leads to a χ 2 understimation as can be seen on the last plot of <ref type="figure" target="#fig_2">Figure 2</ref>. Secondly, it may seem strange that Σ t o is minimal when t o occur outside the observing windows on both datasets, where one would expected that the fitted model should be worse. In absolute terms, the fitted model's t o estimates are poor but due to the high uncertainty σ t o ,pyLIMA for these fits, Σ t o vanishes. A discussion about parameter's uncertainties can be found on Appendix B. Another interesting trend can be seen in the Σ u o distributions. For the largest model's u o values, which corresponds to lightcurves with the lower signal, pyLIMA tends to overestimate u o (i.e underestimate A o , the maximum magnification). This is due to the fact that this kind of lightcurve can be equally well fitted with and without blending flux, as explained in <ref type="bibr" target="#b50">Thomas &amp; Griest (2006)</ref>. Note however that this trend is not critical because the fitted values are still less than 1 σ away from the models.</p><p>The Σ x shows that pyLIMA accurately fits these datasets in general, but also reveals some unexpected results. In fact, some of the simulated lightcurves were intrinsically very difficult to fit, for example when the observing windows are quite small relative to the event duration. This kind of problem is likely to impact the future space mission. The WFIRST microlensing mission, for instance, will consist of 6 year of 70 days of observing windows. This is why we limited the observing window to 90 days for the Space datasets. We therefore split the lightcurves into five distinct categories:</p><p>• Regular : The lightcurve doesn't present any of the conditions listed below.</p><p>• No peak : The lightcurve peak occurs outside the observing window.</p><p>• High blending : The lightcurve is highly blended in the model (g &gt; 1).</p><p>• No baseline : The lightcurve never reaches its baseline during the observing windows (|t − t o | &lt; t E ∀t).</p><p>• Hard : The lightcurve presents at least two categories listed above.</p><p>An example of a 'Regular and 'Hard' lightcurves is visible in the <ref type="figure" target="#fig_3">Figure 3</ref> lightcurves for the Space dataset. We computed the Λ x metric for each subclass and present our results in the Table 2, <ref type="figure" target="#fig_4">Figure 4</ref> and <ref type="figure" target="#fig_1">Figure 11</ref>. Again, the behaviour of the fits is similar for both datsets and we can characterize the software's performance in each category:</p><p>• Regular : For these lightcurves, pyLIMA accurately recover the model parameters, without any particular trends in the Λ x distributions and without any failures.</p><p>• No peak : For this subset, it is interesting to note that the parameter t o is relatively well estimated, without particular trends. However, there are serious trends in the u o , f S and g distributions. A lot of fits for these events converge to very low u o values (the orange peak around Λ u o = 1 in the <ref type="figure" target="#fig_4">Figure 4</ref> and <ref type="figure" target="#fig_1">Figure 11</ref>). In other words, pyLIMA predicts unrealistically high magnification for these events. These results confirm previous work which indicated that χ 2 minimization algorithms tend to overestimate the magnification if the peak is not observed (see for example <ref type="bibr" target="#b0">Albrow (2004)</ref> or <ref type="bibr">Do- minik (2009)</ref>). This may be related to overfitting. In these cases, the magnification is slightly overestimated, leading to an overstimation of the blending g and so to an underestimation of f s . This occurs because the lightcurve baseline flux, f baseline = f s (1 + g), is in general well constrained (the orange peak around Λ g ∼ 1 and the asymmetry on the left for the orange Λ f s distribution). We found two fit failures for the Space dataset in this category, but considering that ∆χ 2 equal -0.41 and -0.85 respectively, we do not consider these Failures as critical.</p><p>• High blending : We note that for a large fraction of these lightcurves the fitted model indicated no blending (i.e the green peak around Λ g = 1). This understimation of the blending is linked to an overestimation of A(t), leading to skewed distributions for Λ u o (left) and Λ t E (right). We notice that this category contains a significant number of fit failures for both datasets : 0.9% (Ground) and 2.57% (Space). This is due to lightcurves with a very low signal to noise (i.e the lightcurve is nearly flat). These events are particulary difficult to fit, with a median blending values of 7.8 and 5.40 respectively. Note that all these failures come from the method 'LM'.       <ref type="table">Table 3  Table 1</ref> for the three extra FSPL parameterers.</p><p>• No baseline : It is interesting to notice that this category does not present particular trends. Intuitively, one might expect that the t E parameter needs baseline observations to be well constrained. As shown by <ref type="bibr" target="#b18">Dominik (2009)</ref>, A(t) → t E |t−t o | in the area u o t E &lt;&lt; |t − to| &lt;&lt; t E . Therefore, if this region is well sampled, which is the case for this subset, t E is relatively well constrained.</p><p>• Hard : As expected, this subset presents the worst fitting results. The ratio of failures is the highest for both datasets and fitted parameters are often off from the model (i.e Λ x 0). We checked the failed-fit events individually and did not find any critical fit (i.e a fitted model totally in disagreement with the data). The slight disagreement between models and fits (median values of ∆χ 2 are -5.9 and -3.1 for the Ground and Space dataset respectively) come from an understimation of the blend flux (median values of injected blend flux are 27.4 and 20.6).</p><p>Based on these results, overall pyLIMA's fitting procedure is highly reliable. The fitted models and estimated uncertainties accurately represent the data for the majority of events. We carefully analyzed the problematic cases and found that instances of poor model fits are a consequence of the intrisic nature of the data (i.e the lightcurve category) rather than a software problem. <ref type="table">Table 1 and Table 3</ref> present the Σ x results for this dataset (distributions can be seen in <ref type="figure" target="#fig_1">Figure 10</ref> and <ref type="figure" target="#fig_1">Figure 12)</ref>. pyLIMA performed well for this dataset overall, though the fitted model parameters are somewhat less accurately derived than in the previous section. The percentage of events inside the 3 |Σ x | windows is lower and pyLIMA required the 'DE' method more frequently. The first trend can be explained by the fact that the fitted parameters errors are ∼ 10 time smaller. For instance, the median values for the t o , u o and t E errors are [10 −3 , 4 × 10 −4 , 9 × 10 −2 ] for the FSPL dataset when they are [2 × 10 −2 , 2 × 10 −2 , 4 × 10 −1 ] for the Space dataset. Another explanation for the relative low success of the Σ ρ criterion is that for some events, the finite source effect is negligible (i.e when ρ &lt; u o ). In these cases, the lightcurves can be equally well fitted with a PSPL model, causing the parameters u o and ρ to converge far from the model. The second trend is due to the intial guess for ρ produced by the 'LM' method. It is set to 0.05, which is a very naive and can be far from the correct solution. Note that several alternative initial-guess values were tested, such ρ =   factors. Some lightcurves present very weak finite-source effects. In this case, the lightcurve can be equally fit with a PSPL model. The second case is linked to the following property of Equation 6 :</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.">The FSPL dataset</head><formula xml:id="formula_11">A FSPL ∼ 2 ρ ; z → 0<label>(9)</label></formula><p>This means that if z tends to be small, u o is not constrained whenever ρ is (this explains the difference between the u o and ρ columns on the first line of the <ref type="table">Table 4</ref>). For the fit failures, it is obvious from <ref type="table">Table 4</ref> that this comes from an incorrect estimation of u o and/or ρ. However, as we saw previously, some lightcurves could have very weak finite-source effects, making any fit problematic. From Equation 6, it is clear that one key fit parameter is z o = u o ρ . In fact, it is more relevant to define min z = min(z), the minimum impact parameter sampled by the observations, divided by ρ. A distribution of this parameter is presented in <ref type="figure" target="#fig_6">Figure 5</ref>. We can see that pyLIMA fails when min z &gt; 1, in the area where finite-source effects tend to be smaller. It is important to note that more than half of the failures (51.6%) occurs for an area containing only 17.1% of the total number of events. For failures occuring for min Z &lt; 1, the situation are more complicated, and linked to multiple factors including photometric noise, low sampling, local minimas. To conclude, it is important to emphasize that the 'DE' method is much more reliable (6.5% of failures) than the 'LM' method (18% of failures).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3.">The OGLE II survey</head><p>To challenge pyLIMA we decided to model microlensing events from the OGLE II ( <ref type="bibr" target="#b54">Udalski et al. 1994;</ref><ref type="bibr" target="#b53">Udalski 2003;</ref><ref type="bibr" target="#b49">Szymanski 2005</ref>) survey. We selected events detected in the Galactic Bulge in the three <ref type="bibr">seasons 1998, 1999 and 2000</ref>. This leads to 41, 46 and 75 lightcurves respectively. We performed two runs of PSPL modeling, using the 'LM' and 'MCMC' methods.</p><p>We discarded lightcurves which present ambiguous behaviour or physical phenomena not yet incorporated into pyLIMA's functionality: binary microlensing, falsely classified as microlensing, variable stars, high photometric noise, etc. We reject 5, 14 and 10 lightcurves from the respective seasons which leads to a subset of 133 lightcurves in total. We reviewed the litterature and found several studies which also examined this dataset. <ref type="bibr">Udalski</ref>   <ref type="table">Table 4</ref> |Λ x | succes ratio for the FSPL dataset. Note that the ∀x column indicates the percent of events satisfying |Λ x | &lt; 0.1 for all parameters. Numbers in bracket in the first column indicate the number of events where the method 'DE' was use. The low success ratio for u o and ρ in the 'Failures' category are due to the problematic events already seen in the <ref type="figure" target="#fig_6">Figure 5</ref> : these events present weak finite-source effects and/or problematic data. Then, it is possible to find competitive models without finite-source effects.  <ref type="table">Table 5</ref>. The grey shade indicate the 1 σ fit errors.</p><p>cific event OGLE-1998-BLG-14 in order to estimate its planet sensitivity.</p><p>The results of our analysis are plotted in <ref type="figure" target="#fig_7">Figure 6</ref> and Table 5. It is interesting to underline that these studies produced various results for A o and t E , which are the key fit parameters, with the exception of the two methods used by pyLIMA. U2000 and T2003 tend to systematically underestimate t E and A o in comparaison with pyLIMA. This is understandable because they do not include blending flux in their fits. W2001 included blend fluxes fitting, leading to better agreement with pyLIMA for t E . For the special case of OGLE-1998-BLG-14, the results between A2000 and pyLIMA 'LM' are in excellent agreement : Σ t o = −0.10, Σ t E = 0.10 and Σ A o = 0.10. Note that we use the results of the column 'c' of the <ref type="table" target="#tab_4">Table 2</ref> in A2000, where the fit was made using OGLE and PLANET follow-up data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.4.">Comparison with the ARTEMiS system</head><p>The ARTEMiS pipeline ( <ref type="bibr" target="#b19">Dominik et al. 2008</ref>) is one of the best real time fitter and anomaly detectors. It is used by the MiNDSTEp group to prioritize their follow-up targets. It performs PSPL fits on all datasets available for each event. We collected all microlensing events from the OGLE 2015 season (and all associated datasets available through the ARTEMiS portal) and compared our fits with those of ARTEMiS. 2145 events were fitted and the results are presented in <ref type="table" target="#tab_11">Table 6</ref>. This time, the Σ x criterion is computed as follow :</p><formula xml:id="formula_12">Σ x = x Artemis − x pyLIMA σ x,pyLIMA + σ x,Artemis<label>(10)</label></formula><p>We visually inspected each lightcurve where ARTEMiS and pyLIMA disagreed (i.e |Σ x | &gt; 3) and found four different possibilites :</p><p>• Anomalous : The event is clearly not a single lens microlensing event. It could be due to a binary source, a binary lens microlensing event or a cataclysmic variable for example.</p><p>• Unknown : There is no obvious sign why ARTEMiS and pyLIMA disagree. This could be due to an understimation of errors in both algorithms.</p><p>• ART EMiS f ailures : The ARTEMiS fit does not agree with the observations.</p><p>• pyLI MA f ailures : The pyLIMA fit does not agree with the observations.</p><p>We can see that ARTEMiS and pyLIMA agreed about the vast majority of events. The number of failures are low, 1.3% and 1.0% for ARTEMiS and pyLIMA respectively. We note that majority of pyLIMA failures come from a bad estimation of t o . All these failures were made using the method 'LM', and despite the sanity check step, pyLIMA treats these fits as acceptable.</p><p>5.5. Published FSPL events As a final test, we wanted to examine pyLIMA's performance for FSPL events. We found public data for two events : MOA-2007-BLG-400 ( <ref type="bibr" target="#b21">Dong et al. 2009</ref>) and <ref type="bibr">MOA-2008</ref><ref type="bibr">- BLG-310 (Janczak et al. 2010</ref>). These two events present planetary anomalies close to their peaks, however due to the large source sizes relative to the central caustic sizes (i.e ω ρ &lt; 2), these anomalies have low amplitudes (≤ 10%) and so an FSPL model is a reasonable fit for almost the entire lightcurves. Finally, we also fit OGLE-2013-BLG-0446 ( <ref type="bibr" target="#b5">Bachelet et al. 2015</ref>) which is a similar event where the authors demonstrated that the hypothetical small planetary signal (≤ 1%) is probably due to red noise.</p><p>For MOA-2007-BLG-400 and MOA-2008-BLG-310, we used the values of T eff given by the authors to compute Γ I and Γ H using <ref type="bibr" target="#b15">Claret &amp; Bloemen (2011)</ref>. Note that for these events, the authors used a square-root limb-darkening law, which can explain some fitting differences. For OGLE-2013-BLG-0446, we used Γ λ values give in the publication. These results can be found in <ref type="table">Table 7</ref>.</p><p>Again, the results are in good agreement with the literature. The χ 2 of pyLIMA fit for OGLE-2013-BLG-0446 is higher, but these calculations are made without any errorbar rescaling. As shown in <ref type="bibr" target="#b5">Bachelet et al. (2015)</ref>, some telescopes need high errorbar rescaling to obtain a normal distribution of the fit residuals.       <ref type="table">Table 7</ref> pyLIMA fits results for the three FSPL like events. Results are in good agreement with the literature.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">CONCLUSIONS AND RECOMMENDATIONS</head><p>In this paper, we describe the first phase of the development of pyLIMA, an open source microlensing analysis package. We present the method and tools we used to build a flexible and easy to use architecture, accessible to all users. We have conducted a series of test to assess the reliability of pyLIMA fitting two single lens models, both on simulated and real datasets. To do so, we define three different metrics to assess the quality of the fits.</p><p>Results on the simulated Point-Souce Point-Lens events are statisfying both in terms of fit convergence (≥ 99%), parameters and uncertainties estimation. The complete analysis of our simulations reveals several trends already discovered in the litterature <ref type="bibr" target="#b0">(Albrow 2004;</ref><ref type="bibr" target="#b50">Thomas &amp; Griest 2006;</ref><ref type="bibr">Do- minik 2009)</ref>. This study also highlights potential issues of future microlensing space missions due to their relative short observing windows (i.e ≤ 100 days) every year. We also used pyLIMA to fit the OGLE-II dataset and found a good agreement with four previous studies. Finally, we found an excellent agreement between pyLIMA and the ARTEMiS system on the OGLE-IV 2015 microlensing season (i.e ≥ 90 % match).</p><p>We also implemented the Finite-Souce Point-Lens model and runs similar tests. Despite a good agreement, we found a higher failure occurence (∼ 18%). This is due to two main reasons. The first one is due to the difficulty to find a "good enough" estimation of ρ when using the 'LM' method. The second one is due to some difficult lightcurves where the finite-source effects are low (i.e z &gt; 1). The failure rate drops significantly when the 'DE' method is used (6.4% versus 18%).</p><p>Based on these results, the authors make some recommendations to users. The fitting of lightcurves with PSPL models can be made using the 'LM' method with a good expectation of fit convergence. This enables the user to study large datasets in a reasonable ammount of time. In case of doubts or the failure of a fit, the 'DE' method should be used. Fitting FSPL models needs a bit more caution. If the lightcurve is well sampled and exhibits strong finite-source effects, the 'LM' method should converge. In other case, users are encouraged to use the method 'DE'. Finally, the authors recommand the use of the 'MCMC' method only in two cases. First, the 'MCMC' method is used to derive the event parameters posterior distributions. This give a more complete view to the parameter space than the 'LM' method. Secondly, if the event is poorly constrained, it is likely that the Fisher matrix inversion will return unrealistic error. Then the 'MCMC' approach should return a more comprehensive view of the problem. To conclude, we would like to notice that this have a cost, since the 'MCMC' method is about 2000 slower than the 'LM' (or 'DE') method, since it requires the computations of thousands of models. NASA's Astrophysics Data System. Work by EB and RAS is support by the NASA grant NNX15AC97G.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>APPENDIX</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DESCRIPTION OF SIMULATIONS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Description of the datasets</head><p>The Ground dataset</p><p>The first dataset, called Ground, mimics PSPL observations from a unique terrestrial survey such as OGLE ( <ref type="bibr" target="#b56">Udalski et al. 2002)</ref> or MOA ( <ref type="bibr" target="#b7">Bond et al. 2001</ref>). The observing window was arbitrarily set to <ref type="bibr">[0,</ref><ref type="bibr">182]</ref> days for each lightcurve. This corresponds approximately to a one year observation of the Galactic Bulge from the South hemisphere. We first implemented a night/day cycle and we selected the number of exposures per night from a uniform distribution between 1 and 30 to mimic survey observations of different fields with different cadences. To make these simulations more realistic, we implemented potential bad weather. 10 % of nights were randomly selected to be "bad weather" (no observations). We also implemented a full moon avoidance windows ( 5 days in a row). However, to ensure that a microlensing event would be detected, we ensured that at least two points were observed around the event peak t o . We decided to implement Poisson and red noise sources, the latter with a sum of low amplitude (≤ 5%) and low period (≤ 10 days) sinusoidal functions. The photometric precision was limited to a minimum of 1%. u o was selected from a uniform distribution between 10 −4 and 1, while t E was selected from a log-normal distribution (µ = 2.8, σ = 0.9), which is a rough approximation of the expected one (see for example <ref type="bibr" target="#b47">Sumi et al. (2011)</ref>). t o was generated from a uniform distribution between −t E and 182 + t E days and the source and blend magnitudes were produced from a normal distribution of (µ = 18, σ = 1.5) and (µ = 19.4, σ = 1.6) respectively.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The Space dataset</head><p>The second dataset, called Space, reproduces PSPL observations from a space-based survey such as WFIRST ( <ref type="bibr" target="#b45">Spergel et al. 2015</ref>) or EUCLID ( <ref type="bibr" target="#b33">Laureijs et al. 2011</ref>). The data were simulated in the same way as above, except that we implemented continuous coverage (no night/day cycle), we restricted the photometric precision to a minimum of 0.1%, we set the observing windows to <ref type="bibr">[0,</ref><ref type="bibr">90]</ref> days and we fixed the observation sampling to 30 minutes. This is an approximation of the expected duration of the annual WFIRST Bulge surey. We also removed red noise effects from our simulations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The FSPL dataset</head><p>For this dataset, we simulated two telescopes (Survey and Follow up) for each FSPL event. This represents the fact that finite source effects are detected only in high magnification events, which are a priority for the follow-up teams such as RoboNet, PLANET, MiNDSTEp or µFUN because they are highly sensitive to planets <ref type="bibr" target="#b28">(Griest &amp; Safizadeh 1998)</ref>. In these events, the effects of finite angular source size are seen only close the magnification peak and have a short duration (from hours to a few days). Using two telescopes is also consistent with the design goal that pyLIMA should be generally applicable to all groundbased and space-based datasets. Since until recently a lot of microlensing events have been covered by a combination of surveys and follow-up data, and since this is the most challenging combination of data, this is an excellent test case for the code. The Survey observatory is similar to the Ground simulations presented above. This dataset represents a single site survey, which contains a daily gap in the lightcurve due to the day/night cycle. To ensure that finite source effects were really present in our simulations, the Follow up data consists of two days of observations around t o in order to catch deviations from a PSPL model. The source magnitude and blending ratio of the Follow up observations are chosen to be different from those of the 'Survey' data in order to reproduce the fact that these follow-up telescopes have different spatial resolutions, sky conditions and photometric reduction pipelines. We also choose a random cadence of observations (between 0 and 30) for the Follow up dataset. We decided to implement Poisson noise and red noise for both telescopes. To ensure that finite source effects were observed, we forced t o to be inside the observing window [0 to 183] days. We selected ρ from a uniform distribution from 1 2 u o to min(10 u o , 0.05). We limited the unifom distribution of u o from 10 −4 to 0.025 and the photometric precision to 1%. For the purposes of this paper, we set Γ λ = 0.5 for the simulation and the fitting process. Again, ten thousand events were simulated.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Definition of fit quality metrics</head><p>To evaluate the accuracy of the fits, we compared the results from pyLIMA to the injected models in the lightcurves. It is true to say that the best fit model is never identical to the injected model due to the noise in the data and the discontinuous sampling. However, it is also true that the input model represents the observations accurately. Therefore, a comparison of the injected versus the best-fit model parameters can be used to test the robustness of the fit (i.e to estimate the accuracy of the parameters derived from the fit). We defined three differents metrics to analyze the fits of our simulated events.</p><p>We first defined the Σ x metric :</p><formula xml:id="formula_13">Σ x = x model − x pyLIMA σ x,pyLIMA (A1)</formula><p>where x is the model parameter and σ x,pyLIMA is the error on the parameter returned by pyLIMA. For the method 'LM', σ x,pyLIMA is the square root of the parameter's variance obtained from the fit covariance matrix. In future version of this software, this approximation will be replaced by more robust methods to estimate the variance, such as the bootstrap technique. It is also informative to judge predictions made by the fit for the future evolution of an event. For example, if an event has not yet reached its peak, we can judge how well pyLIMA estimates the microlensing parameters (i.e. we can define a good prediction if |Σ x | &lt; 1 ; ∀x for example). It also reveals whether parameter errors are correctly estimated. However, this metric suffers one strong flaw : it vanishes when the parameter error diverges, which can happen with the covariance matrix estimation (see Section B).</p><p>To counter this problem, we defined a second metric Λ x :</p><formula xml:id="formula_14">Λ x = x model − x pyLIMA x ;                    t o = t E,model u o = u o,model t E = t E,model f s = f s,model g = g model (A2)</formula><p>This metric is then a relative error and is insensitive to the estimation of parameter uncertainties. We opted to consider a fitted value acceptable if |Λ x | &lt; 0.1. Finally to judge whether or not a fit is a succes, we computed:</p><formula xml:id="formula_15">∆χ 2 = χ 2 model − χ 2 pyLIMA (A3)</formula><p>This is a more robust statistic than χ 2 dof because the latter could be insensitive to a bad fit where the "area of interest" (i.e the microlensing event) is not significant regarding the total lightcurve length. We finally defined a fit successful if ∆χ 2 &gt; 0. However, we also computed the χ 2 dof and present this in the following sections for completeness.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DISCUSSION ON THE PARAMETERS ERRORS ESTIMATION</head><p>In this appendix, we study in more details the behaviour of the parameters error estimations. Error estimations for the methods 'LM' and 'DE' come from the inverse of the Fisher matrix whereas the error estimations for the 'MCMC' method come from the 1 sigma confidence interval around the distribution median. The Fisher matrix can be written as <ref type="bibr" target="#b52">Tsapras et al. (2016)</ref>:</p><formula xml:id="formula_16">F i, j =        log L d p i               log L d p j        (B1)</formula><p>where log L is the log-likelihood function. In the case where the noise model is assumed indepedent of the model, uncorrelated and normally distributed (LSST Science <ref type="bibr">Collaboration et al. 2009</ref>), the log-likelihood can be write as:</p><formula xml:id="formula_17">log L = − 1 2 n log 2π − 1 2 n (d n − m n ) 2 σ 2 n (B2)</formula><p>Assuming two parameters (p i , p j ) of the model m, we can rewrite the Fisher matrix: <ref type="bibr">Science Collaboration et al. 2009)</ref>, with the Kronecker delta function noted δ k,l , the Fisher matrix reduce to <ref type="bibr" target="#b39">(Mogavero &amp; Beaulieu 2016)</ref>:</p><formula xml:id="formula_18">F i, j = k (d k − m k ) σ 2 k dm k d p i l (d l − m l ) σ 2 l dm l d p j (B3) Since (d k − m k )(d l − m l ) = σ 2 k δ k,l (LSST</formula><formula xml:id="formula_19">F i, j = n 1 σ 2 n dm n d p i dm n d p j (B4)</formula><p>The details for each PSPL parameters are listed below :</p><p>•  <ref type="figure">Figure 7</ref>. Distributions of parameters errors from pyLIMA 'LM' (thick line histograms) and from pyLIMA 'MCMC' (light plain histograms) for the Space dataset. Events are sorted by categories in line and colors according to Section 5.1. The two methods estimate similar errobars for well-contrain events, but present severe differences in case of problematic lightcurves. This underlines a data issue rather than a fitting routine problem.</p><p>•</p><formula xml:id="formula_20">dA du = −8 u 2 (u 2 +4) 3/2 • d f d f s = A + g • d f dg = f s</formula><p>Since the 'LM' and 'MCMC' methods estimate parameters uncertainties in a different way, it is informative to compare their respective results on the same datasets. First, we refit all the Space lightcurves defined in the Section A.1.2 using the 'MCMC' method. Parameters uncertainties for both methods are visible in the <ref type="figure">Figure 7</ref>. The general trend to notice is that the MCMC and LM methods agree for small uncertainties (i.e well defined events) and disagree for larger uncertainties. The 'LM' method tends to overestimate errors for unconstrained events. This can be explain by the covariance matrix approach of uncertainties estimation, which assume that the χ 2 landscape is parabolic close to a minimum. This hypothesis breaks in case of ill-defined events and therefore a correction factor is needed in the covariance approach. On the other side, uncertainties estimated through the 'MCMC' method look more realistic and stable, regardless of the nature of the event. This of course has a cost : the 'MCMC' fitting time of an event is roughly 2000 times slower than the 'LM' method.</p><p>We decided to conduct a similar study on real data. We use the analysis made on section Section 5 to compare errors coming from the methods 'LM' and 'MCMC' for the OGLE-II fits. However, we decide to change the diagnosis metric and compare the error volume for both datasets ( <ref type="bibr" target="#b52">Tsapras et al. 2016</ref>): V = i σ i (B5) <ref type="figure">Figure 9</ref>. Σ x distributions for the Space dataset. When all parameters present similar results as <ref type="figure" target="#fig_2">Figure 2</ref>, the χ 2 /dof is significantly different. For this dataset, the photomotric precision was not limited to 1%, explaining the non-skewed distribution. <ref type="figure" target="#fig_1">Figure 10</ref>. Σ x distributions for the FSPL dataset. In contrary to Ground and Space dataset, there is no particular trends in the t o and u o distributions, because we forced events to peak in the observing windows and because the event peak is well constrained by the Follow-up dataset. <ref type="figure" target="#fig_1">Figure 11</ref>. Λ x distributions for the Ground dataset. Again, it is clear that poor fits are due to problematic lightcurves rather than pyLIMA fitting procedure. </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>3</head><label></label><figDesc>https://github.com/ebachelet/pyLIMA/tree/master/ examples 4 https://www.python.org/dev/peps/pep-0008/</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 .</head><label>1</label><figDesc>Figure 1. Schematic outline showing a worked example of pyLIMA being used to fit a PSPL model to a typical microlensing event, observed from two telescopes. In this simple case, the fit is performed using the Leverberg-Marquardt ('LM') method. In blue are the data and informations that the user possesses. The red text indicates the user's commands. The purple box indicates the final products. The black box indicates the different modules used.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 2 .</head><label>2</label><figDesc>Figure 2. Σ x distributions for the Ground dataset. The x-axis represents the model parameters x and the y-axis represents Σ x limited to -5 to +5. The color scales indicate the log 10 (N), where N is the total number of events in the corresponding bin. The bottom right plot is the χ 2 /dof distribution. A high fraction of fits are consistant with the injected models (i.e |Σ x | &lt; 3). However, several trends can be observed, especially in the t o , u o and χ 2 /dof distributions.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 3 .</head><label>3</label><figDesc>Figure 3. Left : An example of 'Regular' lightcurve. The injected model (red) and the fit (orange) are indistinguishable in this case. All metrics indicate a successful fit. Right : An example of 'Hard' lightcurve. Various metric indicate that the fit is non-optimal. In this case, the event is not enough constrained by the observations.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 4 .</head><label>4</label><figDesc>Figure 4. Λ x distributions for the Space dataset. Each category is represented by a color and a row : first row (blue) is Regular, second row (orange) is No peak, third row (green) is High blending, fourth row (yellow) is No baseline and last row(black) is Hard. It is clear that unsuccessful fits are due to problematic lightcurves rather than pyLIMA fitting routines.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 5 .</head><label>5</label><figDesc>Figure 5. min Z normalised distributions for successfull fits (blue) and fits failures (green). The significant change for min Z ∼ 1 indicates that bad fits are more likely to be due to insufficient informations inside the lightcurves instead of fitting routines misbehaviour.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 6 .</head><label>6</label><figDesc>Figure 6. Maximum amplification A o (left) and Einstein ring crossing time t E (right) for the OGLE-II survey microlensing events from various studies versus pyLIMA LM . The dark lines are linear fits where coefficient are visible in Table 5. The grey shade indicate the 1 σ fit errors.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Study</head><label></label><figDesc></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>5</head><label>5</label><figDesc>Comparison between pyLIMA LM with various studies on the OGLE-II survey. The 3Σ x columns indicate the percentage of event where |Σ x | &lt; 3. The a and b columns indicate the coefficient (and errors) of linear fits (i.e y = ax + b) perform on the Figure 6. A * symbol indicates that the linear fit did not converge. Note the excellent agreement between the two independent fitting algorithms used in pyLIMA.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Figure 12 .</head><label>12</label><figDesc>Figure 12. Λ x distributions for the FSPL dataset. Note the excess of events around 1 for the u o , ρ, g 1 and g 2 distributions. These are signatures of fits failures seen in Section 5.2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><head>;</head><label></label><figDesc></figDesc><table>Skowron et al. (2011), and 

arXiv:1709.08704v2 [astro-ph.EP] 27 Sep 2017 </table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><head>.</head><label></label><figDesc></figDesc><table>### First import the required libraries. 
import numpy as np 
from pyLIMA import event 
from pyLIMA import telescopes 
from pyLIMA import microlmodels 

### Create an event object. 
your_event = event.Event() 

### Create two telescopes objects. 
data_1 = np.loadtxt('./Survey_1.dat') 
telescope_1 = telescopes.Telescope( 
name='Survey', 
camera_filter='I', 
light_curve_magnitude=data_1) 

data_2 = np.loadtxt('./Followup_1.dat') 
telescope_2 = telescopes.Telescope( 
name='Followup', 
camera_filter='I', 
light_curve_magnitude=data_2) 

### Add the telescopes to your event. 
your_event.telescopes.append(telescope_1) 
your_event.telescopes.append(telescope_2) 

### Construct the model. 
model_1 = microlmodels.create_model('PSPL', 
your_event) 

### Fit using Levenberg-Marquardt algorithm. 
your_event.fit(model_1,'LM') 

### Producing outputs. 
your_event.fits[0].produce_outputs() 

2.3. </table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><head></head><label></label><figDesc>Table 1 pyLIMA fits results for the three simulated datsets. Computation time columns indicated the median, minimum and maximum fit time per lightcurve. Each Σ x column presents the percentage of fits where |Σ x | is less than 1, 2 and 3 respectively. The Space dataset presents the best results, due to the higher number of observations. The FSPL dataset on the contrary presents the worst results. This is due to an intrinsic more complex model than the PSPL model, but also difficulties due to the simulations, see text.</figDesc><table>). However, several trends can be observed, especially in the t o , u o and χ 2 /dof distributions. 

Datasets 
Computation time (s) 
Σ to 
Σ uo 
Σ t E 
Σ f s 
Σ g 
Method DE 

Ground 
0.013 0.003 3.306 
62.1% 86.6% 94.6% 65.5% 87.5% 95.1% 65.4% 88.7% 96.0% 66.3% 87.0% 94.2% 63.1% 87.6% 95.6% 
0 
Space 
0.023 0.005 39.618 
75.1% 96.2% 99.6% 75.3% 96.3% 99.5% 74.6% 96.7% 99.7% 75.8% 96.0% 99.3% 73.3% 96.0% 99.4% 
1 
FSPL 
0.103 0.019 348.023 50.3% 77.7% 88.6% 51.8% 74.6% 82.5% 50.5% 77.1% 88.1% 50.4% 76.5% 87.4% 50.1% 76.0% 87.1% 
853 

Dataset Category 
N event 
t o 
u o 
t E 
f s 
g 
∀x 
∆χ 2 &lt; 0 

Regular 
6017 
99.9% 79.1% 88.1% 69.4% 24.2% 23.8% 
0.0% 
No peak 
1315 
66.7% 32.6% 69.7% 33.1% 
4.5% 
3.0% 
0.0% 
Ground High blending 
2109 
98.6% 49.1% 59.7% 43.0% 36.0% 35.0% 
0.9% 
No baseline 
93 
100% 
75.3% 76.3% 72.0% 36.6% 36.6% 
0.0% 
Hard 
466 
37.3% 11.2% 21.5% 
8.6% 
6.0% 
5.8% 
1.93% 

Regular 
5180 
100% 
93.3% 96.0% 86.4% 44.5% 44.5% 
0.0% 
No peak 
2155 
86.4% 52.5% 86.4% 48.8% 
8.0% 
6.4% 
0.09% 
Space 
High blending 
1827 
99.8% 68.1% 73.7% 60.8% 54.6% 54.5% 
2.57% 
No baseline 
104 
100% 
69.2% 69.2% 69.2% 31.7% 31.7% 
0.0% 
Hard 
734 
41.1% 12.7% 21.7% 11.6% 
7.8% 
6.3% 
6.13% 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4" validated="false"><head>Table 2 pyLIMA</head><label>2</label><figDesc>'s fit success ratio according to the second metric (i.e |Λ x | &lt; 0.1). Note that the ∀x column indicates the percent of events satisfying |Λ x | &lt; 0.1 for all parameters. The last column indicates the percentage of fit failures (i.e as a fraction of the total number of events in that category) according to the last metric.</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9" validated="false"><head>Table</head><label></label><figDesc></figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_11" validated="false"><head>Table 6 ARTEMiS</head><label>6</label><figDesc>vs pyLIMA fits results for the OGLE 2015 season. The percent quantiles are computed on the total of 2145 events. ARTEMiS and pyLIMA agree on a vast majority of events and only a few fraction (i.e 150/2145) of events are challenging for pyLIMA, if we consider that all events in the category 'Unknown' come from a bad pyLIMA fit.</figDesc><table>Event 
Publication 
t o − 2450000 
u o 
t E 
ρ 
χ 2 (do f ) 

Dong et al. (2009)  † 
4354.58107 
2.5 10 −4 
14.41 
0.00326 
MOA-2007-BLG-400 
pyLIMA LM 
4354.5818 ± 5.5 10 −5 
3.31 10 −5 ± 1.0 10 −3 12.98 ± 0.62 
0.00363 ± 1.8 10 −4 
1872.49(773) 
pyLIMA DE 
4354.5818 ± 5.5 10 −5 
1.0 10 −5 ± 2.3 10 −3 
14.85 ± 0.78 0.00318 ± 1.81 10 −4 
1854.85(773) 

Janczak et al. (2010) 
4656.39975 ± 5. 10 −5 
3.0 10 −3 ± 1.4 10 −4 
11.14 ± 0.50 
0.00493 ± 2.5 10 −3 
MOA-2008-BLG-310 
pyLIMA LM 
4656.39904 ± 3.9 10 −5 
2.84 10 −3 ± 1.6 10 −4 11.50 ± 0.66 
0.00475 ± 2.7 10 −4 
4055.05(3178) 
pyLIMA DE 
4656.39904 ± 3.9 10 −5 
2.84 10 −3 ± 1.6 10 −4 11.50 ± 0.66 
0.00475 ± 2.7 10 −4 
4055.05(3178) 

Bachelet et al. (2015) ♠ 
6446.04790 ± 3 10 −5 
−4.21 10 −4 ± 7 10 −6 
76.9 ± 1.3 
0.000522 ± 10 −6 
OGLE-2013-BLG-0446 
pyLIMA LM 
6446.04660 ± 1.2 10 −5 
4.0 10 −4 ± 3.7 10 −5 
80.41 ± 7.5 
0.000495 ± 4.6 10 −5 99407.24(2919) 
pyLIMA DE 
6446.04660 ± 1.2 10 −5 
4.0 10 −4 ± 3.7 10 −5 
80.09 ± 7.4 
0.000497 ± 4.6 10 −5 99407.32(2919) 

 † The parameters are from the binary 'Close' model. 
The parameters are from the binary 'Wide' model. 
♠ The parameters are from the FSPL model in their Table 3. 

</table></figure>

			<note place="foot" n="2"> https://ebachelet.github.io/pyLIMA/</note>

			<note place="foot" n="5"> https://github.com/ebachelet/pyLIMA</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The authors thank the referee for his/her useful comments. The authors express their gratitude to the microlening observer teams, especially to the OGLE Survey, for kindly granting access to their photometry. This research has made use ofThis can be seen on the right of <ref type="figure">Figure 8</ref>. The two distributions present a good agreement (p-valule of the Kolmogorov-Smirnov test higher than 0.9). However, it seems that the error volume estimated form the 'MCMC' looks slightly smaller (the median values for the log 10 V are 3.1 and 1.7 for 'LM' and 'MCMC' respectively). This is due to the fact that errors estimated from the 'MCMC' method are not divergent when the events are not that well constrained, whereas the errors from the 'LM' method can grow dramatically (see Section A).</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">D</forename><surname>Albrow</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/383565</idno>
		<imprint>
			<date type="published" when="2004" />
			<biblScope unit="volume">607</biblScope>
			<biblScope unit="page">821</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">D</forename><surname>Albrow</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/308842</idno>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="volume">535</biblScope>
			<biblScope unit="page">176</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Alcock</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/309484</idno>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="volume">541</biblScope>
			<biblScope unit="page">734</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">H</forename><surname>An</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/340191</idno>
		<imprint>
			<date type="published" when="2002" />
			<biblScope unit="volume">572</biblScope>
			<biblScope unit="page">521</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title/>
		<author>
			<orgName type="collaboration">Astropy Collaboration</orgName>
		</author>
		<idno type="doi">doi:10.1051/0004-6361/201322068</idno>
		<imprint>
			<date type="published" when="2013" />
			<biblScope unit="volume">558</biblScope>
			<biblScope unit="page">33</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Bachelet</surname></persName>
		</author>
		<idno type="doi">doi:10.1088/0004-637X/812/2/136</idno>
		<imprint>
			<date type="published" when="2015" />
			<biblScope unit="volume">812</biblScope>
			<biblScope unit="page">136</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">M</forename><surname>Batalha</surname></persName>
		</author>
		<imprint>
			<date type="published" when="0204" />
			<biblScope unit="page">24</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><forename type="middle">A</forename><surname>Bond</surname></persName>
		</author>
		<idno type="doi">doi:10.1046/j.1365-8711.2001.04776.x</idno>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="volume">327</biblScope>
			<biblScope unit="page">868</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Borsato</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Marzari</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Nascimbeni</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Piotto</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Granata</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">R</forename><surname>Bedin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Malavolta</surname></persName>
		</author>
		<idno type="doi">doi:10.1051/0004-6361/201424080</idno>
		<imprint>
			<date type="published" when="2014" />
			<biblScope unit="volume">571</biblScope>
			<biblScope unit="page">38</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Bozza</surname></persName>
		</author>
		<idno type="doi">doi:10.1111/j.1365-2966.2010.17265.x</idno>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="volume">408</biblScope>
			<biblScope unit="page">2188</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Cassan</surname></persName>
		</author>
		<idno type="doi">doi:10.1051/0004-6361:20054414</idno>
		<imprint>
			<date type="published" when="2006" />
			<biblScope unit="volume">460</biblScope>
			<biblScope unit="page">277</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Cassan</surname></persName>
		</author>
		<idno type="doi">doi:10.1038/nature10684</idno>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="volume">481</biblScope>
			<biblScope unit="page">167</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Catala</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Appourchaux</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Plato</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Physics Conference Series</title>
		<imprint>
			<biblScope unit="volume">271</biblScope>
			<biblScope unit="page">12084</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Distributions of error volume from pyLIMA &apos;LM&apos; (blue) and from pyLIMA &apos;MCMC&apos; (green) for the OGLE-II dataset. Because this dataset presents microlensing events with strong signals and good photometry, the two methods converge to equivalent fits and errobars</title>
	</analytic>
	<monogr>
		<title level="m">This illustrates the robustness of the &apos;LM&apos; and &apos;MCMC&apos; methods on microlensing events without pathologic cases</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Clanton</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">S</forename><surname>Gaudi</surname></persName>
		</author>
		<idno type="doi">doi:10.1088/0004-637X/791/2/91</idno>
		<imprint>
			<date type="published" when="2014" />
			<biblScope unit="volume">791</biblScope>
			<biblScope unit="page">91</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Claret</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Bloemen</surname></persName>
		</author>
		<idno type="doi">doi:10.1051/0004-6361/201116451</idno>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="volume">529</biblScope>
			<biblScope unit="page">75</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">L</forename><surname>Coughlin</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1512.06149</idno>
		<imprint>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
	<note>preprint</note>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">F</forename><surname>Díaz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Almenara</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Santerne</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Moutou</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Lethuillier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Deleuil</surname></persName>
		</author>
		<idno type="doi">doi:10.1093/mnras/stu601</idno>
		<imprint>
			<date type="published" when="2014" />
			<biblScope unit="volume">441</biblScope>
			<biblScope unit="page">983</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Dominik</surname></persName>
		</author>
		<idno type="doi">10.1111/j.1365-2966.2008.14276.x</idno>
		<ptr target="doi:10.1111/j.1365-2966.2008.14276.x" />
		<imprint>
			<date type="published" when="2009" />
			<biblScope unit="volume">393</biblScope>
			<biblScope unit="page">816</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Dominik</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Astronomische Nachrichten</title>
		<imprint>
			<biblScope unit="volume">329</biblScope>
			<biblScope unit="page">248</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Dong</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/501224</idno>
		<imprint>
			<date type="published" when="2006" />
			<biblScope unit="volume">642</biblScope>
			<biblScope unit="page">842</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Dong</surname></persName>
		</author>
		<idno type="doi">doi:10.1088/0004-637X/698/2/1826</idno>
		<imprint>
			<date type="published" when="2009" />
			<biblScope unit="volume">698</biblScope>
			<biblScope unit="page">1826</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Dumusque</surname></persName>
		</author>
		<idno type="doi">doi:10.1051/0004-6361/201628672</idno>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="volume">593</biblScope>
			<biblScope unit="page">5</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Dumusque</surname></persName>
		</author>
		<idno type="doi">doi:10.1051/0004-6361/201628671</idno>
		<imprint>
			<date type="published" when="2017" />
			<biblScope unit="volume">598</biblScope>
			<biblScope unit="page">133</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Foreman-Mackey</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">W</forename><surname>Hogg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Lang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Goodman</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/670067</idno>
		<imprint>
			<date type="published" when="2013" />
			<biblScope unit="volume">125</biblScope>
			<biblScope unit="page">306</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">S</forename><surname>Gaudi</surname></persName>
		</author>
		<idno type="doi">doi:10.1146/annurev-astro-081811-125518</idno>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="volume">50</biblScope>
			<biblScope unit="page">411</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Gould</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/317037</idno>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="volume">542</biblScope>
			<biblScope unit="page">785</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Gould</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/382782</idno>
		<imprint>
			<date type="published" when="2004" />
			<biblScope unit="volume">606</biblScope>
			<biblScope unit="page">319</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Griest</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Safizadeh</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/305729</idno>
		<imprint>
			<date type="published" when="1998" />
			<biblScope unit="volume">500</biblScope>
			<biblScope unit="page">37</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Han</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">P</forename><surname>Bennett</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Udalski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><forename type="middle">K</forename><surname>Jung</surname></persName>
		</author>
		<idno type="doi">doi:10.3847/0004-637X/825/1/8</idno>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="volume">825</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">D</forename><surname>Hunter</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computing In Science &amp; Engineering</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">90</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Janczak</surname></persName>
		</author>
		<idno type="doi">doi:10.1088/0004-637X/711/2/731</idno>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="volume">711</biblScope>
			<biblScope unit="page">731</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Jones</surname></persName>
			<affiliation>
				<orgName type="collaboration">LSST Science Collaboration</orgName>
			</affiliation>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Oliphant</surname></persName>
			<affiliation>
				<orgName type="collaboration">LSST Science Collaboration</orgName>
			</affiliation>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Peterson</surname></persName>
			<affiliation>
				<orgName type="collaboration">LSST Science Collaboration</orgName>
			</affiliation>
		</author>
		<idno type="arXiv">arXiv:0912.0201</idno>
		<ptr target="http://www.scipy.org/" />
		<title level="m">SciPy: Open source scientific tools for Python</title>
		<imprint>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
	<note>preprint</note>
</biblStruct>

<biblStruct xml:id="b33">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Laureijs</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1110.3193</idno>
		<imprint>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
	<note>preprint</note>
</biblStruct>

<biblStruct xml:id="b34">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C.-H</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Riffeser</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Seitz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Bender</surname></persName>
		</author>
		<idno type="doi">doi:10.1088/0004-637X/695/1/200</idno>
		<imprint>
			<date type="published" when="0200" />
			<biblScope unit="volume">695</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Levenberg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Quart. J. Appl. Maths</title>
		<imprint>
			<biblScope unit="volume">II</biblScope>
			<biblScope unit="page">164</biblScope>
			<date type="published" when="1944" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ma</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Mao</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ida</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">N C</forename><surname>Lin</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1605.08556</idno>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
	<note>preprint</note>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">W</forename><surname>Marquardt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM Journal on Applied Mathematics</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">431</biblScope>
			<date type="published" when="1963" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">A</forename><surname>Milne</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1921" />
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page">361</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Mogavero</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">P</forename><surname>Beaulieu</surname></persName>
		</author>
		<idno type="doi">doi:10.1051/0004-6361/201527380</idno>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="volume">585</biblScope>
			<biblScope unit="page">62</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Moutou</surname></persName>
		</author>
		<idno type="doi">doi:10.1051/0004-6361:20042334</idno>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="volume">437</biblScope>
			<biblScope unit="page">355</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Paczy´nskipaczy´nski</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/164140</idno>
		<imprint>
			<date type="published" when="1986" />
			<biblScope unit="volume">304</biblScope>
			<biblScope unit="page">1</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">R</forename><surname>Ricker</surname></persName>
		</author>
		<idno type="doi">doi:10.1117/12.2063489</idno>
		<idno type="arXiv">arXiv:1406.0151</idno>
		<title level="m">Space Telescopes and Instrumentation 2014: Optical, Infrared, and Millimeter Wave</title>
		<imprint>
			<date type="published" when="2014" />
			<biblScope unit="page">914320</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">R</forename><surname>Ricker</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Astronomical Telescopes, Instruments, and Systems</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page">14003</biblScope>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Skowron</surname></persName>
		</author>
		<idno type="doi">doi:10.1088/0004-637X/738/1/87</idno>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="volume">738</biblScope>
			<biblScope unit="page">87</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Spergel</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1503.03757</idno>
		<imprint>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
	<note>preprint</note>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Storn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Price</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. of Global Optimization</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">341</biblScope>
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Sumi</surname></persName>
		</author>
		<idno type="doi">doi:10.1038/nature10092</idno>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="volume">473</biblScope>
			<biblScope unit="page">349</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b48">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Sumi</surname></persName>
		</author>
		<idno type="doi">doi:10.1088/0004-637X/778/2/150</idno>
		<imprint>
			<date type="published" when="2013" />
			<biblScope unit="volume">778</biblScope>
			<biblScope unit="page">150</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b49">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">K</forename><surname>Szymanski</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="page">43</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b50">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">L</forename><surname>Thomas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Griest</surname></persName>
		</author>
		<idno type="doi">doi:10.1086/500101</idno>
		<imprint>
			<date type="published" when="2006" />
			<biblScope unit="volume">640</biblScope>
			<biblScope unit="page">299</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b51">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Tsapras</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Horne</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Kane</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Carson</surname></persName>
		</author>
		<idno type="doi">doi:10.1046/j.1365-8711.2003.06720.x</idno>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="volume">343</biblScope>
			<biblScope unit="page">1131</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b52">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Tsapras</surname></persName>
		</author>
		<idno type="doi">doi:10.1093/mnras/stw023</idno>
		<imprint>
			<date type="published" when="2016" />
			<biblScope unit="volume">457</biblScope>
			<biblScope unit="page">1320</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b53">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Udalski</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page">291</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b54">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Udalski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Szymanski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Kaluzny</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Kubiak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Mateo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Krzeminski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Paczynski</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1994" />
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page">227</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b55">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Udalski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Zebrun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Szymanski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Kubiak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Pietrzynski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Soszynski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Wozniak</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="volume">50</biblScope>
			<biblScope unit="page">1</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b56">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Udalski</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002" />
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="page">1</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b57">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Vesterstrom</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Thomsen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Evolutionary Computation</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<date type="published" when="1980" />
		</imprint>
	</monogr>
	<note>CEC2004. Congress on</note>
</biblStruct>

<biblStruct xml:id="b58">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Wambsganss</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">J</forename><surname>Witt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Schneider</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1992" />
			<biblScope unit="volume">258</biblScope>
			<biblScope unit="page">591</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b59">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><forename type="middle">J</forename><surname>Witt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Mao</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1994" />
			<biblScope unit="volume">430</biblScope>
			<biblScope unit="page">505</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b60">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">R</forename><surname>Wozniak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Udalski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Szymanski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Kubiak</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Pietrzynski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Soszynski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Zebrun</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="page">175</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b61">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Yoo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computing in Science Engineering</title>
		<imprint>
			<biblScope unit="volume">603</biblScope>
			<biblScope unit="page">22</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
