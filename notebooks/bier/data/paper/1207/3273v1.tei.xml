<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2018-12-04T16:12+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Extremely fast focal-plane wavefront sensing for extreme adaptive optics</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Christoph</forename><forename type="middle">U</forename><surname>Keller</surname></persName>
							<affiliation key="aff0">
								<address>
									<addrLine>Niels Bohrweg 2</addrLine>
									<postCode>2333CA</postCode>
									<settlement>Leiden Observatory, Leiden</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Visa</forename><surname>Korkiakoski</surname></persName>
							<affiliation key="aff0">
								<address>
									<addrLine>Niels Bohrweg 2</addrLine>
									<postCode>2333CA</postCode>
									<settlement>Leiden Observatory, Leiden</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Niek</forename><surname>Doelman</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">TNO Science and Industry</orgName>
								<address>
									<addrLine>Stieltjesweg 1</addrLine>
									<postCode>2628CK</postCode>
									<settlement>Delft</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Rufus</forename><surname>Fraanje</surname></persName>
							<affiliation key="aff2">
								<orgName type="department">Delft Center for Systems and Control</orgName>
								<address>
									<addrLine>Mekelweg 2</addrLine>
									<postCode>2628CD</postCode>
									<settlement>Delft</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Raluca</forename><surname>Andrei</surname></persName>
							<affiliation key="aff2">
								<orgName type="department">Delft Center for Systems and Control</orgName>
								<address>
									<addrLine>Mekelweg 2</addrLine>
									<postCode>2628CD</postCode>
									<settlement>Delft</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michel</forename><surname>Verhaegen</surname></persName>
							<affiliation key="aff2">
								<orgName type="department">Delft Center for Systems and Control</orgName>
								<address>
									<addrLine>Mekelweg 2</addrLine>
									<postCode>2628CD</postCode>
									<settlement>Delft</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Extremely fast focal-plane wavefront sensing for extreme adaptive optics</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Adaptive optics</term>
					<term>wavefront sensing</term>
					<term>sequential phase diversity</term>
				</keywords>
			</textClass>
			<abstract>
				<p>We present a promising approach to the extremely fast sensing and correction of small wavefront errors in adaptive optics systems. As our algorithm&apos;s computational complexity is roughly proportional to the number of actuators, it is particularly suitable to systems with 10,000 to 100,000 actuators. Our approach is based on sequential phase diversity and simple relations between the point-spread function and the wavefront error in the case of small aberrations. The particular choice of phase diversity, introduced by the deformable mirror itself, minimizes the wavefront error as well as the computational complexity. The method is well suited for high-contrast astronomical imaging of point sources such as the direct detection and characterization of exoplanets around stars, and it works even in the presence of a coronagraph that suppresses the diffraction pattern. The accompanying paper in these proceedings by Korkiakoski et al. describes the performance of the algorithm using numerical simulations and laboratory tests.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">INTRODUCTION</head><p>The computational requirements for extreme adaptive optics for the next generation of 30 to 40-meter class astronomical telescopes present a formidable problem. For an adaptive optics system with a phase corrector that has N degrees of freedom, classical approaches require a multiplication of a vector of length N with a matrix of size N × N , leading to a computational complexity of order N 2 . For extreme adaptive optics, this vector-matrix multiplication is the major bottleneck, not only in terms of computational power but also in terms of memory requirements as both scale with N 2 . Indeed, a system with N = 40, 000 as envisaged for the EPICS instrument at the E-ELT, the classical reconstruction matrix would require about 6GB of memory (assuming 4-byte single-precision floating point numbers). This data needs to be moved into the processing units at a rate of a few thousand times per second, making this issue alone a challenging data flow problem.</p><p>Even when using parallel processing and distributed memory techniques, the most modern hardware implementation would struggle to achieve the computational complexity and speed. Depending on the type of wavefront sensor and deformable mirror, sparse-matrix approaches, 1 sequential one-dimensional reconstructions 2 and Fourier reconstruction techniques 3 can reduce the required processing power. Typically, these approaches work with conventional pupil-based wavefront sensors such as Shack-Hartmann and pyramid wavefront sensors.</p><p>Here we present a focal-plane sensing algorithm with a complexity that is proportional to N log N in terms of required computing power and proportional to N in terms of memory requirements. It is based on 1) the close relationship between the PSF and the wavefront aberration in case that the latter is small 4-6 , 2) sequential phasediversity 7, 8 where the deformable mirror itself introduces the phase diversity and 3) a choice of the introduced phase diversity that minimizes the wavefront error and fortunately also minimizes the computational effort. Indeed, our algorithm only requires a few floating point calculations per wavefront resolution element and a single, two-dimensional, complex Fourier transform per update cycle. Our work combines knowledge from the areas of AO-corrected speckle studies 6 and the phase-diversity efforts of Gonsalves. <ref type="bibr" target="#b4">5,</ref><ref type="bibr" target="#b6">7</ref> We begin in Sect. 2 by calculating the monochromatic PSF of a weakly aberrated system to second order, which allows us to derive a correction to the first-order approximation that makes it significantly better. We continue in Sect. 3 by deriving the basic sequential phase diversity technique for our approximation. Sect. 4 shows how the computational complexity can be dramatically reduced from four Fourier transforms to a single one. The advantages of our approach are discussed in Sect. 5, the limitations are listed in Sect. 6, and applications and extensions are summarized in Sect. 7. In a separate paper in these proceedings, we have also studied in detail one version of our algorithm numerically as well as in the laboratory with a 37-actuator system. 9</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">MONOCHROMATIC PSF DUE TO WEAK ABERRATIONS</head><p>The overall approach is based on the work by Gonsalves, 5 who presented an analytical solution to retrieving the wavefront from two simultaneous images of a point source where one is in focus and the other one has a phase diversity, typically defocus, applied. Gonsalves 7, 8 also introduced sequential phase diversity (SPD) where the phase-diverse images are acquired sequentially instead of simultaneously. We expand Gonsalves' work here to second order with a notation that is more closely related to the work that has been done for understanding the PSF of AO-corrected point sources. <ref type="bibr" target="#b9">10</ref> This expansion leads to a much deeper understanding of the approach suggested by Gonsalves 5 and implies a modification that significantly expands the range of the weak aberration approximation as shown in the accompanying paper by Korkiakoski. 9</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">First-order approximation of wavefront</head><p>We start with the (scalar) electrical field of an electromagnetic wave in the pupil plane of an optical system,</p><formula xml:id="formula_0">E(u, v) = A(u, v)e iΦ(u,v)<label>(1)</label></formula><p>where A(u, v) is the amplitude and Φ(u, v) is the phase in radians, both being functions of the spatial coordinates u and v in the pupil plane. The origin of the (u, v) coordinate system is the center of the aperture. Both A(u, v) and Φ(u, v) are real. Furthermore, as the absolute value of the phase (piston term) is not relevant, we can set the average of Φ over the aperture to zero, i.e.</p><formula xml:id="formula_1">A(u, v)Φ(u, v) du dv = 0 .<label>(2)</label></formula><p>Note that A(u, v) does not have to be limited to values of 0 or 1 but can have values in between such as used in apodized-pupil coronagraphs. 11</p><p>As we do not rely on absolute intensity measurements and assume that we only deal with pure phase aberrations, the amplitude of the electrical field is normalized such that</p><formula xml:id="formula_2">|E(u, v)| 2 du dv = |A(u, v)| 2 du dv = 1 .<label>(3)</label></formula><p>Furthermore, we assume that the amplitude is even, i.e.</p><formula xml:id="formula_3">A(u, v) = A(−u, −v) .<label>(4)</label></formula><p>This is an assumption that will greatly simplify the subsequent calculations without being overly restrictive. An even amplitude or aperture function A(u, v) still describes most telescope apertures but also holds for shaped pupils and apodized pupils that are used to suppress diffraction effects around a point source. 11</p><p>If the aberrations are very small, i.e. Φ 1, E(u, v) in Eq.(1) can be approximated to first order by</p><formula xml:id="formula_4">E(u, v) ≈ E (u, v) = A(u, v) [1 + iΦ(u, v)] .<label>(5)</label></formula><p>We note that the integral over the absolute value squared of E is not unity anymore since</p><formula xml:id="formula_5">|E | 2 du dv = A(u, v) 2 1 + Φ(u, v) 2 du dv = 1 + [A(u, v)Φ(u, v)] 2 du dv .<label>(6)</label></formula><p>The error made in the normalization of the amplitude by this first-order approximation is therefore given by the variance of the aperture-weighted wavefront, AΦ because of Eq.(2). This violation of energy conservation is the fundamental reason that algorithms based on Gonsalves 5 first-order approximation are limited to extremely small phase aberrations and that the Strehl ratio of the corresponding PSF is always 1, independent of the wavefront variance, as will be shown below.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Second-order approximation of wavefront</head><p>Expanding Eq.</p><p>(1) to second order, we obtain</p><formula xml:id="formula_6">E(u, v) ≈ E (u, v) = A(u, v) 1 + iΦ(u, v) − 1 2 Φ(u, v) 2 .<label>(7)</label></formula><p>The integral</p><formula xml:id="formula_7">|E (u, v)| 2 du dv = A(u, v) 2 1 − 1 2 Φ(u, v) 2 2 + Φ(u, v) 2 du dv ≈ 1<label>(8)</label></formula><p>up to second order for Φ 1 since (1 − x 2 ) 2 ≈ 1 − x) for x 1. Therefore, expanding Eq.(1) up to second order in the wavefront aberration Φ will guarantee energy conservation up to second order.</p><p>In the first-order approximation of the complex electrical field in the aperture, the real term is simply 1. In the second-order approximation, the real term of the series becomes 1 − 1 2 Φ(u, v) 2 , which will always be smaller than 1. The first-order expansion will therefore always overestimate the real term. We can correct for this overestimation in a statistical sense by replacing the general 1 2 Φ(u, v) 2 term in the complex field amplitude approximation with its average (over the pupil),</p><formula xml:id="formula_8">1 2 Φ(u, v) 2 ≈ 1 2 A(u, v) 2 Φ(u, v) 2 du dv = 1 2 σ 2 Φ ,<label>(9)</label></formula><p>where σ 2 Φ is the wavefront variance in radians squared. We can therefore mitigate the problem in the first-order approximation of the pupil electric field by scaling the real part with 1 − σ 2 Φ /2. The imaginary part will not require any scaling.</p><p>We note that the square of this scaling factor, to second order in Φ</p><formula xml:id="formula_9">(1 − σ 2 Φ /2) 2 ≈ 1 − σ 2 Φ (10)</formula><p>is the same as the Strehl ratio for small aberrations, the extended Marechal approximation. <ref type="bibr" target="#b11">12</ref> At the end of this subsection, we will provide an alternative explanation for this scaling factor that is closely linked to the second-order expansion of the wavefront aberration and provides a clear connection between this term and the Strehl ratio.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Fourier transforms and symmetries</head><p>Following Gonsalves 5 we split the phase Φ into odd and even terms such that</p><formula xml:id="formula_10">Φ(u, v) = Φ o (u, v) + Φ e (u, v)<label>(11)</label></formula><p>and</p><formula xml:id="formula_11">Φ o (u, v) = −Φ o (−u, −v), Φ e (u, v) = Φ e (−u, −v) .<label>(12)</label></formula><p>The corresponding approximate complex electric field amplitude in the focal plane is given by the Fourier transform of E (u, v) in Eq.(7). The coordinate system in the focal plane has its origin at the center of the perfect PSF without aberrations. We will not explicitly write the dependence on the focal-plane coordinates to make the equations more readable. Hence, the electrical field in the focal plane to second order in the phase aberration Φ is</p><formula xml:id="formula_12">e = a + ia * (φ e + φ o ) − 1 2 a * (φ e + φ o ) * (φ e + φ o ) ,<label>(13)</label></formula><p>where lower-case symbols are the Fourier transforms of the upper-case symbols, and * is the convolution operator.</p><p>The Fourier transform of a real, even function is real and even, and the Fourier transform of a real, odd function is a purely imaginary, odd function. Therefore, φ e and a are real and even, and φ o is imaginary and odd.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Point-Spread Function</head><p>The point-spread function (PSF) to second order in the aberration, p, is given by the absolute value squared of the complex field amplitude in the focal plane,</p><formula xml:id="formula_13">p = e · e (14) = a 2 (15) +ia [a * (φ e + φ o ) − a * (φ * e + φ * o )] + [a * (φ e + φ o )] [a * (φ * e + φ * o )] − 1 2 a [a * (φ e + φ o ) * (φ e + φ o ) + a * (φ * e + φ * o ) * (φ * e + φ * o )] ,</formula><p>where * indicates the complex conjugate and we have dropped terms proportional to Φ 3 and higher. With A(u, v) being real and even, a = a * is real and a 2 is simply the PSF without aberrations. Since</p><formula xml:id="formula_14">φ * e = φ e and φ * o = −φ o , Eq.(16) simplifies to p(x, y) = a 2 (16) +2ia(a * φ o ) +(a * φ e ) 2 − (a * φ o ) 2 −a (a * φ o * φ o + a * φ e * φ e ) .</formula><p>This is the PSF to second order in the aberrations Φ. Note that the last term is mostly missing in publications that use the first-order approximation in the wavefront to derive an approximate PSF.</p><p>Using the notation from Gonsalves' 5 work on phase-diversity in the weak aberration limit,</p><formula xml:id="formula_15">v = a * φ e (17) y = ia * φ o<label>(18)</label></formula><p>and both v and y being real quantities, we can rewrite Eq.17 as</p><formula xml:id="formula_16">p = a 2 + 2ay + y 2 + v 2 − a (a * φ e * φ e + a * φ o * φ o ) .<label>(19)</label></formula><p>Following again Gonsalves, <ref type="bibr" target="#b4">5</ref> we separate the PSF, p, into its odd and even parts,</p><formula xml:id="formula_17">p o = 2ay (20) p e = a 2 + y 2 + v 2 − a (a * φ e * φ e + a * φ o * φ o ) .<label>(21)</label></formula><p>The last term for the even part of the wavefront is difficult to include in analytical solutions of the wavefront sensing problem as it includes convolutions of wavefronts with themselves and the aperture. However, it is the only term that can be negative and that is not zero at the center of the unaberrated PSF, the coordinate origin in the focal plane. The latter is due to our previous assumption that the phase, averaged over the aperture, is zero. It is indeed this term that leads to a reduction of the Strehl ratio as has already been pointed out by <ref type="bibr">Perrin et al. 10</ref> Due to the requirement for energy conservation, the integral over the PSF has to remain constant, independent of the wavefront aberration. Therefore</p><formula xml:id="formula_18">y 2 + v 2 − a (a * φ e * φ e + a * φ o * φ o ) dx dy = 0 .<label>(22)</label></formula><p>Since the first two terms are always positive, the third term has to be largely negative. Neglecting this term therefore leads to a consistent bias in the estimate for the amplitude of v, which limits the applicability of Gonsalves' algorithm to very small phase aberrations.</p><p>To simplify matters, we approximate Φ(u, v) 2 with its average σ 2 Φ . φ * φ therefore becomes a delta function and the last term in Eq. <ref type="formula" target="#formula_0">(21)</ref> becomes</p><formula xml:id="formula_19">a (a * φ e * φ e + a * φ o * φ o ) ≈ σ 2 Φ a 2 .<label>(23)</label></formula><p>Finally, the equation for the even part of the PSF reduces to</p><formula xml:id="formula_20">p e = (1 − σ 2 Φ )a 2 + y 2 + v 2 .<label>(24)</label></formula><p>The even part is a modified version of the equation given by Gonsalves 5 where we correct the unaberrated PSF, a 2 , with the factor 1 − σ 2 Φ . Even though we do not know the variance of the wavefront aberrations in advance of the actual wavefront sensing, we can easily determine this correction factor as it is the same as the Strehl ratio for small aberrations in the extended Marechal approximation. <ref type="bibr" target="#b11">12</ref> We can therefore normalize the unaberrated PSF with the (observed) Strehl ratio, which is given by the maximum of p obs . An equivalent estimate of the correction factor can be obtained from the requirement for energy conservation: σ 2 Φ = y 2 + v 2 . This correction to the equation given by Gonsalves 5 significantly extends the amplitude of the aberrations over which the algorithm can be applied. Indeed, an rms aberration of about 1.5 radians can be tolerated. <ref type="bibr" target="#b8">9</ref> </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Odd part of wavefront error</head><p>Once more following Gonsalves, 5 y is easy to calculate from the odd part of the PSF, Eq. <ref type="formula" target="#formula_0">(21)</ref> via</p><formula xml:id="formula_21">y = p o 2a ≈ 1 2 p o a a + ,<label>(25)</label></formula><p>where &gt; 0 avoids noise amplifications in places where a is very small. The odd part of the wavefront error, Φ o (u, v) multiplied with the aperture function A(u, v) is then obtained from the imaginary part of the inverse Fourier transform of y,</p><formula xml:id="formula_22">AΦ o = Y .<label>(26)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.6">Even part of wavefront error</head><p>The magnitude of v, the Fourier transform of the even part of the phase function multiplied with the aperture function can be easily determined from Eq.(24),</p><formula xml:id="formula_23">v = |p e − (1 − σ 2 Φ )a 2 − y 2 | .<label>(27)</label></formula><p>We use the absolute value here as this is only approximately correct, and therefore the argument of the square root has, in practice, also negative values. Preliminary experiments have shown this to be better than to set all negative elements to zero. The sign of v cannot be determined from a single PSF measurement. A convenient way to determine the sign of v is through phase diversity: 5, 13 an additional, known aberration is added, very often a defocus term, to figure out the sign of v. This is the topic of the next section. Once a sign has been determined, an inverse Fourier transform of v leads to the even part of the wavefront error multiplied with the aperture function,</p><formula xml:id="formula_24">AΦ e = V .<label>(28)</label></formula><p>Note that the inverse Fourier transform of v should be limited to the support of the aperture A. Any error in the choice of the sign may lead to Fourier components outside of the aperture, A (see <ref type="figure">Fig. 1)</ref>. Therefore, the sign should be chosen so that the inverse Fourier transform is limited to the aperture. <ref type="figure">Figure 1</ref>. The (signed) square root of the even part of the PSF due to the even wavefront error, v, (top row), along with its Fourier transform, V , (bottom row), which is an estimate of the even part of the wavefront error, Φe. The three columns differ in terms of the accuracy of the sign of v: the correct sign (left column), all positive signs (middle column), and 20% wrong signs (right column). Note that sign erros lead to Fourier amplitudes outside of the aperture and a corresponding reduction of the amplitudes inside the aperture.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">SEQUENTIAL PHASE DIVERSITY</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Phase Diversity and Adaptive Optics</head><p>Phase diversity 13-15 is a convenient way to determine the phase aberrations of images. Typically, two images are recorded simultaneously, often an in-focus and an out-of-focus image. Another approach, suggested by Gonsalves 7, 8 consists in using a deformable mirror in an adaptive optics system to sequentially introduce an additional phase aberration. It is indeed easy to see how an adaptive optics system in normal operations can be used as a sequential phase diversity wavefront sensor. Imagine that at time t k we observe a partially corrected image that has an (unknown) phase aberration Φ k . If we can assume that the deformable mirror can change its shape faster than the typical changes in the incoming wavefront that is being corrected, then the deformable mirror of the AO system in the previous update cycle had introduced an additional phase aberration of −∆Φ k−1 where ∆Φ k−1 is the correction that was made by the deformable mirror in the last iteration.</p><p>To use phase-diversity as a wavefront sensor in an adaptive optics system, one therefore has to know the previous and the current focal-plane images along with the phase change introduced by the deformable mirror during the previous update cycle.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Choice of diversity</head><p>In the weak-aberration regime developed above, phase diversity only has to help us find the sign of v. In most cases, one chooses a quadratic diversity as it is easily implemented by defocusing the imaging camera. When using a deformable mirror, much more elaborate choices of diversity can be chosen. Indeed, our goal is to find a diversity for every update cycle that minimizes the computational effort of determining the sign of v.</p><p>If one uses a small diversity, it is easy to show 5 that the even part of the PSF is</p><formula xml:id="formula_25">p e = (1 − σ 2 Φ )a 2 + y 2 + (v + z) 2 ,<label>(29)</label></formula><p>where z = a * δφ e , where δφ e is the even part of δφ, which in turn is the Fourier transform of ∆Φ. If we know the introduced diversity, we can easily calculate z. Note that the introduced diversity does not have to be even, as is almost always assumed in phase-diversity work, since odd and even wavefront errors are nicely separated in the odd and even parts of the PSF. It is therefore sufficient to look at the even part of the introduced phase diversity.</p><p>A simple approach to minimize the computational effort is the following: start by choosing an arbitrary sign for v and call it v k−1 . In the next update cycle of the AO system, we make the assumption that z = −v k−1 (note that this is not true since z is related to the introduced diversity, not what we think that we introduced. Therefore, if the choice of sign was correct, (v k −v k−1 ) 2 = 0, and if the sign was wrong, (v k −v k−1 ) 2 ≈ 4v 2 k−1 . The prescription is then to monitor p e at every point in the focal plane. If the magnitude of (p e,k −y 2 k )(x, y) &gt; (p e,k−1 −y 2 k−1 )(x, y) then one flips the sign at location (x, y), i.e. sign v k = −sign v k−1 . The problem with this simple approach is two-fold: 1) the algorithm in no way takes into account that the inverse Fourier transform of v should have a support limited by A; 2) once the correct sign choice has been made, the wavefront error will not be zero because of all the approximations one has made, and in particular the Fourier issue mentioned under 1). The choice in sign has again to be a random choice, which reduces the convergence speed by about a factor of 2 from what we would like to achieve.</p><p>A significantly better approach is modeled after the one introduced by Gonsalves 5 where we take into account that we also update the odd wavefront, and not just the even wavefront. The sign of v k in iteration k is then determined by</p><formula xml:id="formula_26">signv k = sign(v 2 k−1 − v 2 k − z 2 )/(2z) .<label>(30)</label></formula><p>This approach has two significant advantages, possibly not realized by Gonsalves: 5 1) it deals with the Fourier support issue as v k−1 does not necessarily obey the Fourier support contraint, but z does, and 2) even if the correct sign choice was made for v k−1 , there will be a residual error, and the above equation also tries to estimate the best choice in this iteration based on taking into account the difference between v k−1 and z.</p><p>The problem is equivalent to being able to finding the minimum of y = x 2 in the case that we can change x, but only measure y. We measure an initial value of x 2 1 . Without any additional information, we must randomly choose the sign of the step that we are going to take to minimize y. Without loss of generality, we choose δx 1 = − x 2 1 , i.e. we assume that we are on the right side of x = 0. We then measure a value of x 2 2 . Obviously, if x 2 2 &gt; x 2 1 , we chose the wrong sign. If we chose the correct sign, then the next step is δx 2 = ± x 2 2 . But we would also like to know on which side of x = 0 we are after having taken the step δx 1 so that we do not have to again guess the sign in the next iteration. The correct sign for δx 2 can be estimated form the following relation:</p><formula xml:id="formula_27">x 2 1 = (x 2 + δx 1 ) 2 = x 2 2 + 2x 2 δx 1 + δx 2 1 .<label>(31)</label></formula><p>Therefore the sign of x 2 is given by the following equation</p><formula xml:id="formula_28">x 2 = (x 2 1 − x 2 2 − δx 2 1 )/(2δx 1 ) .<label>(32)</label></formula><p>If x 2 is positive, δx 2 must be negative, and vice versa.</p><p>Even if the commanded value of δx 1 and the actually achieved step in x are not the same, the above equation is still correct when replacing δx 1 with the actual step z, which is then equivalent to <ref type="bibr">Eq.(30)</ref>. This is particularly important in our case as we will always have errors in the choice of sign for some parts of v. Because of these errors, the deformable mirror will not achieve the correct shape, and the actual change will lead to a step size z that is different from what we commanded initially. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">REDUCING COMPUTATIONAL COMPLEXITY</head><p>An obvious way to minimize the computing requirements consists in reducing the number of Fourier transforms. Due to the symmetry properties of Fourier transforms, the inverse Fourier transforms of y and v can easily be combined into a single, complex Fourier transform according to</p><formula xml:id="formula_29">A(u, v) Φ (u, v) = (V + Y ) + (V + Y ) . (33)</formula><p>The calculation of z also requires two Fourier transforms to implement the pupil plane support restriction. Realizing that this 1) low-pass filtering in the Fourier domain is nothing more than a two-dimensional filter in the focal plane (a sinc filter in the case of a top-hat aperture function A(u, v)) and 2) that this filter in the focal plane is strongly concentrated around the origin, we can perform this filtering with a brute-force convolution with a very limited kernel of about 5 by 5 pixels. This will add about 25 multiply-add calculations per actuator, which is negligible compared to the N logN complexity of a fast Fourier transform.</p><p>Since the limited support of V in the Fourier domain is nothing more than a low-pass filter applied to v, one can compare the estimate of v one has obtained and compare it to the convolution of v with the Fourier transform of A, which is v * a. If v and v * a have the same sign, then the chosen sign for v is correct, otherwise the opposite sign is a better choice. This post-processing step can again be implemented with a direct convolution with a very small kernel. <ref type="figure" target="#fig_0">Figure 2</ref> shows 10 iterations of our algorithm with the direct convolution approximation for z and the postprocessing of the sign choice as described above for a static, Kolmogorov-spectrum aberration with a starting Strehl ratio of 0.35.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">ADVANTAGES</head><p>The obvious advantage of our approach is that it only requires a single, complex Fourier transform and a number of operations proportional to the number of actuators. In contrast to other Fourier reconstructors, 3 our approach needs no particular treatment of the edges as we are directly sensing the phase, not its spatial derivative. Computationally, it is therefore very fast and can easily cope with systems that have 10,000 to 100,000 actuators.</p><p>Some phase retrieval algorithms have a tendency to stall. This is not the case here as any increase in Strehl ratio will also mean that the weak-aberration assumption is more accurate, and therefore the algorithm will perform better.</p><p>Our algorithm is also ideally suited for sensing a wavefront after an apodizing pupil coronagraph. The odd term and the second term in the even part of the PSF are both products with a, the complex field corresponding to the perfect PSF. As the main task of a coronagraph is to reduce the magnitude of a, these two terms will also decrease correspondingly. The estimation of the even part of the wavefront therefore becomes much easier since the second term contributes much less.</p><p>We can also limit the radial extension of the PSFs that we work with, and can thereby limit the number of Fourier modes that are reconstructed. Even an obscuration from a coronagraph image mask can be taken into account if the corresponding low-order aberrations are well corrected.</p><p>Finally, our approach easily implements any Fourier-based technique to make predictive corrections, e.g. shifting the entire wavefront in one direction, or take into account the influence function of actuators as long as it can be described by a convolution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">LIMITATIONS</head><p>Our wavefront sensing approach has been developed for monochromatic light. Broadband light leads to a radial smearing of the wavefront information as the speckle pattern scales with wavelength λ. One way to overcome this problem is the use of an extremely chromatic optical system, which has a wavelength-dependent magnification such that the scaling with λ due to diffraction is exactly compensated. Such optical systems have been described in the literature. <ref type="bibr" target="#b15">16,</ref><ref type="bibr" target="#b16">17</ref> The broadband wavefront sensing will therefore require its own optical system, and we cannot directly use the science focal-plane for the wavefront sensing.</p><p>The algorithm is currently limited to a single point source, which is often the case for exoplanet imaging, and can easily be implemented in laboratory applications. An application to extended objects is feasible, but it is not clear at this time that all wavefront modes can indeed be measured.</p><p>Another requirement is that the aperture has an even symmetry. It therefore also works with typical amplitude-apodization pupil masks, but will not work with typical pupil phase-mask coronagraphs, which are even in their real part and odd in their imaginary part. It might be possible to modify our approach to phase-mask coronagraphs, which will be part of our future efforts.</p><p>We have not optimized our approach in any ways regarding the different free parameters or the gains in the feedback loop. Such optimizations will be the topic of future investigations. And, finally, we have not yet considered the influence of amplitude aberrations and deviations between the expected and the true, perfect, PSF on our algorithm. The successful laboratory experiments performed by our team, 9 however, give us hope that these potential errors may be overcome.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.">APPLICATIONS</head><p>The original idea for this development was driven by the need for an efficient wavefront sensing and extreme adaptive optics control algorithm for high-contrast imaging that scales more gracefully than the classical numberof-actuators-squared (N 2 ) law. Such an algorithm is indeed essential for future exoplanet imaging instruments for the next generation of extremely large telescopes. Apart from this originally intended application, our approach is useful for many other applications such as non-common path aberration measurements and slow shape corrections for future high-contrast imaging space missions.</p><p>Indeed, our approach is ideally suited to measure small, non-common path aberrations in AO-assisted instrument. To determine them, one uses a monochromatic point source in a focus in front of the AO system. Such a light source is often already present to calibrate the adaptive optics itself. Our approach now provides for an iterative wavefront sensing in the focal plane using the deformable mirror to introduce the required diversity. Results from an actual test of this approach can be found in these proceedings. 9</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 2 .</head><label>2</label><figDesc>Figure 2. Example of the convergence of our algorithm in terms of the PSF (top), total wavefront error (second from top), odd wavefront error (second from bottom) and even wavefront error (bottom) along with the iteration number at the very bottom and the Strehl ratio at the top.</figDesc></figure>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Multigrid preconditioned conjugate-gradient method for large-scale wave-front reconstruction</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Gilles</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">R</forename><surname>Vogel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">L</forename><surname>Ellerbroek</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Optical Society of America A</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="1817" to="1822" />
			<date type="published" when="2002-09" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">CuRe -A new wavefront reconstruction method for SH-WFS measurements</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Obereder</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Ramlau</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Rosensteiner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Zhariy</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
	<note>in [AO for ELT 2</note>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Fast wave-front reconstruction in large adaptive optics systems with use of the Fourier transform</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">A</forename><surname>Poyneer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">T</forename><surname>Gavel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Brase</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Optical Society of America A</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="2100" to="2111" />
			<date type="published" when="2002-10" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Linear methods in phase retrieval,&quot; in [Society of Photo-Optical In</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Ellerbroek</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Morrison</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series</title>
		<editor>Bareket, N. and Koliopoulos, C. L.</editor>
		<imprint>
			<date type="published" when="1983" />
			<biblScope unit="volume">351</biblScope>
			<biblScope unit="page" from="90" to="95" />
		</imprint>
	</monogr>
	<note>strumentation Engineers (SPIE) Conference Series</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Small-phase solution to the phase-retrieval problem</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">A</forename><surname>Gonsalves</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optics Letters</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="684" to="685" />
			<date type="published" when="2001-05" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Speckle Decorrelation and Dynamic Range in Speckle Noise-limited Imaging</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Sivaramakrishnan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">P</forename><surname>Lloyd</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">E</forename><surname>Hodge</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">A</forename><surname>Macintosh</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Astrophysical Journal Letters</title>
		<imprint>
			<biblScope unit="volume">581</biblScope>
			<biblScope unit="page" from="59" to="62" />
			<date type="published" when="2002-12" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m" type="main">Adaptive Optics by Sequential Diversity Imaging</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">A</forename><surname>Gonsalves</surname></persName>
		</author>
		<editor>E. Vernet, R. Ragazzoni, S. Esposito, &amp; N. Hubin</editor>
		<imprint>
			<date type="published" when="2002" />
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="page">121</biblScope>
		</imprint>
	</monogr>
	<note>Beyond Conventional Optics</note>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Sequential Diversity Imaging: Phase Diversity with AO Changes as the Diversities</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">A</forename><surname>Gonsalves</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">OSA Technical Digest (CD)</title>
		<imprint>
			<biblScope unit="page">1</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>Frontiers in Optics</note>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Experimental validation of optimization concepts for focal-plane image processing with adaptive optics</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Korkiakoski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Keller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Doelman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Fraanje</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Verhaegen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. SPIE, This conference</title>
		<meeting>SPIE, This conference</meeting>
		<imprint>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
	<note>Adaptive Optics Systems III</note>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">The Structure of High Strehl Ratio Point-Spread Functions</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">D</forename><surname>Perrin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Sivaramakrishnan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">B</forename><surname>Makidon</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">R</forename><surname>Oppenheimer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Graham</forename></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">R</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Astrophysical Journal</title>
		<imprint>
			<biblScope unit="volume">596</biblScope>
			<biblScope unit="page" from="702" to="712" />
			<date type="published" when="2003-10" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Extrasolar Planet Finding via Optimal Apodized-Pupil and Shaped-Pupil Coronagraphs</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">J</forename><surname>Vanderbei</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">N</forename><surname>Spergel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">G</forename><surname>Littman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Astrophysical Journal</title>
		<imprint>
			<biblScope unit="volume">582</biblScope>
			<biblScope unit="page" from="1147" to="1161" />
			<date type="published" when="2003-01" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Limitations and applicability of the Maréchal approximation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">S</forename><surname>Ross</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Applied Optics</title>
		<imprint>
			<biblScope unit="volume">48</biblScope>
			<biblScope unit="page">1812</biblScope>
			<date type="published" when="2009-03" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Phase retrieval and diversity in adaptive optics</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">A</forename><surname>Gonsalves</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optical Engineering</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="829" to="832" />
			<date type="published" when="1982-10" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Optical misalignment sensing and image reconstruction using phase diversity</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">G</forename><surname>Paxman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">R</forename><surname>Fienup</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the Optical Society of America A</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="914" to="923" />
			<date type="published" when="1988-06" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Phase-diversity wave-front sensor for imaging systems</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">L</forename><surname>Kendrick</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">S</forename><surname>Acton</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Duncan</forename></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">L</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Applied Optics</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="6533" to="6546" />
			<date type="published" when="1994-09" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Extending the Bandwidth of Speckle Interferometry</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">G</forename><surname>Wyne</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optics Communications</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="21" to="25" />
			<date type="published" when="1979-01" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Twin-image holography with spectrally broad light</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Roddier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Roddier</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Martin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Baranne</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Brun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Optics</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="149" to="152" />
			<date type="published" when="1980-06" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
