<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2018-12-04T16:12+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Detection of earth-like planets around nearby stars using a petal-shaped occulter</title>
			</titleStmt>
			<publicationStmt>
				<publisher>Cambridge University Press</publisher>
				<availability status="unknown"><p>Copyright Cambridge University Press</p>
				</availability>
				<date type="published" when="2010">2010. 2007. 2008. 2000. 2006. 1996. 1999</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">.</forename><forename type="middle">R J</forename><surname>Vanderbei</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">J</forename><surname>Cady</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">;</forename><forename type="middle">E</forename><surname>Cady</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Pueyo</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Soummer</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">;</forename><forename type="middle">E</forename><surname>Wolf</surname></persName>
						</author>
						<title level="a" type="main">Detection of earth-like planets around nearby stars using a petal-shaped occulter</title>
					</analytic>
					<monogr>
						<title level="j" type="main">Astrophys. J</title>
						<imprint>
							<publisher>Cambridge University Press</publisher>
							<biblScope unit="volume">7731</biblScope>
							<biblScope unit="page" from="51" to="53"/>
							<date type="published" when="2010">2010. 2007. 2008. 2000. 2006. 1996. 1999</date>
						</imprint>
					</monogr>
					<note>technology for starlight suppression via an external occulter,&quot; Proc. SPIE 8151, 81510J (2011). 2. S. B. Shaklan, M. C. Noecker, T. Glassman, A., &quot;Error budgeting and tolerancing of starshades for exoplanet detection,&quot; Proc. SPIE 7731, 77312G (2010). 3. T. Glassman, A. Johnson, A. Lo, D. Dailey, H. Shelton, and J. Vogrin, &quot;Error analysis on the NWO starshade,&quot; 10. R. Soummer, L. Pueyo, A. Sivaramakrishnan, and R. J. Vanderbei, &quot;Fast computation of Lyot-style coronagraph propagation,&quot; Opt. Express 15, 24, 15935-15951, (2007). 11. E. Cady, &quot;Design, tolerancing, and experimental verification of occulters for finding extrasolar planets,&quot; PhD thesis, Princeton University, 2010. 12. A. Dubra and J. A. Ferrari, &quot;Diffracted field by an arbitrary aperture,&quot; Am. J. of</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>OCIS codes: (0501940) Diffraction</term>
					<term>(0501970) Diffractive optics</term>
					<term>(0707345) Wave propaga- tion</term>
					<term>(1206085) Space instrumentation</term>
					<term>(3506090) Space optics</term>
				</keywords>
			</textClass>
			<abstract>
				<p>An occulter is a large diffracting screen which may be flown in conjunction with a telescope to image extrasolar planets. The edge is shaped to minimize the diffracted light in a region beyond the occulter, and a telescope may be placed in this dark shadow to view an extrasolar system with the starlight removed. Errors in position, orientation, and shape of the occulter will diffract additional light into this region, and a challenge of modeling an occulter system is to accurately and quickly model these effects. We present a fast method for the calculation of electric fields following an occulter, based on the concept of the boundary diffraction wave: the 2D structure of the occulter is reduced to a 1D edge integral which directly incorporates the occulter shape, and which can be easily adjusted to include changes in occulter position and shape, as well as the effects of sources-such as exoplanets-which arrive off-axis to the occulter. The structure of a typical implementation of the algorithm is included.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>One of the major goals of the coming decades is to directly image a terrestrial exoplanet. Direct imaging allows spectral information about the planet's atmosphere to be extracted from the spectrum of reflected light, including the potential presence of biomarkers, gases whose presence and abundance may indicate the presence of life. Detecting planets directly is a difficult task, however, for two reasons: intensity ratio (contrast) and angular resolution. An Earth-twin which orbits a Sun-twin at 1AU emits 10 10 times less flux than the parent star in the visible band; if the system was located at 10 parsecs from Earth, the angular separation of the two objects would be 100mas, which for most proposed space telescopes puts the separation under 4λ /D. Specialized methods are required to remove this flux at these small working angles.</p><p>One proposed method of suppressing the starlight is an occulter, a spacecraft with a shaped edge flown in front of the telescope to block the starlight before it arrives at the telescope. The occulter size (tens of meters) and distance (tens of thousands of kilometers) are chosen so the angular extent of the occulter is smaller than some desired angle, on the order of 100 milliarcseconds, so exoplanets in orbit about the star will still be visible. The edge is shaped to control diffraction, with the form chosen to suppress the light to a factor of 10 10 across the telescope aperture and over a wide spectral passband.</p><p>A major advantage of this approach, compared to an internal coronagraph, is that it significantly loosens the tolerances on the optical quality and thermal stability of the telescope optics, as well as eliminating the need for a wavefront control system for active correction. Conversely, the occulter itself must be built, deployed, and flown in formation to its own set of tolerances, and demonstrating this capability is an area of active research <ref type="bibr" target="#b0">[1]</ref>. These tolerances include limits on permanent errors in the occulter shape due to manufacturing and deployment errors; transient shape deformations from thermal fluctuations and vibration; and position and orientation changes of the occulter relative to the telescope-target axis from formation flying <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b2">3]</ref>.</p><p>The scale of an occulter-and the distance it must maintain with respect to its targetprecludes optical testing on the ground. All of these effects must be modeled in order to build an error budget and verify that an occulter can satisfy these requirements. The capture of the large dynamic range in the resulting field-10 5 or greater in amplitude-drives the accuracy of the propagator used for the models, while the modeling of time-varying thermal shape deformations and closed-loop formation flying in broadband light drive the speed of the calculation. Some of the most in-depth simulated observations can take from hours to days to run, and the ability to quickly and accurately model propagation past an occulter is thus a major enabling factor in the characterization of occulter system performance. Section 2 gives an overview of the current techniques; the new technique presented in this work is described in Sections 3 and 3.1, and a suggested implementation scheme, along with a pseudocode overview of the algorithm and some computational results, are given in Section 4.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Current occulter modeling techniques</head><p>Occulter designs take the general form of a solid central disk surrounded by N p identical tapering structures (petals) around the edge, giving the whole structure the general appearance of a flower. (An example is shown in <ref type="figure" target="#fig_0">Fig. 1</ref>.) This shape is a result of their provenance as (0,1)-valued approximations to apodizers; the general method to design an occulter is to determine a smooth apodization profile A(r) which can provide the necessary starlight suppression, and then convert it into a binary shape with a sufficient number of petals so that performance is not undermined. The actual form of A(r) can be determined by optimization <ref type="bibr" target="#b3">[4,</ref><ref type="bibr" target="#b4">5]</ref> or selecting an existing functional form <ref type="bibr" target="#b5">[6,</ref><ref type="bibr" target="#b6">7]</ref>. For an occulter designed in this manner, the region Ω in which the occulter is opaque can be written directly:</p><formula xml:id="formula_0">Ω = {(r, θ ) : 0 ≤ r ≤ R, θ ∈ Θ(r)}<label>(1)</label></formula><p>where</p><formula xml:id="formula_1">Θ(r) = N p −1 n=0 2πn N p − π N p A(r), 2πn N p + π N p A(r) ,<label>(2)</label></formula><p>with (r, θ ) being polar coordinates in the plane of the occulter. Each of the [. . . , . . .] is a set of points which defines the outline of a single petal; denotes the union of these sets, which sets the boundary for the entire occulter. (We denote this boundary as ∂ Ω, as it will be used later.) For a typical occulter, the occulter-telescope distance z = 5 × 10 7 m; the wavelength λ = 5 × 10 −7 m; the occulter radius R = 25m; and the maximum excursions in the plane of the telescope |ξ | and |η| ≤ 3m. These values place the occulter well within the Fresnel regime; that is, the region in which it is valid to approximate the exponent in the propagation integral with the first two terms of a power series (the Fresnel approximation). This approximation is suitable when <ref type="bibr" target="#b7">[8]</ref>.</p><formula xml:id="formula_2">z 3 π 4λ [(x − ξ ) 2 + (y − η) 2 ] 2 max .<label>(3)</label></formula><p>Further, a standard propagation integral computes the electric field past a finite aperture; the occulter, on the other hand, is a finite obstruction with an effectively infinite aperture. Here, we can turn to Babinet's theorem <ref type="bibr" target="#b8">[9]</ref>, which notes that field propagated through an aperture and the field propagated past its complement sum to the field that would have resulted were no obstruction present at all.</p><p>If a plane wave with amplitude A and wavelength λ is normally-incident on the occulter, as would be the case for an occulter properly aligned with a target star, the electric field at a distance z past the occulter would be written with the Fresnel approximation and Babinet's principle as</p><formula xml:id="formula_3">U(ξ , η) = A exp 2πiz λ 1 − 1 iλ z Ω exp πi λ z (r cos θ − ξ ) 2 + (r sin θ − η) 2 r dr dθ = A exp 2πiz λ 1 − 1 iλ z Ω exp πi λ z (x − ξ ) 2 + (y − η) 2 dx dy ,<label>(4)</label></formula><p>where ξ and η are Cartesian coordinates at the downstream location. The "1−" term before the integral results from the use of Babinet's principle. Errors in (for example) occulter shape will modify Ω, but Eq. (4) will hold regardless. Computing the integral for points in the plane of a telescope aperture is the key step in modeling the performance of an occulter.</p><p>One could attempt this integral by brute force: discretizing the shape of the occulter over a sufficiently fine grid to capture all of the necessary structure, and propagating this to the telescope aperture with direct integration or a matrix Fourier transform <ref type="bibr" target="#b9">[10]</ref>. This approach is not an easy task, as the occulter will be tens of meters across, with tolerances at the level of tens of microns <ref type="bibr" target="#b1">[2]</ref>, requiring a grid up to 10 6 × 10 6 or more to capture the full shape of the profile, not including array padding.</p><p>A better approach is to take advantage of the structure of the occulter: in the absence of errors, it has an N p -fold symmetry in the azimuthal direction, and most errors introduce small perturbations to that. Taking advantage of the symmetry leads to three main approaches to modeling propagation past an external occulter:</p><p>1. Integrals in r: The Bessel function expansion <ref type="bibr" target="#b3">[4]</ref> does the integral over θ explicitly, reducing the 2D integral to a series of single integrals in r whose contributions fall off exponentially fast near the optical axis, which makes computation extremely quick in this region. The series can be modified to incorporate some shape errors <ref type="bibr" target="#b10">[11]</ref> at the expense of slower convergence. Unfortunately, it is slower at locations far from the optical axis, and requires a good deal of effort to incorporate many types of errors, such as occulter tilt, into the model. Aside from the propagation modeling, the first, radially-independent term in this series is used in optimization approaches <ref type="bibr" target="#b3">[4,</ref><ref type="bibr" target="#b4">5]</ref> to design occulter shapes.</p><p>2. Integrals in θ : The Dubra-Ferrari integral <ref type="bibr" target="#b11">[12]</ref> starts one step back from the Fresnel form of Eq. (4), at the Raleigh-Sommerfeld diffraction integral, and evaluates the integral over r to produce a pair of single integrals in angular coordinates, one of which holds for points inside the geometric extent of the starshade, and one which holds outside. This approach can incorporate most errors straightforwardly and spends the same amount of time to determine the field any point in the telescope aperture plane. Because of the manner in which the integrals are segmented, however, the integrands are more difficult to determine correctly for points physically outside the extent of the starshade.</p><p>3. Perturbations to a nominal shape: The slit approach <ref type="bibr">[13]</ref> assumes the electric field for an occulter with no errors has been calculated by one of the above methods, and approximates the difference between the shape with and without errors as a series of long, thin boxes whose Fresnel transforms can be calculated quickly and exactly. This method is very fast but necessarily approximate.</p><p>In this paper, we propose a fourth method-the boundary-diffraction-wave approach-which seems to out-perform the three extant methods for general purpose use. It maintains the constant-time property of the Dubra-Ferrari integral with a 2-3× improvement in computational speed; see Sec. 4.1 for further discussion. It incorporates all errors on the shape of the occulter natively, and can be written straightforwardly to include position and orientation errors, as well as model waves from off-axis sources, such as an exoplanetary system or the finite diameter of the star. It can also take advantage of the structure of the integral to evaluate the field at multiple wavelengths with little additional computation. The approach of defining the occulter solely in terms of its boundary is a good fit for tolerancing the sorts of errors that are expected for an occulter. Manufacturing errors can be applied by specifically deforming desired edge regions; errors in petal placement can be included by translating and rotating only the boundary points associated with that petal.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">The boundary diffraction wave formulation</head><p>Most diffraction approaches to propagation through a finite aperture find their basis in the Huygens-Fresnel principle, which expresses the electric field at a point following the aperture as the sum over spherical waves emitting from every point within the aperture. However, a different representation was introduced by Maggi and Rubinowicz which splits the field into two parts, a part which propagates according to geometrical optics and a part which incorporates the effect of diffraction from the boundary. This boundary-diffraction-wave (BDW) representation was codified by the work of Miyamoto and Wolf <ref type="bibr">[14,</ref><ref type="bibr">15]</ref>, who showed that the boundary integral could be represented for any incident field entirely by a line integral around a vector potential. We will review their analysis briefly here.</p><p>Miyamoto and Wolf <ref type="bibr">[14]</ref> begin by writing the Kirchhoff formulation (see e.g. <ref type="bibr" target="#b8">[9]</ref>) for the diffraction integral from the aperture. Consider a volume of space, bounded by a surface S; the field at any point P within the volume may be expressed as an integral over all surface points Q on S:</p><formula xml:id="formula_4">U(P) = 1 4π S U(Q)∇ Q exp (iks) s − exp (iks) s ∇ Q U(Q) · n dS ≡ 1 4π S V(Q, P) · n dS.<label>(5)</label></formula><p>Here we let s be the distance between P and Q, n be a vector normal to S at point Q, and ∇ Q is the gradient evaluated at point Q. In the case of the occulter, the volume is the space z ≥ 0, and S stretches over the z = 0 plane, as well as having a component at infinity which is assumed to vanish. (Showing that this term vanishes requires some minor additional assumptions; see Sec. 8.3.2 of <ref type="bibr" target="#b8">[9]</ref>). It can then be shown <ref type="bibr">[14]</ref> that for V of this form, there exists a vector potential W, such that V = ∇ × W, and for plane waves incident on an aperture, that associated vector potential is</p><formula xml:id="formula_5">W(Q, P) = 1 4π A exp (ikp · r ) exp (iks) s ˆ s × p 1 + ˆ s · p ,<label>(6)</label></formula><formula xml:id="formula_6">U(P) = S ∇ × W(Q, P) · n dS.<label>(7)</label></formula><p>Here r is the vector from the origin to P; Q is a point within the aperture on S, and r is the vector from the origin to Q. k = 2π/λ is the wavenumber and λ is the wavelength under consideration. The various s-variables become</p><formula xml:id="formula_7">s ≡ r − r,<label>(8)</label></formula><formula xml:id="formula_8">s = ||s||,<label>(9)</label></formula><formula xml:id="formula_9">ˆ s = s s .<label>(10)</label></formula><p>and we assume the form of the plane wave in the vector direction p to be</p><formula xml:id="formula_10">U 0 (P) = A exp (ikp · r),<label>(11)</label></formula><p>with amplitude A. A coordinate diagram is shown in <ref type="figure" target="#fig_1">Fig. 2</ref>. Next, we consider for the moment the case of an opaque screen with an opening over the region Ω, a subregion of S with boundary ∂ Ω. We recall here that S is the entire bounding surface of the half-plane z ≥ 0, including the z = 0 plane; Ω is the section of it on which the occulter lies. (We are not considering the occulter case at the moment, but its complement; we will return to the occulter shortly.) In this case, the electric field from Eq. <ref type="formula" target="#formula_6">(7)</ref> across the aperture is:</p><formula xml:id="formula_11">U ap (P) = Ω ∇ × W(Q, P) · n dΩ,<label>(12)</label></formula><p>Our approach is to reduce this integral to a line integral, using Stokes' Theorem. To do this, we consider singularities of the vector potential. In general, W will have singularities somewhere on S for a given P, as otherwise the field in the half-space past the aperture will be zero. In the specific case of the plane wave, the lone singularity occurs at 1 + ˆ s · p = 0, which occurs only whenˆswhenˆ whenˆs is parallel to the propagation direction of the plane wave; thus, the singularity will fall in the aperture only for points P which fall in the beam as dictated by geometric optics. <ref type="figure" target="#fig_2">(Fig. 3</ref> shows an example of this.) Miyamoto and Wolf <ref type="bibr">[15]</ref> show that when Stokes' Theorem is applied, we get two distinct cases for the field at point P, depending on the singularity location:</p><p>U ap (P) = A exp (ikp · r) +U (B) (P) for points inside the extent of the aperture (13)</p><formula xml:id="formula_12">= U (B) (P) otherwise,</formula><p>where U (B) (P) is the counterclockwise line integral about the edge of Ω:</p><formula xml:id="formula_13">U (B) (P) = ∂ Ω W(Q, P) · d.<label>(14)</label></formula><p>Here, is a unit vector in the direction tangent to the edge at any point, and d is a differential element of the boundary. This formulation gives the field following an aperture, but in our case we have the opposite: the occulter is opaque, and the surroundings are open. Here we return to Babinet's theorem. As we started with the plane wave in Eq. (11), this implies our occulter field U(P) satisfies U 0 (P) = U(P) +U ap (P), </p><formula xml:id="formula_15">= Ae ikp·r − ∂ Ω W(Q, P) · d otherwise.<label>(16)</label></formula><p>The part of Eq. (16) which depends on geometric optics is termed U (G) (P):</p><p>U (G) (P) = 0 for points inside the extent of the aperture (17) = U 0 (P) otherwise. This equation is the general form of the occulter field, in the boundary-diffraction-wave formulation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">Vector potentials for occulter propagation</head><p>From this suitably general representation, we can make appropriate substitutions for the specific case of an occulter; these will simplify computation of electric fields later. We define the vector from the origin to P as r = (ξ , η, z); r , the vector from the origin to Q, is defined as r = (x, y, 0). (See again <ref type="figure" target="#fig_1">Fig. 2.)</ref> We can write the s-variables explicitly as</p><formula xml:id="formula_16">s ≡ r − r = (x − ξ , y − η, −z),<label>(18)</label></formula><formula xml:id="formula_17">s = ||s|| = [z 2 + (x − ξ ) 2 + (y − η) 2 ] 1/2 ,<label>(19)</label></formula><formula xml:id="formula_18">ˆ s = s s .<label>(20)</label></formula><p>We consider first the case where the plane wave is normally-incident on the occulter, as starlight would be when the system is correctly aligned. Given this, our vector terms can be written as</p><formula xml:id="formula_19">p = (0, 0, 1), (21) p · r = 0,<label>(22)</label></formula><formula xml:id="formula_20">ˆ s × p = 1 s (y − η, −(x − ξ ), 0),<label>(23)</label></formula><formula xml:id="formula_21">1 + ˆ s · p = 1 − z s ,<label>(24)</label></formula><p>and the potential in Eq. (6) becomes</p><formula xml:id="formula_22">exp (iks) = exp (ikz) exp [ik(s − z)],<label>(25)</label></formula><formula xml:id="formula_23">W(Q, P) = 1 4π A exp (ikz) exp [ik(s − z)] s − z ˆ s × p.<label>(26)</label></formula><p>More generally, an off-axis source at an angle of ψ 1 off-axis and ψ 2 from the x-axis will have p = (sin ψ 1 cos ψ 2 , sin ψ 1 sin ψ 2 , cos ψ 1 ), (27) p · r = x sin ψ 1 cos ψ 2 + y sin ψ 1 sin ψ 2 .</p><p>Before the expression for the vector potential becomes too complicated, we will define three intermediate variables ( f , g, and h) which we can substitute into Eq. <ref type="formula" target="#formula_0">(19)</ref>; these choices will greatly simplify subsequent computations.</p><formula xml:id="formula_25">f = z sin ψ 1 + (x − ξ ) cos ψ 2 cos ψ 1 + (y − η) sin ψ 2 cos ψ 1 ,<label>(29)</label></formula><formula xml:id="formula_26">g = −(x − ξ ) sin ψ 2 + (y − η) cos ψ 2 ,<label>(30)</label></formula><formula xml:id="formula_27">h = z cos ψ 1 − (x − ξ ) cos ψ 2 sin ψ 1 − (y − η) sin ψ 2 sin ψ 1 ≡ s · p.<label>(31)</label></formula><p>Substituting these variables gives:</p><formula xml:id="formula_28">s = [ f 2 + g 2 + h 2 ] 1/2 ,<label>(32)</label></formula><formula xml:id="formula_29">1 + ˆ s · p = 1 − h s ,<label>(33)</label></formula><formula xml:id="formula_30">ˆ s × p = 1 s ( f sin ψ 2 + g cos ψ 2 cos ψ 1 ,<label>(34)</label></formula><formula xml:id="formula_31">− f cos ψ 2 + g sin ψ 2 cos ψ 1 , −g sin ψ 1 ) exp (ikh) = exp [ikz cos ψ 1 − ik(x − ξ ) cos ψ 2 sin ψ 1 − ik(y − η) sin ψ 2 sin ψ 1 ] = exp (−ikp · r ) exp (ikz cos ψ 1 ) exp [ik(ξ cos ψ 2 + η sin ψ 2 ) sin ψ 1 ],<label>(35)</label></formula><formula xml:id="formula_32">W(Q, P) = 1 4π A exp (ikz cos ψ 1 ) exp [ik(ξ cos ψ 2 + η sin ψ 2 ) sin ψ 1 ] exp [ik(s − h)] s − h ˆ s × p,<label>(36)</label></formula><p>a similar relation to <ref type="bibr">Eq. (26)</ref>. This equation is still exact; for ψ 1 1, the usual case for objects in an exoplanetary system, we can note that</p><formula xml:id="formula_33">1 s(s − h) = 1 f 2 + g 2 1 + 1 [1 + f 2 +g 2 h 2 ] 1/2 ≈ 2 f 2 + g 2 ,<label>(37)</label></formula><formula xml:id="formula_34">s − h ≈ f 2 + g 2 2h ,<label>(38)</label></formula><p>and so the potential becomes</p><formula xml:id="formula_35">W(Q, P) ≈ 1 2π A exp (ikz cos ψ 1 ) exp [ik(ξ cos ψ 2 + η sin ψ 2 ) sin ψ 1 ] exp ik f 2 +g 2 2h f 2 + g 2 v( f , g),<label>(39)</label></formula><formula xml:id="formula_36">v( f , g) = ( f sin ψ 2 + g cos ψ 2 cos ψ 1 , (40) − f cos ψ 2 + g sin ψ 2 cos ψ 1 , −g sin ψ 1 ) = s × p.</formula><p>This form proves to be particularly useful, as ( f 2 + g 2 ) and v · can be calculated without loss of precision, as neither will be of order z for the small ψ 1 case. A typical occulter might have z = 5 × 10 7 m, R = 25m, and |ξ | and |η| ≤ 3m, and k ≈ 10 7 m −1 ; a representative exoplanet target for this occulter might have ψ 1 = 5×10 −7 rad. We note that exponential terms of order kz have been separated from smaller terms; these should be calculated independently, as kz ∼ 10 14 , and combining terms will lose precision in evaluating the exponent.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Efficient implementation</head><p>Evaluating the field at each downstream point requires the determination of two parts: the geometric field and the boundary field. We assume, to begin, that we are given a set of N points representing the edge of the occulter which form a simple closed curve, as well as a list of M downstream points and a list of L wavelengths at which the field is to be determined. We also assume that the edge is sufficiently well-sampled that the section of the edge between explicitlyspecified points is well-modeled by a linear segment, as this allows us to use the midpoint rule for numerically approximating the integral. Given the slowly-changing shape over the majority of the petal, this is a good assumption; small regions such as petal tips may be specified more finely.</p><p>The geometric field is still a plane wave of form Eq. (11) outside the aperture, and is 0 everywhere inside; finding the geometric field thus becomes a problem of checking whether a downstream point falls behind it or not. We do this by treating the edge as a polygon and finding the winding number of the downstream point (ξ 0 , η 0 ); this can be done efficiently with an O(N) routine such as polywind in Numerical Recipes <ref type="bibr">[16]</ref>, and holds regardless of the complexity of the occulter shape. This approach also speeds up multiband calculations, as the geometric extent of the shadow determined this way is wavelength-independent. Lateral errors in the occulter-telescope position may be included by adding a ∆ξ and ∆η to all points at the telescope plane, and that should be done first. Note that in the case of an off-axis source, the geometric shadow is shifted laterally as well; in this case, the winding number should be calculated around (ξ 0 − z sin ψ 1 cos ψ 2 , η 0 − z sin ψ 1 sin ψ 2 ). We then have:</p><formula xml:id="formula_37">U (G) (ξ 0 , η 0 , z) = A exp (ikz cos ψ 1 ) exp [ik(ξ 0 cos ψ 2 + η 0 sin ψ 2 ) sin ψ 1 ],<label>(41)</label></formula><p>for points outside the shadow = 0 otherwise.</p><p>In some cases-for example, when the telescope aperture remains close to the center of the occulter and the perturbations to the ideal shape of the occulter are small-the winding number may be able to be determined independently. This determination should be done if possible, as even an efficient algorithm can increase runtime significantly for boundaries containing a large number of points.</p><p>The boundary field can be evaluated efficiently with midpoint-rule quadrature running around the edge. First, for each of the N line segments running counterclockwise around the occulter edge, we derive the midpoint of line segment j going from (x j , y j , 0) to (x j+1 , y j+1 , 0):</p><formula xml:id="formula_38">(x (m) j , y (m) j , 0) = ([x j + x j+1 ]/2, [y j + y j+1 ]/2, 0),<label>(42)</label></formula><p>and the vector pointing along the segment</p><formula xml:id="formula_39">(x () j , y () j , 0) j = (x j+1 − x j , y j+1 − y j , 0). (43)</formula><p>with (x j+1 , y j+1 ) equal to (x 1 , y 1 ) when j = N. This derivation need only be done once at the beginning, as it holds for all M points and L wavelengths. (We note that, while the midpoint rule has been used for the quadrature, this is certainly not a requirement, and higher order methods could be used; Eq. (39) will still hold. Using a higher-order method may come at the cost of runtime.) For each point in the downstream field, we calculate f , g, and h for all N segments following Eq. <ref type="formula" target="#formula_1">(29)</ref>:</p><formula xml:id="formula_40">f j = z sin ψ 1 + (x (m) j − ξ 0 ) cos ψ 2 cos ψ 1 + (y (m) j − η 0 ) sin ψ 2 cos ψ 1 ,<label>(44)</label></formula><formula xml:id="formula_41">g j = −(x (m) j − ξ 0 ) sin ψ 2 + (y (m) j − η 0 ) cos ψ 2 ,<label>(45)</label></formula><formula xml:id="formula_42">h j = z cos ψ 1 − (x (m) j − ξ 0 ) cos ψ 2 sin ψ 1 − (y (m) j − η 0 ) sin ψ 2 sin ψ 1 ,<label>(46)</label></formula><p>and we then need only two intermediate terms:</p><formula xml:id="formula_43">T 1 j = f 2 j + g 2 j ,<label>(47)</label></formula><formula xml:id="formula_44">T 2 j = v( f j , g j ) · d = x () j (z sin ψ 1 sin ψ 2 + (y (m) j − η 0 ) cos ψ 1 ) − y () j (z sin ψ 1 cos ψ 2 + (x (m) j − ξ 0 ) cos ψ 1 ),<label>(48)</label></formula><p>to give us:</p><formula xml:id="formula_45">U (B) (ξ 0 , η 0 , z) = 1 2π A exp (ikz cos ψ 1 ) exp [ik(ξ 0 cos ψ 2 + η 0 sin ψ 2 ) sin ψ 1 ] × N ∑ j=1 exp ik T 1 j 2h j T 1 j T 2 j .<label>(49)</label></formula><p>Note that all of the steps prior to Eq. (49) are wavelength-independent; different values of k may be iterated over in the final step. It is advisable to keep terms of order kz (e.g. kz cos ψ 1 or kh) separate when evaluating to maintain numerical precision. A typical implementation might take the form shown in Algorithm 1. The for-loops over j in particular are well-suited to vectorization where this is supported.</p><formula xml:id="formula_46">for j = 1 to N (all occulter edge points) do Find x (m) j , y (m) j , x () j , y ()</formula><p>j using Eq. (42) and Eq. (43) end for q = 1 to M (all points at telescope aperture) do Apply lateral error to point q, if any Get winding number around point q with polywind for j = 1 to N (all occulter edge points) do Find f j , g j , h j , T 1 j , T 2 j using Eq. <ref type="formula" target="#formula_3">(44)</ref>  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>. Computational results</head><p>In the standard formulation of the Dubra-Ferrari integral (DF), points outside the geometric shadow are calculated with a different set of integrals which require searches for nearest-and further-neighbor points along the boundary for each point at the telescope aperture. To simplify direct comparison between the Dubra-Ferrari approach and the boundary-diffraction-wave approach for this paper, we choose to select a region which lies entirely in the geometric shadow of the occulter. This selection also fixes the winding number to 1 at all points under consideration, letting us bypass an explicit calculation. This choice is not an unreasonable assumption; the telescope will generally be entirely in the geometric shadow for a properly aligned occultertelescope system. Both approaches have similar formulations, with the primary difference coming in the fact that the Dubra-Ferrari integral uses angular coordinates θ centered about (ξ 0 , η 0 ), and so the angular distance between occulter edge points must be rederived for each point at the telescope aperture. This calculation turns out to be one of the major sources of overhead during the DF calculation. To compare the runtimes of the Dubra-Ferrari and BDW implementations, we consider a closed occulter boundary specified by 164000 individual points, corresponding to the occulter shown in <ref type="figure" target="#fig_0">Fig. 1</ref>. We select subsets of these points, and run Matlab implementations of both algorithms on this subset. <ref type="figure" target="#fig_4">Fig. 4</ref> shows the time to implement the propagation as a function of number of boundary points; the BDW algorithm remains 2-3× faster over a wide range of polygon sizes. <ref type="figure">Fig. 5</ref> shows the intensity profile in a region around the telescope aperture, plotted on a base-10 logarithmic scale. The plots of this intensity profile created with DubraFerrari and BDW are not visually distinguishable; within the telescope aperture, the maximum difference in intensity is 4.8 × 10 −15 . <ref type="figure">Fig. 5</ref>. Intensity at the plane of the telescope aperture following the occulter, plotted on a base-10 logarithmic scale. The telescope aperture is shown by a dashed circle.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Conclusion</head><p>We present a new approach to modeling fields following planet-finding occulters, based on the boundary-diffraction-wave formulation laid out by Miyamoto and Wolf. It has proved to be simple to modify the shape and recalculate with this approach to include various types of occulter errors, as well as fast to evaluate, improving on the current best method by 2-3× with no loss in precision. An efficient implementation has been laid out, and we hope it proves useful to others in the field.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. An example of a typical occulter with 20 petals, with the associated Cartesian and polar coordinate systems.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. A diagram of the points, coordinate systems, and vectors used in this paper. The left grid is in the plane of the occulter, and the right grid in the plane of the telescope aperture.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. A diagram showing the projected extent of the aperture given by geometric optics. A plane wave incident on the aperture in plane A with vector direction p produces a shifted aperture in plane B. Two angles which parameterize the direction of the plane wave, ψ 1 and ψ 2 , are shown as well.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><label></label><figDesc>through Eq. (48) end for s = 1 to L (all wavelengths) do Find U (B) by summing over h j , T 1 j , T 2 j in Eq. (49) Find U (G) using the winding number and Eq. (41) Find U = U (G) −U (B) for point q and wavelength s end end Algorithm 1: Pseudocode representation of BDW calculation 4.1</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. A comparison of the time to run the two propagation algorithms, as a function of number of points along the edge of the entrance aperture.</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments</head><p>This work was carried out as a part of the Imaging Performance Study funded by NASA's Exoplanet Exploration Program; the research was performed at the Jet Propulsion Laboratory, California Institute of Technology, under a contract with the National Aeronautics and Space Administration.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Advancing technology for starlight suppression via an external occulter</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">N</forename><surname>Spergel</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">J</forename><surname>Vanderbei</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Lisman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shaklan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Thomson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Walkemeyer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Bach</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Oakes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Cady</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Martin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Marchen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Macintosh</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">E</forename><surname>Rudd</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Mikula</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Lynch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. SPIE</title>
		<meeting>SPIE</meeting>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="volume">8151</biblScope>
			<biblScope unit="page">81510</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Error budgeting and tolerancing of starshades for exoplanet detection</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">B</forename><surname>Shaklan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">C</forename><surname>Noecker</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Glassman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">S</forename><surname>Lo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">J</forename><surname>Dumont</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">J</forename><surname>Cady</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Vanderbei</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">R</forename><surname>Lawson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. SPIE</title>
		<meeting>SPIE</meeting>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="volume">7731</biblScope>
			<biblScope unit="page">77312</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Error analysis on the NWO starshade</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Glassman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Johnson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Lo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Dailey</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Shelton</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Vogrin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. SPIE</title>
		<meeting>SPIE</meeting>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="volume">7731</biblScope>
			<biblScope unit="page">773150</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Optimal occulter design for finding extrasolar planets</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">J</forename><surname>Vanderbei</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><forename type="middle">J</forename><surname>Cady</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Astrophys. J</title>
		<imprint>
			<biblScope unit="volume">665</biblScope>
			<biblScope unit="page" from="794" to="798" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Performance of hybrid occulters using apodized pupil Lyot coronagraphy</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Cady</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Pueyo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Soummer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">J</forename><surname>Kasdin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. SPIE</title>
		<meeting>SPIE</meeting>
		<imprint>
			<date type="published" when="2008" />
			<biblScope unit="volume">7010</biblScope>
			<biblScope unit="page">70101</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">J</forename><surname>Copi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">D</forename><surname>Starkman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">The Big Occulting Steerable Satellite</title>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="volume">532</biblScope>
			<biblScope unit="page" from="581" to="592" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Detection of earth-like planets around nearby stars using a petal-shaped occulter</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Cash</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">442</biblScope>
			<biblScope unit="page" from="51" to="53" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">W</forename><surname>Goodman</surname></persName>
		</author>
		<title level="m">Introduction to Fourier Optics</title>
		<imprint>
			<publisher>McGraw-Hill</publisher>
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Born</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Wolf</surname></persName>
		</author>
		<title level="m">Principles of Optics</title>
		<imprint>
			<publisher>Cambridge University Press</publisher>
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Fast computation of Lyot-style coronagraph propagation</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Soummer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Pueyo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Sivaramakrishnan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">J</forename><surname>Vanderbei</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Opt. Express</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="15935" to="15951" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<title level="m" type="main">Design, tolerancing, and experimental verification of occulters for finding extrasolar planets</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Cady</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
		<respStmt>
			<orgName>Princeton University</orgName>
		</respStmt>
	</monogr>
<note type="report_type">PhD thesis</note>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Diffracted field by an arbitrary aperture</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Dubra</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">A</forename><surname>Ferrari</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. J. of Phys</title>
		<imprint>
			<biblScope unit="volume">67</biblScope>
			<biblScope unit="page" from="87" to="92" />
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
