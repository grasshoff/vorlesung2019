<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2018-12-04T16:25+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Microlensing Observations Rapid Search for Exoplanets: MORSE code for GPUs</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2015">2015</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Alistair</forename><surname>Mcdougall</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Physics and Astronomy</orgName>
								<orgName type="institution">University of Canterbury</orgName>
								<address>
									<addrLine>Private Bag 4800</addrLine>
									<settlement>Christchurch</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">⋆</forename></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Physics and Astronomy</orgName>
								<orgName type="institution">University of Canterbury</orgName>
								<address>
									<addrLine>Private Bag 4800</addrLine>
									<settlement>Christchurch</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><forename type="middle">D</forename><surname>Albrow</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Physics and Astronomy</orgName>
								<orgName type="institution">University of Canterbury</orgName>
								<address>
									<addrLine>Private Bag 4800</addrLine>
									<settlement>Christchurch</settlement>
									<country key="NZ">New Zealand</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Microlensing Observations Rapid Search for Exoplanets: MORSE code for GPUs</title>
					</analytic>
					<monogr>
						<title level="j" type="main">MNRAS</title>
						<imprint>
							<biblScope unit="volume">000</biblScope>
							<biblScope unit="page" from="1" to="7"/>
							<date type="published" when="2015">2015</date>
						</imprint>
					</monogr>
					<note type="submission">Accepted XXX. Received YYY; in original form ZZZ</note>
					<note>Preprint 20 August 2018 Compiled using MNRAS L A T E X style file v3.0</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>methods: numerical</term>
					<term>binaries: general</term>
					<term>planetary systems</term>
					<term>gravitational lensing: micro</term>
				</keywords>
			</textClass>
			<abstract>
				<p>The rapid analysis of ongoing gravitational microlensing events has been integral to the successful detection and characterisation of cool planets orbiting low mass stars in the Galaxy. In this paper we present an implementation of search and fit techniques on Graphical Processing Unit hardware. The method allows for the rapid identification of candidate planetary microlensing events and their subsequent followup for detailed characterisation.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>The OGLE 1 , MOA 2 and KMTNet 3 wide-field surveys currently detect and alert in excess of 2000 microlensing events per year in the direction of the Galactic Bulge. These events have an average timescale of ∼ 22 days, but individual events can be as short as a few days or as long as a few hundred. A small subset of microlensing events produce anomalous short-duration signals lasting from a few hours to a few days due to the presence of one or more planets associated with the lens-star (which is typically an M dwarf). Almost all the planets that have been detected and characterised via microlensing have relied on highcadence follow-up observations from various groups that include µFUN ( <ref type="bibr" target="#b10">Gould et al. 2006</ref>), RoboNet ( <ref type="bibr">Tsapras et al. 2009</ref>), PLANET ( <ref type="bibr" target="#b0">Albrow et al. 1996</ref><ref type="bibr" target="#b1">Albrow et al. , 1998</ref> and MiNDSTEp <ref type="bibr" target="#b6">Dominik et al. (2010)</ref>.</p><p>The follow-up groups typically operate with small-fieldof-view cameras, capable of observing only one event at a time, so event selection can have a significant effect on the yield of microlensing planets. The follow-up groups typically focus on two classes of events. First, <ref type="bibr" target="#b12">Griest &amp; Safizadeh (1998)</ref> have shown that, given the presence of a planet orbiting a lens star, a trajectory having a low impact parameter (i.e. a high magnification) is significantly more likely to intercept a central caustic and therefore produce an anomalous signal. Thus events predicted to reach very high magnification are chosen for intensive observation over their peak ⋆ E-mail:Alistair.McDougall@gmail.com † E-mail:Michael.Albrow@canterbury.ac.nz 1 http://ogle.astrouw.edu.pl/ogle4/ews/ews.html 2 https://it019909.massey.ac.nz/moa/alert2013/alert.html 3 http://astroph.chungbuk.ac.kr/∼ kmtnet magnification times. Second, events that are observed to be undergoing an anomaly are priority targets for followup. Unfortunately this second category of anomalous events is dominated by binary stars, rather than star-planet microlensing.</p><p>In order to select events from this category for intensive follow-up, rapid preliminary analysis of in-progress events is necessary. In this paper, we describe a new GPU-based code designed for rapid analysis of ongoing microlensing events.</p><p>The layout of the paper is as follows. In Section 2 we describe briefly the GPU computing architecture on which the code is based. In Sections 3-5 we present the algorithms and implementation details. Section 6 shows two examples of event analysis, and a summary is given in Section 7.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">GPU ARCHITECTURE</head><p>A Graphics Processing Unit (GPU) is a common component found in most desktop computers, but only recently has the potential of these devices for general computation been realized, in a range of disciplines from sciences to finance <ref type="bibr" target="#b9">(Gaikwad &amp; Toke 2009;</ref><ref type="bibr" target="#b17">Sainio 2010;</ref><ref type="bibr" target="#b13">Isborn et al. 2011;</ref><ref type="bibr" target="#b15">Mashimo et al. 2013</ref>). By utilizing the large scale parallelization ability of GPUs, increased performance can be achieved for some computational calculations if correctly incorporated. Most importantly, GPU code is generally inherently scalable, and increases in the number of GPU cores per device continues to outpace developments in CPU technology (see, for instance, <ref type="bibr">Vernardos &amp; Fluke (2014)</ref>).</p><p>For this code, we have adopted the Compute Unified Device Architecture (CUDA) extensions to the C language, developed by NVIDIA Corporation. A CUDA-enabled de-vice can be thought of as a grid of processing units (CUDA cores) that can execute sets of instructions (threads) in parallel. Blocks of up to 1024 threads (on compute capability 2.0) can be coded to access an amount of shared memory, with different threads (within a block) able to access individual elements of an array. Blocks can execute on the GPU either sequentially or in parallel, depending on their size and the number of computing cores in the device. At the device level, groups of 32 threads within a block (warps) have hardware enforced parallel execution. Blocks of threads and grids of blocks can have either 1-, 2-or 3-dimensional configurations (in CUDA compute capability 2.0 devices).</p><p>Additional to the shared memory (with fast read-write performance), threads have access to a slower read-write access global memory, and a hardware-optimised read-only texture memory. Both of these may be accessed by all threads, in all blocks of a single GPU function call. Texture memory is designed to store 2-and 3-dimensional arrays, and the computing architecture is designed for very rapid access to neighbouring pixels. This allows, for instance, very fast bilinear interpolation of an image stored in texture memory.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">THE BINARY MICROLENSING MODEL</head><p>The characteristic angular scale for microlensing is the Einstein radius,</p><formula xml:id="formula_0">θE = 4GM c 2 DS − DL DSDL ,<label>(1)</label></formula><p>where M is the total lens mass and DS and DL are the distances to the source and the lens respectively. The lensing equation for a point source and binary point-mass lens can be written</p><formula xml:id="formula_1">ζ = z − ε1 ¯ z − ¯ z1 − ε2 ¯ z − ¯ z2 ,<label>(2)</label></formula><p>where ε1 and ε2 are the masses of the individual lens components (as a proportion of the total lens mass), z1 and z2 are their complex angular positions in the plane of the sky in units of the Einstein radius <ref type="bibr">(Witt &amp; Mao 1995)</ref>. ζ is the source position and z is the image position. Inversion of this equation gives a fifth-order complex polynomial for the image positions, with either 3 or 5 solutions.</p><p>Since surface brightness is preserved by gravitational lensing, the magnification of the source in image j,</p><formula xml:id="formula_2">Aj = 1 detJ ,<label>(3)</label></formula><p>where</p><formula xml:id="formula_3">J = ∂ζ ∂z (4)</formula><p>is the Jacobian of the coordinate transformation from the source to the image plane. The total magnification is the sum of the individual image magnifications.</p><p>The point-source model for a microlensing event is rarely adequate for the majority of recognised binary microlensing events. In these cases, the source tends to pass close-to, or over, a lens caustic, which serves to resolve the source. To model such events, we must use a methodology that accounts for the finite source size. The two most common algorithms for this are contour integration via Stokes' Theorem <ref type="bibr" target="#b11">(Gould &amp; Gaucherel 1997;</ref><ref type="bibr" target="#b5">Bozza 2010</ref>) and various refinements of ray shooting maps <ref type="bibr" target="#b14">(Kayser, Refsdal &amp; Stabell 1986;</ref><ref type="bibr" target="#b7">Dong et al. 2006;</ref><ref type="bibr" target="#b3">Bennett &amp; Rhie 1996)</ref>. In Sections 4-5 below we describe our strategy, that is based on the magnification map approach.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">COARSE GRID SEARCH</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Magnification maps</head><p>Adopting Einstein-radius-normalized coordinates, set in the lens plane with the origin as the centre of mass of the lens and the lens masses lying on the z1 axis, a binary microlensing event may be described by seven basic parameters: d, the angular separation of the two lens components; q, the mass ratio of the lens components; u0 the distance of closest approach of the source to lens' barycentre; φ, the trajectory angle of the source measured from the positive axis that passes through both lens components; t0 the time of closest approach; tE, the time for the source to move an angular distance of one Einstein radius; and ρ, the angular source radius.</p><p>The majority of ground-based microlensing photometry is derived using the difference-imaging method. The flux of a microlensing event,</p><formula xml:id="formula_4">Fi = ∆Fi + F Ref = FSA(ti) + FB,<label>(5)</label></formula><p>where </p><formula xml:id="formula_5">∆Fi = c0 + c1A(ti),<label>(6)</label></formula><p>where A(t) is itself a non-linear function of the fundamental parameters (t0, tE, u0, φ, ρ, d, q). The first part of our modelling method is a search for viable regions of solution space in (t0, tE, u0, φ, ρ, d, q).</p><p>At the highest level, we set up a 29 × 21 fixed grid in (log d, log q). For each (log d, log q) pair, we generate a point-source magnification map, by solving the fifth-order polynomial inversion of Eqn <ref type="formula" target="#formula_1">(2)</ref> for a uniform grid of source positions ζij. For this calculation, each GPU thread independently computes the magnification for a given pixel in the map. The map is then convolved on the GPU, by a number of radially-symmetric source intensity profiles of different radii and fixed limb darkening (ΓI = 0.53). This produces a set of magnification maps corresponding to fixed ρ values. We have adopted seven values of ρ logarithmically-spaced over (0.001, 1). Our tests have shown that on currently available hardware it is faster to recompute these maps from scratch than to load them into memory from hard-disk storage. The magnification maps are loaded into GPU texture memory for the next stage of the analysis -a search over (u0, φ, ρ, t0, tE) space for each given (d, q).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Re-parameterising u0</head><p>Since u0 is defined with respect to the centre of the binary lens, a search of trajectories in a magnification map over a grid of angles φ and impact parameters u0 is liable to miss small caustic structures that are located far from the centre. These small (planetary) caustics can be critical in identifying binary lenses that include a low mass component. With this in mind, we replace a search over u0 with a search over fixed radial distances, r, from the central regions of caustics. These radial distances are scaled by the sizes of the caustics, as shown in <ref type="figure" target="#fig_1">Fig. 1</ref>.</p><p>We conduct a search over (t0, tE, ρ) for a fixed grid of (r, φ), where each (r, φ) pair is treated as a single block on the GPU. We refer to an (r, φ) pair as a trajectory. For this stage of the search, we use the simplex downhill method to locate a χ 2 minimum. At each iteration of the downhill search, each GPU thread is used to compute the contribution to χ 2 from a single observed data point. A given (ti, t0, tE) maps to a point (i) on a linear trajectory defined by (r, φ), through a given (d, q, ρ) map. Bilinear interpolation of the magnification maps stored in texture memory is used to retrieve the magnification A(ti) for the time of each data point.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Optimisations</head><p>There are several optimisations we make to improve the speed of the computation as follows.</p><p>(i) We use the observed peak-to-baseline magnitude range of the microlensing event to infer a minimum magnification that needs to take place in order for a trial trajectory to be a viable solution. The magnification as a function of position along a trajectory is quickly extracted from the point-source map and discarded if it doesn't fulfil this minimum magnification criterion.</p><p>(ii) In cases where the lightcurve is obviously near in shape to that of a single lens (Paczy´nskiPaczy´nski), we use the estimated single lens parameters as starting points for (t0, tE) in the simplex.</p><p>(iii) In cases where the lightcurve has, or is expected to contain, more than one peak, we reject trajectories where the point-source map contains fewer than the specified number of peaks. Since we are using a fixed grid of (d, q, r, φ), we have pre-computed a library that specifies the number of peaks in each trajectory. A peak is considered to be any point on a trajectory where the magnification gradient changes from positive to negative.</p><p>(iv) In non-Paczy´nskiPaczy´nski cases where we are able to specify the time of a single peak, t0 and tE are related by</p><formula xml:id="formula_6">t0 = tp − MptE,<label>(7)</label></formula><p>where tp is the input time of the peak from the data and Mp is the distance along the trajectory of the peak from t0 in units of Einstein radii. Mp is specified in our precomputed library. For a given trajectory, we can then adjust t0 to best match the data in order to find our starting simplex parameters.</p><p>(v) The optimum situation occurs where the times of multiple peaks can be provided. This allows t0 and tE to be solved analytically for each viable trajectory since, in addition to Eqn. 7,</p><formula xml:id="formula_7">tE = tp2 − tp1 Mp2 − Mp1<label>(8)</label></formula><p>where the tp,i are the set of specified times of peaks, and Mp,i are the pre-computed model peak times in units of Einstein radii. Again, we use these values as starting points for the simplex search.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4">Results</head><p>The outcome of our coarse grid search is a set of viable regions of parameter space where we expect to find the global solution. <ref type="figure">Fig. 2</ref> shows an example of coarse-search results projected onto (log d, log q) space. Because of the coarseness of the (log d, log q, r, φ) grid, it is unreasonable to adopt the single best solution thus far found as being the likely seed for the global solution. Thus we generally choose a number of local minima from the coarse search for further analysis. At this time, we adopt the three best wide solutions (d ≥ 1) and narrow solutions (d &lt; 1) as our seeds.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">REFINING SOLUTIONS</head><p>To refine our seed solutions, we employ a Markov Chain Monte Carlo search. For this part of our modelling, we discard the magnification map approach and instead compute magnifications for a given set of trial parameters using an image-centred ray shooting algorithm similar to that of Bennett (2010). The Markov chain sampling is implemented in the Python language with CUDA C used to compute magnifications. To implement our calculations on a GPU, we treat the epoch of each data point as a single block. Within a block, we use groups of threads to perform integrations over images, with each thread corresponding to different locations on an image.</p><p>Initially we compute the locations of the caustics corresponding to the current <ref type="bibr">(d, q)</ref>. This information is shared with all blocks (epochs). We then use 128 threads distributed <ref type="figure">Figure 2</ref>. The log χ 2 map in (log d, log q) space for OGLE-2003-BLG-0235. Overlaid arrows show the movement from seed solutions during the MCMC search.</p><p>over the caustic edges to establish the proximity of the source to its nearest caustic. For source-caustic distances greater than 10ρ we use the point-source approximation for the magnification, otherwise we proceed with image-centred ray shooting calculations as follows.</p><p>Again using 128 threads distributed around the source boundary and its centre, we compute image positions for these source points. Resampling near the highest magnification points is performed in order to detect situations where a source is grazing a caustic. Starting from the centre of each image, a polar grid is iteratively expanded until it encompasses the entire image. Polar coordinates are used since images are often crescent shaped, approximately following the locus of the critical curves (see <ref type="figure">Fig. 3</ref>). Tests are incorporated to detect merged images.</p><p>We now integrate over each image with a weighting corresponding to the source intensity profile (found by inverse ray shooting). To deal with the numerical problems introduced by the fact that the source intensity is zero at the boundaries, we follow the second-order integration scheme given by <ref type="bibr" target="#b2">Bennett (2010)</ref>. Individual threads are used as grid points for the integration and we invoke parallel summation with loop unrolling for rapid computation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Final solution with uncertainties</head><p>Upon completion of local area MCMCs, the best solution is chosen from the chain that produced the lowest final χ 2 model, which we regard as being close to the global minimum. From this solution the data errors are normalized by forcing χ 2 per degree of freedom for each source of data to unity. Although statistically undesirable, normalizing errors bars in this way prevents bias due to poorly-estimated uncer- <ref type="figure">Figure 3</ref>. A finite source (dark central circle) passing over a caustic structure (five pointed central structure), resulting in 5 images (lightest grey) that closely follow the edge of the critical curves (darkest grey). This example also shows the merging of two images that cross the critical curve due to the source being partially inside of the caustic structure. tainties in particular data sources. We then use the sampler EMCEE <ref type="bibr" target="#b8">(Foreman-Mackey et al. 2013</ref>) along with CUDA image-centered ray shooting to determine our final solution and parameter covariances.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Higher-order effects</head><p>The inclusion of higher-order effects such as parallax and orbital motion can be incorporated in the GPU kernel to modify the source and lens positions when performing inverse ray shooting, at minimal computational cost. However, new challenges arise when incorporating these effects into a search strategy whilst maintaining high-performance. Parallax (and xallarap) could, in principle, be added to the current grid search strategy, as they only affect the interpolated source trajectory. The inclusion of orbital motion at this stage is not possible since multiple (d, q) magnification maps per trajectory would be required. These higher-order effects are typically only considered if necessary after the original seven parameters have been determined, at which point they are incorporated into the EMCEE search, which uses image-centred ray shooting.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">EXAMPLES</head><p>As demonstrations and verification of our code, we present results below for two well know events that have been previously analysed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1">OGLE-2003-BLG-0235</head><p>This was the first microlensing event in which a planet was discovered, see <ref type="bibr" target="#b4">Bond et al. (2004)</ref>. It has more recently been reanalysed by <ref type="bibr" target="#b2">Bennett (2010)</ref>. Data was taken by the OGLE and MOA survey telescopes that show a moderate magnification microlensing event (A0 ∼ 5.5) that peaked at around JD 2452847. The event shows a caustic passage that lasted for ∼ 7 days from JD 2452834. In <ref type="table">Table 1</ref> we show the solutions found by <ref type="bibr" target="#b4">Bond et al. (2004)</ref>.</p><p>We have modelled the event using the OGLE and MOA data from <ref type="bibr" target="#b4">Bond et al. (2004)</ref> that has been made available through the NASA Exoplanet Archive 4 . The entire OGLE data set of 285 points was used, while the MOA data set was reduced from 1152 data points down to 1089 by rejecting points with very large uncertainties. We specified a minimum base-peak lightcurve amplitude of 2.0 mag, and demanded that solutions contained at least three lightcurve peaks, with two of these located near JD2452842.08 (the caustic exit) and JD2452848.0 (the central peak). The χ 2 map from our initial grid search is shown in <ref type="figure">Fig 2.</ref> This initial search took 59 minutes using an NVIDIA Tesla C2075 GPU card. MCMC models using the image-centred ray shooting procedures discussed in Section 5 were then started from the three best close (d &lt; 1) and wide (d &gt;= 1) solutions. Wellconverged solutions, using a total of 4000 iteration steps per chain were obtained for these 6 chains in around 1.85 hours. Arrows on <ref type="figure">Fig. 2</ref> indicate the movement of solutions during the MCMC iterations. In <ref type="table">Table 1</ref> we show the parameters of our two best solutions compared with those found by <ref type="bibr" target="#b4">Bond et al. (2004)</ref>. Our final solution, incorporating normalized data uncertainties, and with parameter uncertainties generated using EMCEE, is given in <ref type="table" target="#tab_2">Table 2</ref> and <ref type="figure">Fig. 4</ref>, and is the same as the best solutions found previously. This analysis also serves as a performance comparison with the method of Bennett (2010), who achieved the same 'Best planetary' solution of <ref type="table">Table 1</ref> by searching a restricted parameter space of slightly more that 70, 000 parameter sets in 5 hours and 14 minutes. Using our methods, we determined our 6 best coarse solutions by exploring an unrestricted parameter space of <ref type="bibr">8,</ref><ref type="bibr">197,</ref><ref type="bibr">199</ref> parameter sets in 59 minutes. This includes the time for each parameter set to potentially perform a simplex downhill search of up to 5000 steps over (t0, tE, ρ) including the subsequent 6 MCMC explorations, the analysis explored between 8 million and 40 million parameter trials in 2 hours and 50 minutes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2">OGLE-2012-BLG-0406</head><p>This is an example of an event detected and monitored by the OGLE IV survey group, with intensive follow-up observations by several other groups. Following detection in 2012 April, the event was predicted to have a low peak magnification and was considered low priority for follow-up. An anomalous brightening was recognised in early July, prompting monitoring by the PLANET and microFUN groups using telescopes at SAAO and CTIO. Following a peak in the lightcurve on July 5 and recognition by C. Han that the 4 http://exoplanetarchive.ipac.caltech.edu/ <ref type="figure">Figure 4</ref>. Final fitted lightcurve for the marginalized wide solution of <ref type="bibr">OGLE-2003-BLG-235</ref> lightcurve was probably planetary in nature, several other telescopes began to intensively monitor the event.</p><p>The lightcurve has been modelled by <ref type="bibr" target="#b16">Poleski et al. (2014)</ref> using only OGLE survey telescope data, and <ref type="bibr">Tsapras et al. (2014)</ref> who used data from ten separate observing sites. Both of these papers used a similar initial search routine, with a few differences in the filtering and error scaling of the data used. <ref type="bibr" target="#b16">Poleski et al. (2014)</ref> assumed a limb-darkening coefficient of ΓI = 0.353 whereas <ref type="bibr">Tsapras et al. (2014)</ref> assumed ΓI = 0.53.</p><p>Due to the deviations from a point-source lightcurve being of short time scale on the shoulder of a Paczy´nskiPaczy´nski curve, it is safe to conclude that the cause of the anomaly is from the source passing close to a central caustic. In such a case, the single lens parameters of u0, t0, and tE (which can be determined with relative ease) are similar to the matching parameters of the binary lens model. <ref type="bibr">Tsapras et al. (2014)</ref> used this information to perform a hybrid grid search of d, q, and φ, where u0, t0, tE, and ρ are minimized using MCMC methods. The grid was searched between the limits of −1 ≤ log 10 (d) ≤ 1, −5 ≤ log 10 (q) ≤ 1, and 0 ≤ φ ≤ 2π with the aim to locate all areas of local minimum, before further refinement by narrowing the grid search parameter space. Finally a χ 2 optimization in all seven parameters was performed in each local minimum to determine the best solution. The <ref type="bibr">Tsapras et al. (2014)</ref> and <ref type="bibr" target="#b16">Poleski et al. (2014)</ref> binary lens model solutions are shown in <ref type="table">Table 3</ref>.</p><p>We have used our code as described in Sections 3-5 above to fit the data sets used by <ref type="bibr" target="#b16">Poleski et al. (2014)</ref> (OGLE only) and by <ref type="bibr">Tsapras et al. (2014</ref>  <ref type="bibr" target="#b16">Poleski et al. (2014)</ref> and <ref type="bibr">Tsapras et al. (2014)</ref>. Our subsequent MCMC refinements using image-centred ray shooting determined the same min- <ref type="table">Table 1</ref>. Binary lens seven parameter model maximum likelihood solutions of MOA-2003-BLG-0053/OGLE-2003-BLG-0235, showing planetary solutions and the best non-planetary model ( <ref type="bibr" target="#b4">Bond et al. 2004</ref>) and from our code, based on EMCEE runs using error-normalized data. <ref type="bibr" target="#b4">Bond et al. (2004)</ref>   2847.91 ± 0.11 2850.02 ± 0.13 t E 59.8 ± 1.6 56.8 ± 1.5 <ref type="figure">Figure 5</ref>. Final fitted lightcurve for OGLE-12-BLG-406</p><p>ima as those previous solution as given in <ref type="table">Table 3</ref>. The fitted multi-data-set light curve is shown in <ref type="figure">Fig. 5</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7">SUMMARY</head><p>In this paper we have described a fast method for fitting binary gravitational microlensing events. The code is written in CUDA C and Python, and the computationally intensive parts are run on massively parallel GPU hardware. The code will scale naturally to higher performance as GPU technology evolves.</p><p>As part of our algorithms, we introduce several optimisations that improve the ability to detect features due to small caustics and the speed of execution. Results from our ongoing analysis of current events are reported through our website 5 .</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>F</head><label></label><figDesc>Ref is the flux of the star on the reference image, FS is the unlensed source star flux, FB is the flux due to blended objects and ∆Fi is the measured difference-image flux. The difference-flux model is therefore a linear function of the magnification,</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 1 .</head><label>1</label><figDesc>Figure 1. Example of an (r, φ) search space about the caustics of a d = 0.7, q = 0.5 binary. The coordinates (u 1 , u 2 ) are positions in the lens plane in Einstein radius units relative to the mid-point of the lens masses. Lens masses are marked by 'O' symbols and the centres of the search spaces are marked by 'X'.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><head>Table 2 .</head><label>2</label><figDesc></figDesc><table>Final seven parameter binary lens model solutions of 
OGLE-2003-BLG-0235 from error-normalized data. These are the 
marginalized posterior mean and standard deviation for each pa-
rameter. 

Marginalized 
Marginalized 
Parameter 
wide solution 
close solution 

d 
1.120 ± 0.004 
0.915 ± 0.002 
q(×10 −3 ) 
6.3 ± 0.6 
11.7 ± 1.0 
ρ(×10 −4 ) 
10.0 ± 1.2 
8.98 ± 0.71 
u 0 
0.137 ± 0.004 
0.154 ± 0.005 
φ 
0.695 ± 0.024 
3.24 ± 0.02 
t 0 
</table></figure>

			<note place="foot">MNRAS 000, 1-7 (2015)</note>

			<note place="foot" n="5"> http://www2.phys.canterbury.ac.nz/∼u-lenser/</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8">ACKNOWLEDGEMENTS</head><p>MDA thanks the Department of Astronomy, University of Wisconsin-Madison, for hospitality during the writing of this paper. We thank NVIDIA Corporation for supporting our work.</p></div>
			</div>

			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">D</forename><surname>Albrow</surname></persName>
		</author>
		<title level="m">12 th IAP -Variable stars and the astrophysical returns of microlensing surveys</title>
		<editor>R. Ferlet, J. P. Maillard, &amp; B. Raban</editor>
		<imprint>
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">D</forename><surname>Albrow</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J.-P</forename><surname>Beaulieu</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Birch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">509</biblScope>
			<biblScope unit="page">687</biblScope>
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">P</forename><surname>Bennett</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">716</biblScope>
			<biblScope unit="page">1408</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">P</forename><surname>Bennett</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">H</forename><surname>Rhie</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">472</biblScope>
			<biblScope unit="page">660</biblScope>
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><forename type="middle">A</forename><surname>Bond</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">606</biblScope>
			<biblScope unit="page">155</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Bozza</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">MNRAS</title>
		<imprint>
			<biblScope unit="volume">408</biblScope>
			<biblScope unit="page">2188</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Dominik</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Astron. Nachrichten</title>
		<imprint>
			<biblScope unit="volume">331</biblScope>
			<biblScope unit="page">671</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Dong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">642</biblScope>
			<biblScope unit="page">842</biblScope>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Foreman-Mackey</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">W</forename><surname>Hogg</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Lang</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Goodman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PASP</title>
		<imprint>
			<biblScope unit="volume">125</biblScope>
			<biblScope unit="page">306</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Gaikwad</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><forename type="middle">M</forename><surname>Toke</surname></persName>
		</author>
		<title level="m">Proceedings of the 2Nd Workshop on High Performance Computational Finance, WHPCF &apos;09</title>
		<meeting>the 2Nd Workshop on High Performance Computational Finance, WHPCF &apos;09<address><addrLine>New York, NY, USA</addrLine></address></meeting>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2009" />
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="1" to="6" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Gould</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Udalski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>An</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">644</biblScope>
			<biblScope unit="page">37</biblScope>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Gould</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Gaucherel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">477</biblScope>
			<biblScope unit="page">580</biblScope>
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Griest</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Safizadeh</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">500</biblScope>
			<biblScope unit="page">37</biblScope>
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">M</forename><surname>Isborn</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Luehr</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><forename type="middle">S</forename><surname>Ufimtsev</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">J</forename><surname>Mart¨ı£¡nezmart¨ı£¡nez</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Chemical Theory and Computation</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">1814</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Kayser</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Refsdal</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Stabell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">166</biblScope>
			<biblScope unit="page">36</biblScope>
			<date type="published" when="1986" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Mashimo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y</forename><surname>Fukunishi</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Kamiya</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Chemical Theory and Computation</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">5599</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Poleski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Udalski</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Dong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">782</biblScope>
			<biblScope unit="page">47</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Sainio</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computer Physics Communications</title>
		<imprint>
			<biblScope unit="volume">181</biblScope>
			<biblScope unit="page">906</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
