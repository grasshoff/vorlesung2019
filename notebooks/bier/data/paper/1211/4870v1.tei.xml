<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2018-12-11T13:18+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">IRIS: A Generic Three-Dimensional Radiative Transfer Code</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012-11-20">20 Nov 2012 September 4, 2018</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Ibgui</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">LERMA</orgName>
								<orgName type="institution" key="instit1">Observatoire de Paris</orgName>
								<orgName type="institution" key="instit2">CNRS et UPMC</orgName>
								<address>
									<addrLine>5 place J. Janssen</addrLine>
									<postCode>92195</postCode>
									<settlement>Meudon</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Hubeny</surname></persName>
							<email>hubeny@as.arizona.edu</email>
							<affiliation key="aff1">
								<orgName type="department">Steward Observatory</orgName>
								<orgName type="institution">University of Arizona</orgName>
								<address>
									<addrLine>933 North Cherry Avenue</addrLine>
									<postCode>85721</postCode>
									<settlement>Tucson</settlement>
									<region>AZ</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Lanz</surname></persName>
							<affiliation key="aff2">
								<orgName type="laboratory">Laboratoire J.-L. Lagrange</orgName>
								<orgName type="institution" key="instit1">Université de Nice-Sophia Antipolis</orgName>
								<orgName type="institution" key="instit2">CNRS</orgName>
								<address>
									<addrLine>Observatoire de la Côte d&apos;Azur, BP 4229</addrLine>
									<postCode>06304</postCode>
									<settlement>Nice</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Stehlé</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">LERMA</orgName>
								<orgName type="institution" key="instit1">Observatoire de Paris</orgName>
								<orgName type="institution" key="instit2">CNRS et UPMC</orgName>
								<address>
									<addrLine>5 place J. Janssen</addrLine>
									<postCode>92195</postCode>
									<settlement>Meudon</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">IRIS: A Generic Three-Dimensional Radiative Transfer Code</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2012-11-20">20 Nov 2012 September 4, 2018</date>
						</imprint>
					</monogr>
					<note type="submission">Received ; accepted</note>
					<note>Astronomy &amp; Astrophysics manuscript no. ms c ESO 2018</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords>methods: numerical -radiative transfer</keywords>
			</textClass>
			<abstract>
				<p>Context. For most astronomical objects, radiation is the only probe of their physical properties. Therefore, it is important to have the most elaborate theoretical tool to interpret observed spectra or images, thus providing invaluable information to build theoretical models of the physical nature, the structure, and the evolution of the studied objects. Aims. We present IRIS, a new generic three-dimensional (3D) spectral radiative transfer code that generates synthetic spectra, or images. It can be used as a diagnostic tool for comparison with astrophysical observations or laboratory astrophysics experiments. Methods. We have developed a 3D short-characteristic solver that works with a 3D nonuniform Cartesian grid. We have implemented a piecewise cubic, locally monotonic, interpolation technique that dramatically reduces the numerical diffusion effect. The code takes into account the velocity gradient effect resulting in gradual Doppler shifts of photon frequencies and subsequent alterations of spectral line profiles. It can also handle periodic boundary conditions. This first version of the code assumes Local Thermodynamic Equilibrium (LTE) and no scattering. The opacities and source functions are specified by the user. In the near future, the capabilities of IRIS will be extended to allow for non-LTE and scattering modeling. Results. IRIS has been validated through a number of tests. We provide the results for the most relevant ones, in particular a searchlight beam test, a comparison with a 1D plane-parallel model, and a test of the velocity gradient effect. Conclusions. IRIS is a generic code to address a wide variety of astrophysical issues applied to different objects or structures, such as accretion shocks, jets in young stellar objects, stellar atmospheres, exoplanet atmospheres, accretion disks, rotating stellar winds, cosmological structures. It can also be applied to model laboratory astrophysics experiments, such as radiative shocks produced with high power lasers.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Essentially all objects in the Universe have a complicated, three-dimensional, dynamic structure. Understandably, throughout most of the history of astronomy the observed objects had to be modeled using significant restrictions and approximations. Among them, a set of assumptions about the global geometry of an object always played a pivotal role. For instance, stellar atmospheres were typically treated assuming a plane-parallel, horizontally-homogeneous geometry, which simplified the problem to one spatial dimension. Similarly, stellar winds, novae, planetary nebulae, and other extended sources, were modeled using an assumption of spherical symmetry, which again renders it a one-dimensional problem.</p><p>In the last two decades, there was much activity devoted to extend the traditional modeling techniques to treat structures that are truly 3-dimensional (3D). In fact, detailed 3D hydrodynamic simulations have now become essentially routine. A non-exhaustive list of 3D astrophysical (radiation)(magneto)hydrodynamics (RHD, MHD or RMHD) codes includes ZEUS <ref type="bibr">(Stone &amp; Norman 1992a,b)</ref>, ENZO <ref type="bibr" target="#b8">(Bryan &amp; Norman 1997;</ref><ref type="bibr">Norman &amp; Bryan 1999;</ref><ref type="bibr" target="#b51">O'Shea et al. 2004;</ref><ref type="bibr" target="#b49">Norman et al. 2007</ref>), RAMSES (Teyssier 2002), HERACLES ( <ref type="bibr" target="#b24">González et al. 2007</ref>), PLUTO ( <ref type="bibr" target="#b45">Mignone et al. 2007</ref>), ATHENA ( <ref type="bibr" target="#b52">Stone et al. 2008</ref>) and its radiation module ( <ref type="bibr" target="#b17">Davis et al. 2012</ref>), <ref type="bibr">AstroBEAR (Cunningham et al. 2009</ref>).</p><p>However, since most of the information about an astronomical object is conveyed to a distant observer by its radiation, detailed 3D hydrodynamic models have to be accompanied by adequate 3D radiation transfer solutions that provide a spectroscopic diagnostic information. Compared to 3D hydrodynamic models, the 3D radiation transfer solvers are much more complicated and difficult to treat numerically, because (i) there are many more quantities that describe a radiation field, as compared to the hydrodynamics, due to the directional and spectral dependence of radiation; (ii) a long-range interaction between the radiation field and the plasma arises because of a typically much larger mean free path of a photon compared to a mean free path of massive particles.</p><p>Although providing exact time-dependent, non-LTE radiation (magneto)hydrodynamic models of astronomical objects is generally viewed as a mighty goal, such a goal has not been fully achieved yet. However, a large progress was accomplished in recent years, specifically by 3D RMHD codes for stellar atmospheres, such as: the Copenhagen-Oslo Stagger Codes <ref type="bibr" target="#b48">(Nordlund &amp; Galsgaard 1995;</ref><ref type="bibr" target="#b23">Galsgaard &amp; Nordlund 1996;</ref><ref type="bibr" target="#b26">Hansteen 2004;</ref><ref type="bibr" target="#b27">Hansteen et al. 2007</ref>), CO 5 BOLD ( <ref type="bibr" target="#b21">Freytag et al. 2002)</ref>, <ref type="bibr">MURaM (Vögler et al. 2005</ref>), Bifrost ( <ref type="bibr" target="#b25">Gudiksen et al. 2011</ref>). All of these codes solve the 3D radiative transfer by approximating the monochromatic opacities with a small number of mean opacities (the opacity binning scheme of <ref type="bibr">Nordlund 1982)</ref>. With typically four bins, they can model the frequencyintegrated radiative energy losses and gains quite well.</p><p>There are also several recently developed computer codes specifically designed to provide 3D radiative transfer solvers, typically for a post-processing of 3D hydrodynamic simulations. The most widely used among them are the following: MUGA <ref type="bibr" target="#b3">(Auer &amp; Paletou 1994;</ref><ref type="bibr" target="#b57">Trujillo Bueno &amp; Fabiani Bendicho 1995;</ref><ref type="bibr" target="#b19">Fabiani Bendicho et al. 1997</ref>), MULTI3D <ref type="bibr" target="#b5">(Botnen 1997;</ref>), which is a generalization of the 1D code MULTI <ref type="bibr" target="#b10">(Carlsson 1986)</ref>, the RH code <ref type="bibr" target="#b58">(Uitenbroek 2001</ref><ref type="bibr" target="#b59">(Uitenbroek , 2006</ref>), a 3D version of the atmospheric code PHOENIX <ref type="bibr" target="#b28">(Hauschildt &amp; Baron 2006</ref>; <ref type="bibr" target="#b4">Baron &amp; Hauschildt 2007;</ref><ref type="bibr" target="#b29">Hauschildt &amp; Baron 2008</ref>), ASSeT ( <ref type="bibr" target="#b38">Koesterke et al. 2008;</ref><ref type="bibr" target="#b37">Koesterke 2009</ref>), SCATE ( <ref type="bibr" target="#b31">Hayek et al. 2011</ref>). They differ in their intended range of applications, and in many details of the numerical techniques. They all use some variant of the short-characteristics scheme (see Section 3), but differ in details of what is assumed about the behavior of state parameters between the grid points, and how the necessary interpolations are being performed. For details, the reader is referred to the above mentioned papers, and several excellent review papers <ref type="bibr" target="#b11">(Carlsson 2008</ref><ref type="bibr" target="#b12">(Carlsson , 2009</ref>.</p><p>In this paper, we describe our variant of the threedimensional radiative transfer solver, named IRIS. Analogously to most of the above mentioned techniques, it uses the shortcharacteristics scheme. Our solver differs from the previous ones in several respects: it is formulated only in the Cartesian coordinate system, but within this system it is formulated in the most universal way that allows for several variants of the spatial integration and interpolation to be tested and used depending on the actual application; it carefully treats subgriding to allow for line radiation transport in the presence of arbitrary (non-relativistic) velocity fields. Although the current version assumes Local Thermodynamic Equilibrium (LTE) and no scattering, the code is prepared to be relatively straightforwardly extended to treat scattering and departures from LTE, the so-called non-LTE (or NLTE) situations. This will be reported in future papers.</p><p>The paper is organized as follows. In Section 2 we outline the main physical assumptions of the model solved by IRIS. In Section 3 we summarize the short-characteristics method, and its application in a 3D Cartesian grid. In Section 4 we describe the piecewise, cubic, locally monotonic, interpolation technique that we use. Then, in Section 5 we describe our implementation in IRIS of the techniques presented in Sections 3 and 4. We also explain the procedure to handle general macroscopic velocity fields. The calculation of the moments of the radiation field and the related angular integration methods are the subjects of Section 6. We detail in Section 7 the method that we employ to treat media with periodic boundary conditions. Section 8 presents the results of relevant tests. We conclude our paper in Section 9 with a summary of the features of IRIS, and with an outline of possible extensions to the code.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Radiative Transfer: Basic Definitions and Assumptions</head><p>The general unpolarized radiative transfer equation (RTE) in the observer's frame reads <ref type="bibr" target="#b15">(Chandrasekhar 1950;</ref><ref type="bibr" target="#b46">Mihalas 1978;</ref><ref type="bibr" target="#b47">Mihalas &amp; Mihalas 1984)</ref> 1 c ∂ ∂t + n · ∇ I(r, n, ν, t) = η(r, n, ν, t) − χ(r, n, ν, t) I(r, n, ν, t) , <ref type="formula">(1)</ref> where I(r, n, ν, t) is the specific intensity of radiation at position r, propagating in the direction specified by the unit vector n, at frequency ν, and time t; χ(r, n, ν, t) is the absorption coefficient, η(r, n, ν, t) is the emission coefficient, and c is the speed of light. Although the above quantities depend on time, the current version of IRIS solves the time-independent RTE, for a given hydrodynamics structure at a given instant, i.e., for a given snapshot. In other words, we consider regimes in which the photon free-flight time is small compared to the fluid flow dynamical timescales, so that the radiation field gets fully stabilized before any change occurs in the flow dynamical properties. We assume that the typical flow velocities of the hydrodynamic structures are non relativistic.</p><p>As is customary, we introduce the source function,</p><formula xml:id="formula_0">S (r, n, ν, t) = η(r, n, ν, t) χ(r, n, ν, t)<label>(2)</label></formula><p>To simplify the notations, we drop the explicit dependence of radiative quantities on the position, direction and time, and denote the dependence on frequency with a subscript ν. The transfer equation <ref type="formula">(1)</ref> becomes</p><formula xml:id="formula_1">∂I ν ∂s = χ ν (S ν − I ν ) ,<label>(3)</label></formula><p>where s is the path length along the ray in the direction of propagation of the radiation. The choice of a numerical method depends on the purpose of the simulation. If one is interested only in computing emergent specific intensity from a 3D computational box, and if the opacity and the source function are fully known within the box (the so-called "formal solution"), one can select a number of rays (photon paths) that emerge from the box and cross the whole extent of the box, and then solve the radiative transfer equation along such rays. Obviously, a ray does not generally go through the original grid points. One can choose any discretization of the ray, and then obtain needed values of the opacity and source function at the discretized positions by a three-dimensional interpolation. A more efficient way is to discretize the ray by taking its intersections with the individual planes defined by the grid points; in this case one deals with two-dimensional interpolations.</p><p>The problem is thus reduced to a set of 1D problems. Any method capable of solving the transfer equation along a ray can be used here; most popular in the astrophysical applications being the Feautrier method, its 2nd order variant <ref type="bibr" target="#b20">(Feautrier 1964)</ref> or the 4-th order variant <ref type="bibr" target="#b0">(Auer 1976)</ref>; the Discontinuous Finite Element method <ref type="bibr" target="#b13">(Castor et al. 1992</ref>); or the "1D shortcharacteristics" method <ref type="bibr" target="#b50">(Olson &amp; Kunasz 1987)</ref>. All these methods are called the "long-characteristics" scheme in some specific situations. However, the terminology is not used consistently; some studies use this term in a more restricted meaning, namely for using a 1D short-characteristics scheme for solving the transport for a set of rays passing through the whole computational region.</p><p>The situation is different when the source function is not known a priori within the computational box. The simplest situation of this sort arises when the opacity is specified in the computational domain and one can even assume LTE, but the continuum scattering is taken into account. Another case is a general non-LTE situation where line scattering also is important. The most complex situation is when dealing with the true radiation hydrodynamics, where one has to pass the values of radiation moments at all grid points to the hydrodynamics part of the code.</p><p>Even in the simplest case of LTE with electron (Thomson) scattering, the total source function depends on the mean intensity of radiation, and therefore has to be determined iteratively. The essential point is, however, that even if we are interested only in the emergent radiation, we have to determine the total source function, and therefore the specific intensities, in all grid points to be able to interpolate it into the discretized positions along the rays.</p><p>Although the long-characteristics scheme is useful for some purposes, such as allowing for an efficient parallel scheme within domain decomposition ( <ref type="bibr" target="#b32">Heinemann et al. 2006</ref>), we chose the short-characteristics scheme. The classical setup of the longcharacteristics method is to pass a ray through each grid point through the whole computational box, in which case the number of necessary operations is obtained as follows. Let us assume that the computational box is discretized using N points in each direction, so that there are N 3 grid points (and also ≈ N 3 elementary cells). A long-characteristics scheme would consider N 3 rays. Solving the transfer equation along one ray, for one direction and one frequency, would require O(N) operations, an exact value depending on how exactly are the necessary interpolations performed, assuming that they require O(1) operations. For one direction and one frequency one thus needs O(N 4 ) operations. In contrast, the short-characteristics scheme solves the transfer equation within one cell only, and therefore the total number of operations is proportional to the number of cells, that is O(N 3 ) operations.</p><p>To avoid confusion, we mention that when using the longcharacteristics scheme for obtaining an emergent intensity only, it requires also O(N 3 ) operations, because we have N 2 rays; each going through one grid point on the boundary plane that faces an "observer", and a transfer solution along each ray requires O(N) operations. In this particular case, the scaling of the computer time is the same as for the short-characteristics scheme. In some cases, the use of long-characteristics scheme may even be more computationally advantageous than the shortcharacteristics, and therefore some codes (e.g., ASSeT, SCATE) use the short-characteristics scheme when dealing iteratively with scattering, and use the long-characteristics scheme to evaluate the emergent intensity for the final converged model. We note that there are several possible numerical methods that propagate an information form one edge of the cell to another, whose numbers of operations also scale as the number of cells, O(N 3 ). In astrophysics, the vast majority of approaches is based on the short-characteristics scheme, and this is what we adopt in this paper as well. In this paper we assume LTE and no scattering. In this case, the absorption coefficient χ ν is a function of the local mass density ρ and the local temperature T , and the source function S ν is equal to the local Planck function B ν (T ). With these two assumptions (LTE and no scattering), we could have adopted the long-characteristics method as well, but in view of our intended future development of the solver to treat scattering and non-LTE situations, the short-characteristic scheme is clearly the appropriate choice.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">3D Short-Characteristics</head><p>In the context of astrophysical radiative transfer, the method was first used by <ref type="bibr" target="#b46">Mihalas et al. (1978)</ref>, and later by <ref type="bibr" target="#b50">(Olson &amp; Kunasz 1987;</ref><ref type="bibr" target="#b39">Kunasz &amp; Auer 1988;</ref><ref type="bibr" target="#b40">Kunasz &amp; Olson 1988)</ref>, and subsequently in many studies -see references below.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">Overview of the Method</head><p>Let us consider, at time t, the radiation propagating in direction n. The optical depth from position r to position r + sn, where s is the path length between these two positions, is:</p><formula xml:id="formula_2">τ(r, r + sn, ν, t) = s 0 χ(r + s ′ n, n, ν, t) ds ′<label>(4)</label></formula><p>For a radiation propagating from an upwind position r u to a current position r c , the integral form of the formal solution of the time-independent RTE is:</p><formula xml:id="formula_3">I c = I u e −τ uc + τ uc 0 S (τ)e −(τ uc −τ) dτ ,<label>(5)</label></formula><p>where I c =I (r c , n, ν, t), I u =I (r u , n, ν, t), n is the unit vector along the straight line (r u , r c ), τ is the optical depth from r u to an intermediate position r u + sn, with 0 s r c − r u , and τ uc is the optical depth from r u to r c . We consider a three-dimensional Cartesian grid (see <ref type="figure">Figure 1</ref>) defined in the (O, x, y, z) coordinate system with the unit vectors (e x , e y , e z ). The grid cells are rectangular boxes with irregular spacing in each direction. The sizes of the cells in each direction depend on the position in this direction: ∆x cell (x), ∆y cell (y), and ∆z cell (z). The state parameters, i.e., the mass density, the temperature, and the velocity components in the observer's frame, are defined at each grid point. They are provided by the (radiation)(magneto)hydrodynamics (RMHD) simulations. A direction of propagation of the radiation, defined by the unit vector n, is specified by the polar angle θ between n and the unit vector e z , and by the azimuthal angle ϕ, between e x and the projection of n on the x − y plane. In order to span the whole 4π sr angular domain, we impose θ ∈ [0, π] and ϕ ∈ [0, 2π[. The task is to calculate the specific intensity I c in a current point M c in direction n. M c is defined by the intersection of the cells marked with indices i, i+1 in x-direction, j, j+1 in y-direction, and k, k+1 in z-direction (see <ref type="figure">Fig. 1</ref>). This is accomplished by using Equation <ref type="bibr">(5)</ref>. Following the propagation of the ray that goes through M c in direction n, we define a shortcharacteristic by the line joining the intersection of the ray with the upwind cell, M u , to the current point M c (the upwind cell is defined by the indices (i, j, k) in <ref type="figure">Fig. 1</ref>). I c can be determined if we know the following quantities: the upwind specific intensity I u , the source function S (r, n, ν, t) and the absorption coefficient χ(r, n, ν, t) (in order to deduct the optical depths τ and τ uc ) along the short-characteristic from M u to M c . However, S and χ are specified only in the vertices of the cells (grid points). Therefore, we are essentially free to define laws of variation of these quantities along the short-characteristic, typically as low-order polynomials; we choose third degree polynomials. To do so, we need to know (S , χ) in the upwind end point M u , (S u , χ u ), and in the downwind end point M d , (S d , χ d ). M d is the intersection of the short-characteristic with the downwind cell, which is defined by the indices (i + 1, j + 1, k + 1) in <ref type="figure">Fig. 1</ref>. We also choose third degree polynomials to get the upwind quantities (I u , S u , χ u ) and the downwind quantities (S d , χ d ), through interpolations from the values in the neighboring grid points. Further, in Section 4, we describe and discuss in detail the discretization of Equation <ref type="formula" target="#formula_3">(5)</ref>, and the mathematical form of the third degree polynomials. <ref type="figure">Fig. 1</ref>. Short-characteristics method illustrated with an example of a 3D irregularly spaced Cartesian grid. We consider all quantities in the observer's frame. They are defined in the vertices of the cells (grid points). <ref type="bibr">(O, x, y, z)</ref> is an example of a coordinate system with the unit vectors (e x , e y , e z ). The specific intensity is calculated in the current point M c , for a radiation propagating from the upwind end point M u to the downwind end point M d . The direction n of the ray is defined by the polar angle θ and the azimuthal angle ϕ. The short-characteristic is defined by the line joining M u and M c . The transfer equation is solved in its integral form along this short-characteristic. The cells around point M c are marked with the following indices: i, i+1 in x-direction, j, j+1 in y-direction, and k, k+1 in z-direction.</p><formula xml:id="formula_4">k +1 θ i i +1 ϕ M u M c j j +1 k (downwind) (upwind) M d x y z O n e x e e y e z e</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.">Intersections of a Short-Characteristic with the Neighboring Cell Faces</head><p>The coordinates of the intersections of a short-characteristic with the neighboring cell faces, i.e., the coordinates of the upwind end point M u and the downwind end point M d , are easily determined in the local coordinate system defined by (M c , e x , e y , e z ) (see <ref type="figure">Fig.1</ref>). <ref type="figure" target="#fig_0">Figure 2</ref> displays the upwind cell (top panel) and the downwind cell (bottom panel), as they are defined for the shortcharacteristic plotted in <ref type="figure">Fig. 1</ref>. In this example, the upwind cell is determined by indices (i, j, k), while the downwind cell is determined by indices (i+1, j+1, k+1). Let us refer to f x (respectively f y , f z ) as the generic name of a cell face that is perpendicular to x-axis (respectively y-axis, z-axis), and that may be intersected by a short-characteristic, i.e., to which M u or M d may belong. In our example, f x in the upwind cell is specified by x = −∆x i , while f x in the downwind cell is specified by x = ∆x i+1 , both in the local coordinate system. In the same vein, f y is y = −∆y j in the upwind cell, and y = ∆y j+1 in the downwind cell. Finally, f z is z = −∆z k in the upwind cell, and z = ∆z k+1 in the downwind cell.</p><p>In the example displayed in <ref type="figure" target="#fig_0">Fig. 1 and 2</ref>, M u belongs to the face f z : z = −∆z k , and M d belongs to the face f z : z = ∆z k+1 . However, depending on the values of (θ, ϕ), M u may belong to f y : y = −∆y j , or to f x : x = −∆x i , and M d may belong to f y : y = ∆y j+1 , or to f x : x = ∆x i+1 . In addition, the upwind cell and the downwind cell are respectively (i, j, k) and the generic names for the size in x-direction of, respectively, the upwind and the downwind cell, for a given current point M c and a given direction (θ, ϕ). Similarly, let us introduce the analogous notations ∆y u , ∆y d and ∆z u , ∆z d for the corresponding sizes in y and z directions. <ref type="table">Table 1</ref> indicates, for each of the eight octants, the corresponding range of (θ, ϕ), the indices of the upwind cell, along with the values of ∆x u , ∆y u , ∆z u , for any current grid point M c . <ref type="table">Table 2</ref> indicates the equivalent quantities for the downwind cell.</p><formula xml:id="formula_5">(i + 1, j + 1, k + 1) only for (θ, ϕ) ∈ [0, π/2[×[0, π/2[,</formula><p>The following generic inequalities identify the cell face to which an upwind (respectively downwind) end point belongs:</p><formula xml:id="formula_6">M u(d) ∈ f x ⇔ | tan ϕ| &lt; ∆y u(d) ∆x u(d) , | tan θ cos ϕ| ≥ ∆x u(d) ∆z u(d) (6a) M u(d) ∈ f y ⇔ | tan ϕ| ≥ ∆y u(d) ∆x u(d) , | tan θ sin ϕ| ≥ ∆y u(d) ∆z u(d) (6b) M u(d) ∈ f z ⇔ | tan θ cos ϕ| &lt; ∆x u(d) ∆z u(d) , | tan θ sin ϕ| &lt; ∆y u(d) ∆z u(d) (6c)</formula><p>The local coordinates of the upwind (respectively downwind) end point M u(d) depend on the face it belongs to, as follows:</p><formula xml:id="formula_7">M u(d) ∈ f x :            x u(d) = α xu(d) ∆x u(d) y u(d) = α xu(d) ∆x u(d) tan ϕ z u(d) = α xu(d) ∆x u(d) tan θ cos ϕ (7a) M u(d) ∈ f y :              x u(d) = α yu(d) ∆y u(d) tan ϕ y u(d) = α yu(d) ∆y u(d) z u(d) = α yu(d) ∆y u(d) tan θ sin ϕ (7b) M u(d) ∈ f z :            x u(d) = α zu(d) ∆z u(d) tan θ cos ϕ y u(d) = α zu(d) ∆z u(d) tan θ sin ϕ z u(d) = α zu(d) ∆z u(d) ,<label>(7c)</label></formula><p>where the factors (</p><formula xml:id="formula_8">α xu(d) , α yu(d) , α zu(d) )</formula><p>, are equal to ±1, depending on the octant to which the direction n belongs, as detailed in <ref type="table">Tables 1 and 2</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Piecewise Cubic, Locally Monotonic, Interpolation</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">The Advantages of a Piecewise, Locally Monotonic, Interpolant</head><p>As mentioned in Section 3.1, solving the integral form of the radiative transfer equation with the short-characteristics method requires to define laws of variation of physical quantities within faces of the grid and along the short-characteristics. The linear law is the simplest and fastest method. However, it leads to large numerical diffusion. This means that a sharp beam is significantly dispersed as it propagates throughout a grid, which was discussed in detail by several authors ( <ref type="bibr" target="#b39">Kunasz &amp; Auer 1988;</ref><ref type="bibr" target="#b30">Hayek et al. 2010;</ref><ref type="bibr" target="#b17">Davis et al. 2012</ref>). Moreover, a second or higher order polynomial is mandatory, in order to recover the diffusion approximation at large optical depth. A parabolic law, however, generates overshoots that may be negative and thus unphysical. This point was discussed in detail by <ref type="bibr" target="#b39">Kunasz &amp; Auer (1988)</ref> and <ref type="bibr" target="#b3">Auer &amp; Paletou (1994)</ref>. An efficient method to overcome this difficulty is to use in each direction (x, y, z and the short-characteristic's direction) a piecewise continuous, locally monotonic, interpolation function, as proposed by <ref type="bibr" target="#b1">Auer (2003)</ref>. The monotonicity suppresses any spurious extrema. Hereafter, we describe the method that we have adopted.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2.">Cubic Hermite Polynomial and Weighted Harmonic Mean Node Derivative</head><p>Let us consider a physical quantity that depends on only one variable, w(x), and which is specified only in a set of m discrete</p><formula xml:id="formula_9">x i w i w i+1 H i x ( ) ′ w i ′ w i+1 x i+1 Fig. 3. Piecewise interpolation. w(x)</formula><p>is the function to be interpolated between the end points (or nodes) x i and x i+1 . We assume that we know w and its derivatives at the end points:</p><formula xml:id="formula_10">w i = w(x i ), w i+1 = w(x i+1 ), w ′ i = w ′ (x i ), w ′ i+1 = w ′ (x i+1 ). The local interpolation function, H i (x)</formula><p>, is a cubic Hermite polynomial. It is a third degree polynomial defined between x i and x i+1 , from the four relations:</p><formula xml:id="formula_11">H (x i ) = w i , H (x i+1 ) = w i+1 , H ′ (x i ) = w ′ i , H ′ (x i+1 ) = w ′ i+1 .</formula><p>The arrows indicate the slopes of H(x) at the end points, or, equivalently, the derivatives w ′ i , w ′ i+1 . See Section 4.2 for detailed explanations.</p><p>positions or nodes (x i ) i=1,n , with 0 x 1 &lt; x 2 &lt; ... &lt; x n . In other words, w i = w(x i ) for i = 1, 2, ..., n are given. Our objective is to find an interpolation function that goes through all the data points (x i , w i ) and that preserves the monotonicity of the data. A solution to this problem is provided by a piecewise cubic Hermite polynomial coupled with a weighted harmonic mean defining the derivative at each node, w ′ i = w ′ (x i ). We detail this solution hereafter.</p><p>Among the nodes above, let us choose two consecutive ones, x i and x i+1 (see <ref type="figure">Figure 3</ref>). Within the interval [x i , x i+1 ], a cubic Hermite polynomial is defined as (see equation <ref type="formula" target="#formula_0">(2)</ref> of <ref type="formula" target="#formula_0">Auer  2003)</ref>:</p><formula xml:id="formula_12">H i (x) = 1 − 3q 2 i + 2q 3 i w i + 3q 2 i − 2q 3 i w i+1 + q 3 i − 2q 2 i + q i (x i+1 − x i ) w ′ i + q 3 i − q 2 i (x i+1 − x i ) w ′ i+1 ,<label>(8)</label></formula><p>where</p><formula xml:id="formula_13">q i (x) = x − x i x i+1 − x i , 0 q i (x) 1 (9)</formula><p>By definition, the Hermite polynomial matches the interpolated function w(x) and its derivatives at both ends of the interval:</p><formula xml:id="formula_14">H i (x i ) = w i H i (x i+1 ) = w i+1 (10a) H ′ i (x i ) = w ′ i H ′ i (x i+1 ) = w ′ i+1 (10b)</formula><p>The derivative at an inner node, (w ′ i ) i=2,n−1 , is defined by the weighted harmonic mean suggested by <ref type="bibr" target="#b6">Brodlie (1980)</ref> and <ref type="table">Table 1</ref>. Correspondence between octant, directional angles (θ, ϕ), upwind cell indices, sizes of the upwind cell faces in each direction, and (α xu , α yu , α zu ) factors. (See Sections 3.1 and 3.2 for the definitions of these quantities.)</p><formula xml:id="formula_15">Octant (θ, ϕ) (radians) Upwind cell Face f x Face f y Face f z (α xu , α yu , α zu ) indices ∆x u ∆y u ∆z u 1 [0, π 2 [×[0, π 2 [ (i, j, k) | − ∆x i | | − ∆y j | | − ∆z k | (−1, −1, −1) 2 [0, π 2 [×[ π 2 , π[ (i + 1, j, k) ∆x i+1 | − ∆y j | | − ∆z k | (+1, −1, −1) 3 [0, π 2 [×[π, 3π 2 [ (i + 1, j + 1, k) ∆x i+1 ∆y j+1 | − ∆z k | (+1, +1, −1) 4 [0, π 2 [×[ 3π 2 , 2π[ (i, j + 1, k) | − ∆x i | ∆y j+1 | − ∆z k | (−1, +1, −1) 5 [ π 2 , π[×[0, π 2 [ (i, j, k + 1) | − ∆x i | | − ∆y j | ∆z k+1 (−1, −1, +1) 6 [ π 2 , π[×[ π 2 , π[ (i + 1, j, k + 1) ∆x i+1 | − ∆y j | ∆z k+1 (+1, −1, +1) 7 [ π 2 , π[×[π, 3π 2 [ (i + 1, j + 1, k + 1) ∆x i+1 ∆y j+1 ∆z k+1 (+1, +1, +1) 8 [ π 2 , π[×[ 3π 2 , 2π[ (i, j + 1, k + 1) | − ∆x i | ∆y j+1 ∆z k+1 (−1, +1, +1)</formula><p>Notes. We intentionally use the absolute value notations above, in order to emphasize the coordinates, in the local coordinate system, of the upwind cell faces that may be intersected by a short-characteristic. For example, for octant 1, the x-coordinate of f x is x = −∆x i . <ref type="table">Table 2</ref>. Same as <ref type="table">Table 1</ref>, but for the downwind cell faces.</p><formula xml:id="formula_16">Octant (θ, ϕ) (radians) Downwind cell Face f x Face f y Face f z (α zd , α xd , α yd ) indices ∆x d ∆y d ∆z d 1 [0, π 2 [×[0, π 2 [ (i + 1, j + 1, k + 1) ∆x i+1 ∆y j+1 ∆z k+1 (+1, +1, +1) 2 [0, π 2 [×[ π 2 , π[ (i, j + 1, k + 1) | − ∆x i | ∆y j+1 ∆z k+1 (−1, +1, +1) 3 [0, π 2 [×[π, 3π 2 [ (i, j, k + 1) | − ∆x i | | − ∆y j | ∆z k+1 (−1, −1, +1) 4 [0, π 2 [×[ 3π 2 , 2π[ (i + 1, j, k + 1) ∆x i+1 | − ∆y j | ∆z k+1 (+1, −1, +1) 5 [ π 2 , π[×[0, π 2 [ (i + 1, j + 1, k) ∆x i+1 ∆y j+1 | − ∆z k | (+1, +1, −1) 6 [ π 2 , π[×[ π 2 , π[ (i, j + 1, k) | − ∆x i | ∆y j+1 | − ∆z k | (−1, +1, −1) 7 [ π 2 , π[×[π, 3π 2 [ (i, j, k) | − ∆x i | | − ∆y j | | − ∆z k | (−1, −1, −1) 8 [ π 2 , π[×[ 3π 2 , 2π[ (i + 1, j, k) ∆x i+1 | − ∆y j | | − ∆z k | (+1, −1, −1)</formula><p>Fritsch &amp; Butland <ref type="bibr">(1984)</ref>, and brought to the attention of the astrophysics community by <ref type="bibr" target="#b1">Auer (2003)</ref>:</p><formula xml:id="formula_17">w ′ i =            f ′ i−1 f ′ i (1 − α i ) f ′ i−1 + α i f ′ i if f ′ i−1 f ′ i &gt; 0, 0 if f ′ i−1 f ′ i 0,<label>(11a)</label></formula><p>where</p><formula xml:id="formula_18">f ′ i = w i+1 − w i x i+1 − x i (11b) α i = 1 3 1 + x i+1 − x i x i+1 − x i−1 (11c)</formula><p>The derivatives at the outer nodes, w ′ 1 and w ′ n , are defined by the local slopes:</p><formula xml:id="formula_19">w ′ 1 = w 2 − w 1 x 2 − x 1 (12a) w ′ n = w n − w n−1 x n − x n−1<label>(12b)</label></formula><p>Adopting this definition of the node derivatives, each local cubic Hermite interpolant (H i (x)) i=1,n−1 is monotonic in the interpolation interval <ref type="bibr">[x i , x i+1</ref> ]. More precisely, the sign of H i (x), for x ∈]x i , x i+1 [, is equal to the sign of f ′ i . Therefore, spurious extrema never occur, which guarantees the positivity of the interpolated physical quantities. Let us note H(x) the piecewise interpolation function defined over the whole interval <ref type="bibr">[x 1 , x</ref> </p><formula xml:id="formula_20">n ] = n−1 i=1 [x i , x i+1 ], so that its restriction to each interval [x i , x i+1 ] is equal the local function H i (x). H(x) is continuous. Moreover, it</formula><p>is easy to demonstrate that its derivative H ′ (x) is also continuous throughout the whole interval [x 1 , x n ], specifically at each inner node (x i ) i=2,n−1 .</p><p>In addition to the Hermite interpolation, Auer (2003) suggests a second possibility: using a Bézier polynomial as a local interpolant. The latter is quite close to a Hermite polynomial. Both functions match the local end point values w i , w i+1 . However, while the Hermite polynomial matches the end point derivatives w ′ i , w ′ i+1 , the Bézier polynomial does not do it necessarily. The reason is as follows. Let us note B i (x) the local Bézier polynomial defined in <ref type="bibr">[x i , x i+1</ref> ]. B i (x), and, therefore, its derivative B ′ i (x), depend on free parameters, called "control values" <ref type="bibr" target="#b1">(Auer 2003)</ref>. These values can be adjusted in order to control the variation of B i (x) in the vicinity of the end points. In particular, they can be restrained within a minimum value and a maximum value (see equation (11) of Auer 2003), in order to guarantee the monotonicity of B i (x). In this case, the continuity of the derivative B ′ (x) of the piecewise interpolant B(x), which is defined over [x 1 , x n ] similarly to H(x), is not necessarily verified at the nodes. In short, whatever the definition of the node derivatives of w(x), (w ′ i ) i=1,n , a piecewise Hermite interpolation function, H(x), guarantees that H ′ (x) matches these node derivatives and that H ′ (x) is continuous at the nodes. On the other hand, a piecewise Bézier interpolation function B(x), along with an adequate choice of the control values, guarantees to be locally monotonic, but B ′ (x) does not necessarily match the node derivatives and is not necessarily continuous at the nodes. Now, if we adopt very specific control values (see equation <ref type="formula">(9)</ref> of Auer 2003 in the cubic case), we can force the Bezier polynomial to be identical to the Hermite polynomial. And, as we discussed in the paragraph above, with an adequate choice of the definition of the nodes derivatives (w ′ i ) i=1,n (Equations 11 and 12), a piecewise Hermite interpolation function can be made locally monotonic.</p><p>Finally, let us mention another possible definition of the node derivatives w ′ i , that ensures the monotonicity of a Hermite polynomial. <ref type="bibr">Steffen (1990)</ref> suggests to calculate the slope at inner node (x i ) i=2,n−1 from the unique parabola passing through the points (</p><formula xml:id="formula_21">x i−1 , w i−1 ; x i , w i ; x i+1 , w i+1 ), if this parabola is monotonic in [x i−1 , x i+1 ].</formula><p>If not, the node derivative is defined as the common slope shared by two parabolas, which are locally monotonic in <ref type="bibr">[x i−1 , x i ]</ref> and <ref type="bibr">[x i , x i+1</ref> ]. Specific definitions are proposed for the outer nodes derivatives w ′ 1 and w ′ n . Although this possibility suggested by <ref type="bibr">Steffen (1990)</ref> satisfies our requirements of monotonicity, we did not implement it in IRIS, because the calculation of such a derivative, for a given node, uses a larger cpu time than the calculation with the weighted harmonic mean formula (Equation (11a) in this paper may be compared to equation <ref type="formula">(11)</ref> of Steffen 1990).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Implementation</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1.">Interpolations in Cell Faces, Ghost Nodes</head><p>For each direction of propagation of the radiation, we apply the 3D short-characteristics method, which consists in solving the integral form of the RTE, Equation (5), throughout the 3D Cartesian grid points. We repeat this procedure for all the directions specified over a solid angle. The method that we employ for propagating the radiation gives a privileged role to z-axis, in the sense that we are sweeping the 3D grid gradually, z-plane by z-plane, in the direction of increasing (or decreasing) z. In an astrophysical context, z-axis should represent a global direction of the energy transport in an object; that is the direction from the interior to the outer layers of a stellar or a planetary atmosphere, the vertical distance from an accretion disk plane, or the direction of an accretion column in a young stellar object.</p><p>Boundary conditions must be defined in appropriate planes, which depend on the direction of propagation of the radiation. Assuming that the grid is defined by N x cells in x-direction, N y cells in y-direction, and N z cells in z-direction, the positions of the grid nodes in each direction may be noted as (x 0 , x 1 , ..., x N x ), (y 0 , y 1 , ..., y N y ), and (z 0 , z 1 , ..., z N z ). The sizes of the cells in each direction are then noted (∆x 1 , ..., ∆x N x ), (∆y 1 , ..., ∆y N y ), and (∆z 1 , ..., ∆z N z ), and they are defined by:</p><formula xml:id="formula_22">           ∆x i = x i − x i−1 ∆y j = y j − y j−1 ∆z k = z k − y k−1<label>(13)</label></formula><p>In agreement with our notations in <ref type="figure">Fig. 1</ref>, a propagation in the first octant corresponds to directional angles (θ, ϕ) ∈ [0, π/2[×[0, π/2[, and, therefore, to a propagation along increasing x, increasing y, and increasing z. Consequently, the boundary specific intensities must be known at the bottom frontiers of the 3D Cartesian grid, defined by the following planes x = x 0 , y = y 0 , z = z 0 .</p><p>As explained in Section 3.1, calculating the formal solution of the monochromatic RTE in its integral form, at a given grid point and for a given direction of propagation of the radiation, requires the determination of (I u , S u , χ u ) at the intersection of the short-characteristic with the upwind face, and (S d , χ d ) at the intersection of the short-characteristic with the downwind face.</p><p>The opacities χ are known at each point of the threedimensional grid. And, by definition of a formal solution, the source function S is known at each grid point. Then, S u , χ u , (respectively S d , χ d ) are determined by successive cubic monotonic interpolations in each of the two directions of a given upwind (respectively downwind) horizontal of vertical face. The top panel of <ref type="figure">Figure 4</ref> provides an illustration of a sequence of interpolations in a horizontal upwind cell face. This example corresponds to the case shown in the top panel of <ref type="figure" target="#fig_0">Fig. 2</ref>. The upwind face is identified by indices i and j and belongs to the plane defined by f z : z = −∆z k in the local coordinate system (see Section 3.2). The ray propagates in the first octant, i.e., along increasing x, y, and z. The black dots indicate the grid points. M u is the upwind end point. M ⊥ c is the projection of the current point M c on f z , and coincides with a grid point. Quantities defined in the grid points are interpolated in y-direction at the y u position of M u . Then, the interpolated values, in positions A i−2 , A i−1 , A i , A i+1 , are themselves interpolated in x-direction at the x u position of M u , which provides the upwind quantity S u , χ u . The curved arrows indicate the grid points which contribute to the interpolations. Four points are necessary to accomplish each interpolation (see Section 4.2 along with Equations <ref type="formula" target="#formula_12">(8)</ref> and <ref type="formula">(11)</ref>).</p><p>Unlike opacities and source functions, the upwind specific intensity is not always known in all the grid points neighboring the upwind cell face. The sweeping procedure throughout the 3D Cartesian grid is made z-plane by z-plane, as described above in the first paragraph of this section. Therefore, for each new z-plane to be processed, the specific intensity is known at each grid point of the upwind z-plane. Accordingly, the procedure described above for S and χ works if M u belongs to a horizontal face. However, the specific intensity is not known at all grid points of a preceding vertical plane ( f x : x = ±∆x i , or f y : y = ±∆y j , in the local coordinate system), except if it is a boundary plane. The bottom panel of <ref type="figure">Fig. 4</ref> provides an example of a sequence of interpolations of the specific intensity in a vertical upwind cell face. In this case, z = z k is the current z-plane, z = z k−1 is the upwind one. M u belongs to the vertical face identified by indices j and k, and by f x : x = −∆x i . We still consider a ray propagating in the first octant (increasing x, y, z). The specific intensity is fully known in the preceding z = z k−2 and z = z k−1 planes, where we can perform interpolations in ydirection at the y u position of M u . This provides the values of the specific intensity in points A k−2 and A k−1 . The crosses indicate the grid points in which the specific intensity is not known. Since the sweeping follows the direction of propagation of the ray, it is performed along increasing y, in the z = z k plane. Therefore, the specific intensity is known in the three consecutive grid points ((y j−2 , z k ), (y j−1 , z k ), (y j , z k )), but not in (y j+1 , z k ). It is also not known in the z = z k+1 plane (except in y = y j−2 if this y-plane is a boundary). Consequently, we can determine the specific intensity in point A k in z = z k plane, with a cubic Hermite interpolation in y-direction, using the values in ((y j−2 , z k ), (y j−1 , z k ), (y j , z k )). Finally, the interpolated values in A k−2 , A k−1 , A k are themselves interpolated in z-direction at the z u position of M u , which provides the upwind specific intensity I u . For the last two interpolations, since we know the intensities in only three grid points, the derivatives of the cubic Hermite polynomials in the edge points, M ⊥ c in y-direction and A k in z-direction, are provided by the local slopes as defined in <ref type="bibr">Equations (12)</ref>.</p><p>We have added at each boundary of each of the three x, y, z dimensions, two layers of ghost nodes that embed the initial 3D Cartesian grid. These ghost nodes are necessary if we want to apply the above interpolation procedure uniformly to all the grid points, which spares us from testing whether the grid points are close to the boundaries or not. In x-direction, for example, and for a propagation in increasing x, ghost nodes are required for determining the upwind quantities at x 1 , and for determining the downwind quantities at x N x −1 and x N x . The ghost nodes (x −2 , x −1 ) and (x N x+1 , x N x+2 ) are added. Their positions per se do not matter, as we define in these nodes positive linear extrapolations of the state parameters. Then, it is easy to show that we can still use the cubic Hermite polynomial interpolants in x 1 , x N x −1 and x N x , and that the derivatives in these nodes, even though calculated with the weighted harmonic mean, are equal to the local slopes defined by Equations (12).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.">The Discretized Integrated RTE along a Short-Characteristic</head><p>In the preceding subsection, we have described our procedure to determine the upwind quantities (I u , S u , χ u ), and the downwind quantities (S d , χ d ). Once we know them, we are in a position to calculate the integral form of the RTE, Equation (5).</p><p>To do so, we define laws of variation, along the shortcharacteristics, of the source function and the opacity. We use a monotonic cubic Hermite polynomial between the upwind endpoint M u and the current grid point M c (see <ref type="figure">Fig. 1</ref> , are calculated with the weighted harmonic mean, Equation (11). Then, the RTE (Equation <ref type="formula" target="#formula_3">(5)</ref>) can be integrated analytically. We obtain the following expression:</p><formula xml:id="formula_23">I c = I u e −τ uc + αS u + βS c + α ′ dS dτ u + β ′ dS dτ c<label>(14a)</label></formula><p>where</p><formula xml:id="formula_24">α = 1 τ 3 uc {6 (τ uc − 2) + [−τ 3 uc + 6 (τ uc + 2)]e −τ uc } (14b) β = 1 τ 3 uc {[τ 3 uc − 6 (τ uc − 2)] − 6 (τ uc + 2) e −τ uc } (14c) α ′ = 1 τ 2 uc {(2τ uc − 6) + τ 2 uc + 4τ uc + 6 e −τ uc } (14d) β ′ = 1 τ 2 uc { −τ 2 uc + 4τ uc − 6 + (2τ uc + 6) e −τ uc }<label>(14e)</label></formula><p>The optical depth τ uc is calculated by integrating analytically Equation (4) from M u to M c . We obtain: face f x : <ref type="figure">Fig. 4</ref>. Examples of cubic monotonic interpolations in cell faces intersected by a short-characteristic, for a ray propagating in the first octant, i.e., along increasing x, y, and z. Two configurations are possible. The first one is displayed in the top panel, where all the quantities are known in the grid points neighboring the cell face. This situation always occurs for the upwind and downwind source functions and opacities (S u , χ u ), (S d , χ d ). But, for the upwind specific intensity I u , it occurs only when horizontal faces f z : z = ±∆z k or boundary faces are intersected. The second configuration is displayed in the bottom panel. It impacts the determination of I u when vertical non-boundary faces, f x : x = ±∆x i or f y : y = ±∆y j , are intersected. In this case, the upwind specific intensity is not known in all the grid points neighboring the cell face. See Section 5.1 for detailed explanations.</p><formula xml:id="formula_25">τ uc = 1 2 s uc (χ u + χ c ) + 1</formula><formula xml:id="formula_26">x = −∆x i A k-1 A k-2 A k</formula><p>where s uc is the path length from M u to M c . When τ uc is small enough ( 5 ×10 −2 ), we use Taylor expansions up to the third order of Equations <ref type="formula" target="#formula_2">(14)</ref>. The bottom line is that the RTE can always be calculated, including the two asymptotic limits: the optically thin or even transparent path for which τ uc equals zero, and, therefore, I c −→ I u , and the optically thick or even opaque path for which τ uc tends to infinity, and, therefore, I c −→ S c .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3.">The Velocity Gradient Effect (Doppler shift)</head><p>We consider a medium with a non-zero macroscopic velocity with respect to the observer's frame. In this case, the velocity gradient between two positions in the medium causes a Doppler shift of photon frequencies, and therefore a shift of the corresponding spectral lines. This effect must be properly taken into account in an implementation of the short-characteristics method. If the velocity difference between the current point M c and the upwind end point M u (see <ref type="figure">Fig. 1</ref>) is large enough, then a simple interpolation scheme may underestimate or overestimate opacities.</p><p>To illustrate this point, let us consider a single emission line and a given frequency at which we solve the RTE. The following situation may happen. At M u , the frequency is located at a wing of the line, quite far from the center of the line, such that the absorption coefficient is very small compared to the line center value. And, at M c , the line is shifted, such that this same frequency is at the opposite side of the line, in the other wing, far from the center. The law of variation then infers a very weak opacity for this line throughout the path from M u to M c . In fact, the line goes through its maximum value at this frequency, somewhere between M u and M c , and this is not taken into account. This issue was pointed out by van <ref type="bibr" target="#b59">Noort et al. (2002)</ref> who emphasized the fact that the opacity along a short-characteristic may be underestimated by several orders of magnitude. In addition to that example, we provide here a case of overestimation. Let us consider now two lines that are quite distant from each other. We may face the following situation. At M u , the calculation frequency can be located close to the center of one line. And, at M c , due to the shift of the lines, this frequency can be close to the maximum of the second line. Consequently, a variation law defined between M u and M c overestimates the opacity if the two line centers are distant enough, such that we miss the trough between them.</p><p>A common solution of these problems is provided by a subgriding (e.g., van <ref type="bibr" target="#b59">Noort et al. (2002)</ref>). Let v be the macroscopic velocity in the observer's frame, andˆvandˆ andˆv = v · n its projection on the direction of photon propagation n. The idea of subgriding is to subdivide a short-characteristic into a set of subintervals, so that the difference inˆvinˆ inˆv between two points of this subdivision remains small compared to the thermal velocity. In IRIS, we follow this procedure. Specifically, we introduce a dimensionless parameter factor ǫ D that provides to the user a control over the subdivision. Let us identify with indices l and l + 1 two points of the subdivision of a given short-characteristic. Let us consider a single line. We note ν 0 the transition frequency (emission or absorption of a photon) in the particle's frame (or comoving frame). ν 0 coincides with the center of the line in the fluid rest frame where v = 0, but this frequency is shifted to the value ν ctr in the observer's frame where v 0, as follows,</p><formula xml:id="formula_27">ν ctr = ν 0 1 + ˆ v c<label>(16)</label></formula><p>where we consider a Doppler shift of frequencies to first order inˆvinˆ inˆv/c, since we assume the velocities to be non relativistic (see Section 2). ν ctr is the center of the line in the observer's frame. The shift of ν ctr between position l and position l + 1 is given by</p><formula xml:id="formula_28">ν ctr (l + 1) − ν ctr (l) = ν 0 ˆ v(l+1)−ˆ v(l) c<label>(17)</label></formula><p>The Doppler width associated with this line, in a given position in the medium, is</p><formula xml:id="formula_29">∆ν D = ν 0 V th c<label>(18)</label></formula><p>with c being the speed of light, and V th the thermal velocity. The latter is defined as</p><formula xml:id="formula_30">V th = 2 k T m 1/2 (19)</formula><p>where k is the Boltzmann constant, m the mass of the particle. ǫ D is a control parameter defined such that the Doppler shift of the center of the line between position l and position l+1 is bounded as follows:</p><formula xml:id="formula_31">|ν ctr (l + 1) − ν ctr (l)| ǫ D ∆ν D (l) + ∆ν D (l + 1) 2<label>(20)</label></formula><p>The quantity 1 2 [∆ν D (l) + ∆ν D (l + 1)] is an average of the local Doppler width between its value in l position and its value in l + 1 position. It is easy to demonstrate that this inequality is independent of the transition frequency in the particle's frame ν 0 , and that it is equivalent to the following condition on the gradients of the projected velocities:</p><formula xml:id="formula_32">|ˆv|ˆv(l + 1) − ˆ v(l)| ǫ D V th (l) + V th (l + 1) 2 .<label>(21)</label></formula><p>ǫ D is a tunable parameter, whose value depends on the required accuracy of the solution (ideally between 1/3 and 1). The smaller it is, the higher accuracy is achieved; however at the expense of increased computer demands.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Radiation Moments and Angular Integration</head><p>In addition to computing specific intensity, one can calculate important angle-averaged quantities related to radiation moments, such as the mean intensity J(r, ν, t), the radiation flux vector F(r, ν, t), and the radiation pressure tensor P(r, ν, t). These are defined as</p><formula xml:id="formula_33">J(r, ν, t) = 1 4π I(r, n, ν, t) dΩ,<label>(22)</label></formula><formula xml:id="formula_34">F(r, ν, t) = I(r, n, ν, t) n dΩ,<label>(23)</label></formula><formula xml:id="formula_35">P(r, ν, t) = 1 c I(r, n, ν, t) nn dΩ,<label>(24)</label></formula><p>where dΩ is the elementary solid angle, and the symbol designates an integration over 4π sr. The flux vector and the radiation pressure tensor can also be written in component form:</p><formula xml:id="formula_36">F i = I(r, n, ν, t) n i dΩ,<label>(25)</label></formula><formula xml:id="formula_37">P i j = 1 c I(r, n, ν, t) n i n j dΩ,<label>(26)</label></formula><p>In Cartesian coordinates, the three directions (1,2,3) are the unit vectors (e x , e y , e z ) introduced in Section 3.1, and the components of the radiation propagation vector n are</p><formula xml:id="formula_38">           n 1 = n x = n · e x = sin θ cos ϕ n 2 = n y = n · e y = sin θ sin ϕ n 3 = n z = n · e z = cos θ<label>(27)</label></formula><p>IRIS computes each of the three components of the radiation flux vector, F x , F y , F z . Since the radiation pressure tensor is symmetric <ref type="bibr" target="#b46">(Mihalas 1978;</ref><ref type="bibr" target="#b47">Mihalas &amp; Mihalas 1984)</ref>, it is defined by six components, P xx , P yy , P zz , P xy , P xz , P yz , all of them being computed by IRIS. The angular integrations are numerically performed by using quadratures. A quadrature is a set of M discretized direction vectors n m = (n mx , n my , n mz ) and the corresponding weights w m , which are the numerical representation of, respectively, the direction vector n and the elementary solid angle dΩ. An appropriate quadrature for an integration over the whole 4π sr range should satisfy at least the first two of the three following conditions:</p><p>1. symmetry: the directions of the quadrature are invariant after rotation of 90 • around the three coordinate directions (e x , e y , e z ), 2. for an isotropic radiation field, the three moments should be numerically exact. 3. for an isotropic radiation field, the half first moment should be numerically exact. The second condition reads as follows:</p><formula xml:id="formula_39">dΩ = 4π = M m=1 w m , (28a) n dΩ = 0 = M m=1 w m n m , (28b) nn dΩ = 4π 3 δ= M m=1 w m n m n m , (28c)</formula><p>where δ is the unit tensor. The third condition is optional, and is related to the following issue. One may need to calculate a radiative flux over a surface or at a wall. In this case, the flux is determined by an integration over 2π sr, instead of 4π sr:</p><formula xml:id="formula_40">F wall = 2π</formula><p>I n dΩ. The third condition reads then:</p><formula xml:id="formula_41">n·e i &gt;0 n dΩ = − n·e i &lt;0 n dΩ = πe i = n m ·e i &gt;0 w m n m<label>(29)</label></formula><p>where e i stands for e x , e y , or e z , and where we consider surfaces or walls perpendicular to one of these three directions. We have implemented in IRIS the quadratures of type A proposed by <ref type="bibr" target="#b9">Carlson (1963)</ref>, and whose construction principle is summarized by <ref type="bibr" target="#b7">Bruls et al. (1999)</ref>. They satisfy conditions 1 and 2, but not condition 3. We also have implemented the quadratures built by <ref type="bibr" target="#b41">Lathrop &amp; Carlson (1965)</ref>. The latter provide several sets of quadratures that satisfy conditions 1 and 2, but not condition 3, with 24 up to 288 directions. They also provide several sets of another type of quadratures that satisfy the three conditions above, with 24 up to 80 directions.</p><p>We also have implemented the Gaussian quadrature ( <ref type="bibr">Press et al. 1992</ref>). The latter is not appropriate for the calculation of the radiation moments, because it does not satisfy any of the three conditions above and leads to serious non physical asymmetries, unless one chooses a large number of directions (typically, more than 100). However, it is suitable for the integration of the incoming specific intensity over a viewing solid angle, in order to determine the radiative power per unit surface that receives a detector looking at a given object.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.">Periodic Boundary Conditions</head><p>We consider a three-dimensional medium with an infinite extension in the horizontal plane <ref type="bibr">(x, y)</ref>, and a finite extension along the vertical z-axis between its lower boundary z 0 and its upper boundary z N z . We assume that this medium has a double periodicity, one in x-direction, and one in y-direction. The boundary conditions are known at z 0 and z N z . For example, we may consider a non-irradiated stellar atmosphere with no incoming radiation at the outer surface z N z and a black body radiation at its inner surface z 0 . The computational grid ranges from z 0 to z N z in vertical direction, from x 0 to x N x , and from y 0 to y N y in the horizontal plane, so that (x N x − x 0 ) defines one x-period and (y N y −y 0 ) defines one y-period. Now, the 3D short-characteristics method consists in solving the integral form of the RTE by propagating the rays throughout a computational domain, from up to three upwind boundary sides in which the specific intensity is assumed to be known, down up to the three other faces of the domain. For horizontally periodic media, while the vertical boundary conditions are specified explicitly, the lateral boundary conditions are defined implicitly, such that, for any physical quantity f (ν, x, y, z), we have the following relations:</p><formula xml:id="formula_42">f (ν, x N x , y, z) = f (ν, x 0 , y, z), for any y, z, (30a) f (ν, x, y N y , z) = f (ν, x, y 0 , z), for any x, z.<label>(30b)</label></formula><p>Consequently, when the upwind end point of a shortcharacteristic intersects a lateral boundary, we prolong this characteristic, which becomes a long-characteristic, until it intersects a horizontal face, following the suggestions by  and Fabiani <ref type="bibr" target="#b18">Bendicho (2003)</ref>. For a given direction of propagation, and for each z-layer, this treatment affects only the rows that are adjacent to the boundary faces. <ref type="figure">Figure 5</ref> illustrates our point with an example showing a propagation of the radiation in the first octant, i.e., along increasing x, y, and z. Two characteristics are plotted from the current point M c in the plane x = x 1 , which is adjacent to the boundary plane x = x 0 . The upwind end point M u of the short-characteristic (M u , M c , M d ) belongs to a horizontal face. Therefore, the specific intensity can be calculated by interpolations from the values at the neighboring grid points in the upwind horizontal plane. If we consider the short-characteristic</p><formula xml:id="formula_43">(M ′ b , M c , M ′ d )</formula><p>, the upwind end point M ′ b belongs to the horizontal boundary plane x = x 0 , in which the specific intensity is not explicitly defined. The short-characteristic is then lengthened, and becomes a long-characteristic, down to its first intersection, M ′ u , with a horizontal face. The long-characteristic can go through several cells (only one cell in the example, for the clarity of the <ref type="figure">figure)</ref> beyond the vertical boundary face, before hitting a horizontal face.</p><p>When the medium is not periodic, we start the sweeping of a given z-plane at the grid point that is the closest to the vertical boundary planes. For example, if the ray propagates in the first octant, these planes are x = x 0 and y = y 0 , therefore the first grid point in which we calculate the specific intensity is (x 1 , y 1 ). Then, the specific intensity is calculated progressively in all the grid points in the z-plane along x-direction and y-direction. Now, as we consider in this section a medium with a double horizontal periodicity, we can start the sweeping at any grid point in the zplane, provided that the grid points where the specific intensity is calculated span one x-period and one y-period. We mark this starting point as (x i 0 , y j 0 ). The indices i 0 and j 0 are defined so as to minimize the number of cells that are intersected by the longcharacteristics, thus saving computing time. This way, i 0 is chosen such that the corresponding upwind cell has the largest size in x-direction, ∆x i 0 = ∆x max . Similarly, we choose j 0 such that ∆y j 0 = ∆ j max . Then, starting from (x i 0 , y j 0 ), we calculate the specific intensity with the long-characteristics method at y j 0 , for the grid points along x-direction that span one x-period. In the same vein, we use the long-characteristics method at x i 0 , for the grid points along y-direction that span one y-period. Once these two first rows have been treated, we resume the short-characteristics method for all the next rows of the current z-layer. Note that here we do not introduce ghost nodes (see Section 5.1), since the medium has an infinite extension in x-direction and y-direction.</p><p>The schematic diagram of <ref type="figure">Figure 6</ref> clarifies our point, for a radiation propagating in the first octant, therefore along increasing x, y, and z. It shows two computational domains in a given z-plane. Both span one x-period and one y-period. The original domain is depicted by the rectangle with solid thick lines. The positions of the grid nodes in the horizontal z-plane were introduced in Section 5.1, (x 0 , x 1 , ..., x N x ) and (y 0 , y 1 , ..., y N y ). The vertical boundary planes are x = x 0 and y = y 0 . The indices i 0 and j 0 are defined above in the preceding paragraph. The RTE is solved in the computational domain depicted by the rectangle with thick dotted lines. The positions of the grid nodes of this domain are (x i 0 , x i 0 +1 , ..., x i 0 +N x ) and (y j 0 , y j 0 +1 , ..., y j 0 +N y ), with the following correspondence of the grid sizes, derived from the double periodicity of the medium:</p><formula xml:id="formula_44">∆x i, i∈N x +1,N x +i 0 = ∆x i ′ , i ′ ∈1,i 0 ∆y j, j∈N y +1,N y + j 0 = ∆y j ′ , j ′ ∈1, j 0<label>(31)</label></formula><p>We also have the following correspondence for the physical quantities f (ν, x, y, z):</p><formula xml:id="formula_45">f ν,z x i , y j i∈N x +1,N x +i 0 j∈N y +1,N y + j 0 = f ν,z x i ′ , y j ′ i ′ ∈1,i 0 j ′ ∈1, j 0<label>(32)</label></formula><p>We employ the long-characteristics method along x-direction from (x i 0 , y j 0 ) to (x i 0 +N x , y j 0 ), and along y-direction from (x i 0 , y j 0 ) to (x i 0 , y j 0 +N y ). Then, we resume our usual short-characteristics method for the next rows of the current z-layer. Once calculated, the specific intensity is defined in the original computational domain, with a simple rearrangement of indices as per Equation <ref type="formula" target="#formula_0">(32)</ref>. Note that some long-characteristics may consist merely of short-characteristics. This is the case for a given grid point (x i, i∈i 0 ,N x , y j 0 ), if the corresponding ∆x i and ∆y max are large enough, so that the related upwind end point intersects the horizontal upwind face. Similarly, this is the case for (x i 0 , y j, j∈ j 0 ,N y ), if ∆y j and ∆x max are large enough.</p><p>We mention here that it is also possible to handle periodic conditions by iterative methods, as done for instance by van <ref type="bibr" target="#b59">Noort et al. (2002)</ref> and <ref type="bibr" target="#b17">Davis et al. (2012)</ref>. However, such an approach can lead to a slow convergence in the case of optically thin media, as noted by van <ref type="bibr" target="#b59">Noort et al. (2002)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.">Tests of IRIS</head><p>The code underwent a number of various tests to validate each of its functionalities that we describe in this paper. We focus here on the three most important ones: the searchlight beam test, a comparison with a well-tested one-dimensional scheme, and the test of the velocity gradient effect applied on one given spectral line.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.1.">The Searchlight Beam Test</head><p>In the context of astrophysical radiation transport, this test was first proposed by <ref type="bibr" target="#b39">Kunasz &amp; Auer (1988)</ref>. Several authors then used it to evaluate their multidimensional short-characteristics algorithms ( <ref type="bibr" target="#b53">Stone et al. 1992;</ref><ref type="bibr" target="#b3">Auer &amp; Paletou 1994;</ref><ref type="bibr" target="#b18">Fabiani Bendicho 2003;</ref><ref type="bibr" target="#b19">Fabiani Bendicho &amp; Trujillo Bueno 2007;</ref><ref type="bibr" target="#b30">Hayek et al. 2010;</ref><ref type="bibr" target="#b17">Davis et al. 2012</ref>). The purpose is to examine how a beam propagates through a transparent medium. Theoretically, the beam crosses the medium without being absorbed or dispersed. The RTE, Equation (5), is greatly simplified since, in this particular case, I c = I u . Note that the numerical counterpart of the RTE, Equation <ref type="formula" target="#formula_2">(14)</ref> is consistent with this behavior when the opacity is zero, as pointed out in Section 5.2. Therefore, the calculation uses only the upwind interpolation of the specific intensity. This test challenges the capabilities of the piecewise cubic, locally monotonic, interpolation technique (see Section 4), as applied to cell face interpolations (see Section 5.1).</p><note type="other">Ibgui et al.: IRIS, a generic 3D radiative transfer code original grid</note><formula xml:id="formula_46">M' x i 0 −1 , y j 0 −1 ( ) x y z M x 0 , y 0 ( ) x N x , y 0 ( ) x 0 , y N y ( ) calculation grid i 0 x i 0 , y j 0 ( ) j 0 x i 0 + N x , y j 0 ( ) x i 0 , y j 0 + N y ( ) x 1 , y 1 ( ) ∆x max</formula><p>∆y max</p><p>x N x , y j 0 ( ) <ref type="figure">Fig. 6</ref>. Original domain (solid thick lines) and calculation domain (dotted thick lines) at a given z-plane, for a medium that is periodic in the horizontal (x,y) plane, and for a radiation propagating in the first octant, i.e., along increasing x, y, and z. Both domains span one period in x-direction and one period in ydirection. The nodes of the original domain are (x 0 , x 1 , ..., x N x ) and (y 0 , y 1 , ..., y N y ). The nodes of the calculation domain, where the specific intensity is computed, are (</p><formula xml:id="formula_47">x i 0 , y N y ( )</formula><formula xml:id="formula_48">x i 0 , x i 0 +1 , ..., x i 0 +N x ) and (y j 0 , y j 0 +1 , ..., y j 0 +N y ).</formula><p>The indices i 0 and j 0 are chosen such that ∆x i 0 = ∆x max and ∆y j 0 = ∆ j max . See text in Section 7 for a discussion.</p><p>conservation: the xy-surface integral of the specific intensity at z = 0 equals the the xy-surface integral at z = 10, to the machine accuracy. This test represents an excellent validation of the piecewise cubic, locally monotonic, interpolation scheme that we use. Such a technique almost suppresses the numerical diffusion effect of the short-characteristics method, and is more efficient than linear, parabolic (the first one is extremely diffusive, the second one introduces spurious extrema, as shown by <ref type="bibr" target="#b39">Kunasz &amp; Auer 1988)</ref>, or even monotonic quadratic schemes <ref type="bibr" target="#b3">(Auer &amp; Paletou 1994)</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.2.">Comparison with 1D Plane-Parallel Models</head><p>It is important to check whether IRIS can reproduce the results provided by one-dimensional radiative transfer schemes, when the medium is made of homogeneous plane-parallel layers, i.e., in the case of a 1D plane-parallel structure. Simulating the radiative transfer for such a medium with IRIS can be achieved by imposing periodic boundary conditions in faces perpendicular to the parallel layers. Assuming that these layers are parallel to the horizontal z-planes, the specific intensity has then the following dependence, I(z, cos θ, ν). Applying the full 3D calculation with IRIS for such a medium perfectly reproduces the radiative results provided by 1D radiative models at any frequency, as we show in the example below.</p><p>We calculate the radiative transfer through a radiative shock structure made of homogeneous plane-parallel layers. The hydrodynamics structure, provided by Matthias González 1 , is obtained with the three-dimensional radiation hydrodynamics code HERACLES ( <ref type="bibr" target="#b24">González et al. 2007</ref>). The test case is a simulation of an experimental radiative shock generated in a tube full of Xenon assumed to be a perfect gas, with the following upstream conditions: fluid velocity = 60 km s −1 , pressure = 7 bar, temperature = 1 eV. The opacities that we use are from <ref type="bibr" target="#b44">Michaut et al. (2004)</ref>. Our objective here is focused on the comparison of the 1D and the 3D radiative models; a future paper ( <ref type="bibr">Ibgui et al. 2012, in preparation)</ref> will present more details of three-dimensional models of radiative shocks.</p><p>The 3D computational grid is built with 20 × 20 × 510 points in respectively x, y, and z directions. In each horizontal z-plane, all the state parameters (temperature, density, velocity) are independent of x and y. Two post-processing calculations were performed: one with IRIS applied on the 3D grid, and one with a well-tested 1D short-characteristics solver applied on a 1D grid that is extracted from the 3D one. Both were done at seventeen frequencies that range from hν = 2 eV (λ = 620 nm) to hν = 494 eV (λ = 2.41 nm). The velocity gradient effect was not taken into account in this test. <ref type="figure" target="#fig_2">Figure 8</ref> shows several radiative quantities provided by IRIS and by the 1D solver. By way of example, we select one frequency, hν = 296 eV, which corresponds to λ = 4.19 nm.</p><p>The top left panel of <ref type="figure" target="#fig_2">Figure 8</ref> displays the specific intensity as a function of z, and for different polar angles θ:</p><formula xml:id="formula_49">0 • (green), 45 • (blue), 89 • (red), 135 • (orange), 180 • (cyan).</formula><p>The solid lines are the results calculated with IRIS. The symbols are the results provided by the 1D solver. Note that, for the readability of the figure, we plot the 1D results for only some of the 510 z values. Note also that we plot the 3D results calculated with several azimuthal angles ϕ( • ) = (0, <ref type="bibr">45,</ref><ref type="bibr">89,</ref><ref type="bibr">90,</ref><ref type="bibr">135,</ref><ref type="bibr">179,</ref><ref type="bibr">180,</ref><ref type="bibr">225,</ref><ref type="bibr">269,</ref><ref type="bibr">270,</ref><ref type="bibr">315,</ref><ref type="bibr">359</ref>). All the curves for these twelve ϕ angles are perfectly superposed, and, therefore, indistinguishable. This demonstrates that the specific intensity is independent of ϕ. In addition, we verified that for any given pair (θ, ϕ), the specific intensity at a given z-plane is the same for all the grid points of this plane, which demonstrates that this quantity is independent of x and y. Last but not least, the 1D symbols perfectly fit with the 3D curves.</p><p>The other three panels of <ref type="figure" target="#fig_2">Figure 8</ref> display the moments obtained by angular integration (see Section 6): the mean intensity J in the top right panel, the components of the radiation flux vector, F x , F y , F z , in the bottom left panel, and the components of the radiation pressure tensor P xx , P yy , P zz , P xy , P xz , P yz , in the bottom right panel. All the curves show that the 1D and 3D results perfectly agree. We checked this result for all the seventeen tested frequencies. In addition, the 3D results provided by IRIS verify, for any frequency, the following properties that are theoretically valid for 1D plane-parallel structures. The radiative flux is zero in x and y direction, F x = 0, F y = 0, and it depends only on z in z-direction, F z (z, ν). The non-diagonal components of the radiation pressure tensor are all zero: P xy = 0, P xz = 0, P yz = 0. The other three pressure components depend only on z, P xx (z, ν), P yy (z, ν), P zz (z, ν), and we have, for any z and ν, P xx (z, ν) = P yy (z, ν).</p><p>These tests demonstrate that IRIS is capable of reproducing 1D plane-parallel simulations, and, thereby, of handling periodic boundary conditions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.3.">Test of the Velocity Gradient Effect</head><p>As explained in Section 5.3, IRIS can handle the velocity gradient effect on spectra (caused by the Doppler shifts of photon frequencies) by subdividing a short-characteristic in a set of subintervals. This subdivision is controlled by a tunable parameter We illustrate the effect of our treatment in a simple ideal case that can be otherwise calculated quasi-analytically. We consider one plasma layer with a uniform temperature T in a stellar wind region with a velocity gradient, as sketched by <ref type="figure" target="#fig_3">Figure 9</ref>, top panel. We focus on one velocity direction, referred to as z-direction. In our example, the material moves toward an observer. The layer is numerically modeled with a single cell between two grid points, z 1 , the farther position from the observer, and z 2 , the closer position to the observer. The wind velocities at grid points are V 1 &gt; 0 and V 2 &gt; V 1 . We assume that there is only one radiating species. We focus on the radiation of the layer itself, in the direction of the wind toward the observer, and neglect any incoming radiation in z 1 . Although the situation in a stellar wind is significantly different from LTE, we do assume LTE for the purpose of this test. We also neglect scattering. Therefore, the source function is uniform and equals the Planck function at the layer's temperature, B ν (T ). We consider one spectral line, for which we assume, for simplicity, a Doppler profile centered at a frequency ν 0 in the particle's frame. With these assumptions, the Doppler width ∆ν D is a constant, and the monochromatic specific intensity of the radiation emerging from the layer toward the observer is simply given by:</p><formula xml:id="formula_50">I(ν) = 1 − e −τ 12 (ν) B ν (T )<label>(33)</label></formula><p>where τ 12 (ν) is the monochromatic optical depth from z 1 to z 2 :</p><formula xml:id="formula_51">τ 12 (ν) = z 2 z 1 κ(ν, z) dz ,<label>(34)</label></formula><p>where the absorption coefficient κ(ν, z) is written as</p><formula xml:id="formula_52">κ(ν, z) = K e − ν−ν ctr (z) ∆ν D 2 ,<label>(35)</label></formula><p>where ν ctr (z), defined in Section 5.3 by Equation (16), is the shifted line-center frequency for a velocity V(z) at position z:</p><formula xml:id="formula_53">ν ctr (z) = ν 0 (1 + V(z)/c).</formula><p>The quantity K is a constant that contains all the attributes of the line (population of the lower level,  <ref type="bibr">(0,</ref><ref type="bibr">45,</ref><ref type="bibr">89,</ref><ref type="bibr">90,</ref><ref type="bibr">135,</ref><ref type="bibr">179,</ref><ref type="bibr">180,</ref><ref type="bibr">225,</ref><ref type="bibr">269,</ref><ref type="bibr">270,</ref><ref type="bibr">315,</ref><ref type="bibr">359)</ref>. There is no legend for the ϕ values, because all the curves, for a given θ, are perfectly superposed. The top right, bottom left, and bottom right panels show respectively the mean intensity J (black, square), the components of the radiative flux vector F (black, square), and the components of the radiation pressure tensor P (P zz : blue, square; P xx = P yy : red, plus). See Section 8.2 for more details. and oscillator strength) and the value of the constant Doppler width. Now, since we use monotonic laws (cubic Hermite polynomials, see Section 5.2) to interpolate physical quantities along a short-characteristic, τ 12 (ν) may be written as</p><formula xml:id="formula_54">τ 12 (ν) = ν ctr 2 ν ctr 1 R ′ (ν ctr ) K e − ν−ν ctr ∆ν D 2 dν ctr ,<label>(36)</label></formula><p>where R is the function relating the shifted transition frequency ν ctr to the position z within the layer: z = R(ν ctr ), R ′ being its derivative, and where we define:</p><formula xml:id="formula_55">       ν ctr 1 = ν 0 1 + V 1 c ν ctr 2 = ν 0 1 + V 2 c<label>(37)</label></formula><p>In this simplified configuration, the optical depth appears as the convolution of a function A(ν) and a Gaussian function B(ν) (the line profile), both defined as follows:</p><formula xml:id="formula_56">τ 12 (ν) = (A * B) (ν) ,<label>(38a)</label></formula><p>where</p><formula xml:id="formula_57">A(ν) = R ′ (ν ctr ) if ν ctr 1 ν ν ctr 2 0 if ν &lt; ν ctr 1 or ν &gt; ν ctr 2 (38b) B(ν) = Ke −ν 2 (38c)</formula><p>For the test, we adopt the following typical values of velocities in winds of early massive stars: V 1 = 2000 km s −1 , V 2 = 2250 km s −1 , and a thermal velocity (constant in our uniform layer) of V th = 25 km s −1 . With such a choice, any line is Doppler shifted by an amount of 10 times its Doppler width between position z 1 and position z 2 , i.e., (ν ctr 2 − ν ctr 1 )/∆ν D = (V 2 − V 1 )/V th = 10. We also adopt a temperature T = 10 5 K, and a layer size z 2 − z 1 = 10 9 cm.</p><p>We consider an artificial line, arbitrarily centered at hν 0 = 80.00 eV in the particle's frame. In the observer's frame, the line is centered at ν ctr 1 ≈ 80.53 eV at z 1 , and at ν ctr 2 ≈ 80.60 eV at z 2 . Note also that we have defined the K value (see Equation 35) so that the transmission of the layer at the line center equals 0.5 in the case when there is no velocity gradient. In this case indeed, the monochromatic thermal absorption κ(ν, z) is independent of z, so that K is inferred from e −K(z 2 −z 1 ) = 0.5. This way, we avoid the extreme cases of an optically thin or an optically thick layer. The red thick curve in <ref type="figure" target="#fig_3">Figure 9</ref>, bottom left panel, displays the monochromatic specific intensity I(ν) that emerges from the layer at position z 2 toward the observer, as calculated by IRIS. This emission spectrum is displayed versus photon energy hν (eV) or photon wavelength λ (Å). For comparison, the black thick curve represents the line, centered at 80.53 eV, that would obtain if there was no velocity gradient, i.e., if V 2 = V 1 . The bottom right panel of the figure portrays the transmission, e −τ 12 (ν) , of the layer. In the highly simplified configuration of our test, the transmission and the specific intensity are related by the linear Equation (33). This is why this transmission spectrum looks the same, but inverted, as the emission spectrum. In the presence of a velocity gradient, the absorption of the medium decreases, is shifted (blueward if the material approaches the observer, redward if it recedes from the observer), and spreads over a larger spectral range. This also applies to the emission of the medium.</p><p>In this ideal test case, we can explain the shape and the position of the line depicted by the red curve. The optical depth is given by Equation (36). In addition, the layer is modeled with a unique cell. So, the cubic monotonic Hermite polynomial that defines V(z) along the short-characteristic between z 1 and z 2 almost coincides with a linear law, since the downwind endpoint is a ghost point in which state parameters are defined by linear extrapolations (see Section 5.1). In these specific conditions, z is trivially related to ν ctr by a linear function R(ν ctr ), so that A(ν) is merely a boxcar function. Then, the optical depth is</p><formula xml:id="formula_58">τ 12 (ν) = K c ν 0 z 2 − z 1 V 2 − Vz 1 ν ctr 2 ν ctr 1 e − ν ctr −ν ∆ν D 2 dν ctr (39)</formula><p>where ν ctr 1 and ν ctr 2 are defined by Equations (37). The calculation of the monochromatic specific intensity with Equation (33), using the relation (39) above, provides a result that exactly fits the red curve obtained with IRIS. Note that this spectral line is centered at (ν ctr 1 + ν ctr 2 )/2 ≈ 80.57 eV. Last but not least, <ref type="figure" target="#fig_3">Fig. 9</ref> (emission spectrum, left, or transmission spectrum, right) shows that the ǫ D parameter (cf. Equation <ref type="formula" target="#formula_0">(20)</ref>) plays a crucial role in the precision of the calculated line, through the subgriding of the short-characteristic. The cyan curve shows the profile obtained with ǫ D = 11, for which we checked that the short-characteristic is not subdivided. This profile is composed of two peaks, which are located in the two extreme positions of the line center, ν ctr 1 and ν ctr 2 , with a large trough in the middle. Such a discrepancy between this profile and the correct red one may result in erroneous interpretations of observed spectra when compared with synthetic spectra. As ǫ D decreases, the trough is being gradually filled, as shown by the other curves obtained with different ǫ D : 6 (green), 5 (orange), 3 (blue), 2 (grey). This test verifies that the line shape starts to stabilize from ǫ D = 1. Tiny waves remain in the profile calculated with ǫ D = 1. This profile is not shown in the figure because these waves are barely perceptible, so that it almost coincides with the red profile. Our numerical tests indicate that the short-characteristic is subdivided in 14 subintervals for ǫ D = 1, whereas it is subdivided in 46 subintervals for ǫ D = 0.3. Not surprisingly, increasing the precision involves a larger computational cost. Such a test confirms that the ideal value of ǫ D lies somewhere between 1/3 and 1 (see Section 5.3).</p><p>We stress again that the profile depicted by the red curves in <ref type="figure" target="#fig_3">Fig. 9</ref> has been obtained in the ideal case of a single line with a Doppler profile, under the assumption of a unique layer at uniform temperature, in LTE, and with a linear velocity variation within the layer. In the general case, none of these situations holds, which results in a more complex profile. Only a full calculation with our subgriding method can provide the actual profile.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="9.">Conclusion</head><p>In this paper, we have described IRIS, a new generic threedimensional spectral radiative transfer code, which solves the monochromatic static 3D radiative transfer equation in the observer's frame, in Cartesian coordinates. We drop the time derivative in the transfer equation because we consider situations in which the dynamical timescales are large compared to the photon free-flight time, such that the studied medium is assumed to be in a frozen state during the time when the radiation field propagates throughout its structure. The code is primarily intended for post-processing any hydrodynamics snapshot, i.e., any structure provided at a given instant by a (radiation)(magneto)hydrodynamics simulation. That way, IRIS can determine, at each instant, the radiation field of a non-stationary flow. We consider non-relativistic flow velocities. Currently, we assume local thermodynamic equilibrium.</p><p>IRIS is mainly a diagnostic tool to be used for comparisons between predicted spectra, maps or images one the one hand, and astrophysical observations or laboratory astrophysics measurements on the other hand. It computes the monochromatic specific intensity and optical depth at any position within a hydrodynamics structure, for any direction. Associated with appropriate opacities specified by the user in a dedicated module, it calculates synthetic spectra and maps or images emerging from the studied structure or astrophysical object. It can also calculate, from the specific intensity and through angular integrations, the moments of the radiation field: the mean intensity, the radiation flux vector, and the radiation pressure tensor, at any position within the studied medium.</p><p>IRIS works with any 3D Cartesian grid, the latter being nonuniform in each direction. The code uses a shortcharacteristics solver to determine the formal solution of the radiative transfer equation. We have implemented a very efficient piecewise cubic, locally monotonic, interpolation technique, that considerably reduces the numerical diffusion effects of the shortcharacteristics method. The latter is used for interpolating any physical quantity in the cell faces of the computational grid, and for defining laws of variation of physical quantities along shortcharacteristics.</p><p>IRIS is able to handle horizontal periodic boundary conditions of a simulation box. This configuration occurs for a medium with an infinite (that is, large compared to the extent of the computational box) extension in its horizontal plane and a double periodicity in this plane, along with a finite extension in its vertical direction, such as a stellar atmosphere or an accretion disk.</p><p>Since it is formulated in the observer's frame, IRIS can deal with any (non-relativistic) non-monotonic macroscopic velocities. The code can be applied to a large number of radiating astrophysical objects or structures, such as accretion shocks or jets in young stellar objects, stellar atmospheres, exoplanet atmospheres, accretion disks, rotating stellar winds, and cosmological structures. IRIS has already been applied to predict X-UV spectra of laboratory generated radiative shocks (see conference proceedings <ref type="bibr" target="#b35">Ibgui et al. 2012a</ref>,b; we are also writing a paper on this topic: <ref type="bibr">Ibgui et al. 2012, in preparation)</ref>.</p><p>We envision various extensions in the near future. First, we will implement an iterative method based on the Accelerated Lambda Iteration (ALI) technique to handle scattering and NLTE effects. We will interface IRIS with the NLTE stellar atmosphere code TLUSTY <ref type="bibr" target="#b33">(Hubeny 1988;</ref><ref type="bibr" target="#b34">Hubeny &amp; Lanz 1995)</ref>, from which we take the treatment of atomic data, and all local physics (opacities, and the scheme for solving the set of statis- The layer is at uniform temperature T , with one radiating species, assuming LTE and no scattering. The layer is modeled in IRIS with one cell between grid points z 1 and z 2 , with wind velocities V 1 &gt; 0 (the material approaches the observer) and V 2 &gt; V 1 . The red thick curve in the bottom left panel displays the monochromatic specific intensity I ν , due to the radiation that emerges from the layer at z 2 toward the observer, as computed by IRIS. This emission spectrum is plotted versus photon energy hν <ref type="formula">(</ref> tical equilibrium equations using the preconditioning method to obtain NLTE level populations). Later, extending IRIS to polarized radiative transfer will provide the code with the capability to diagnose magnetic fields. On the computational side, IRIS is written in Fortran 95. The current version runs on a single processor. We plan to parallelize the code with the message passing interface (MPI) library. Post-processing of (R)(M)HD calculations performed on adaptively refined grids generated with the adaptive mesh refinement (AMR) technique will benefit from 3D nonuniform Cartesian grids in IRIS, though its full implementation will require additional work.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Upwind cell (top) and downwind cell (bottom), for the short-characteristic M u M c displayed in Fig. 1. In this example, the direction of propagation of the radiation, n, is in the first octant, which corresponds to (θ, ϕ) ∈ [0, π/2[×[0, π/2[. The local coordinate system is defined by (M c , e x , e y , e z ). The upwind end point M u belongs to the cell face f z : z = −∆z k . However, depending on (θ, ϕ) in this octant, M u may belong to f x : x = −∆x i , or to f y : y = −∆y j . In the general case, ∆x i ∆y j , ∆x i ∆z k , ∆y j ∆z k , though equalities are possible. The downwind end point M d belongs to f z : z = ∆z k+1 . However, depending on (θ, ϕ) in this octant, M d may belong to f x : x = ∆x i+1 or to f y : y = ∆y j+1 . See Section 3.2 for more details.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 7 .</head><label>7</label><figDesc>Fig. 7. Searchlight beam test. The top left panel of the figure depicts the purpose of this test. A slanted beam, with direction n, enters a zero opacity box at its base, and emerges from it at the top. The objective is to compare the entering beam profile with the emerging one; both are theoretically the same. The bottom panels show the normalized specific intensity of the beam, as a function of positions x and y, at the bottom of the box (left panel), and at the top of the box (right panel). The top right panel displays sectional views of the beam along x-axis, at z = 0 and y = 3 (red curve), at z = 10 and y = 6.8 (green curve). The blue curve is identical to the the green one, but shifted so that its center fits the center of the red curve. See Section 8.1 for explanations.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 8 .</head><label>8</label><figDesc>Fig. 8. Comparison with 1D plane-parallel models. The figures shows the monochromatic radiative quantities, at hν = 296 eV (λ = 4.19 nm), calculated with IRIS (solid lines) and with a 1D solver (symbols), in the case of a radiative shock structure made of homogeneous plane-parallel layers. The top left panel displays the specific intensity for different polar angles θ: 0 • (green, square), 45 • (blue, triangle), 89 • (red, filled circle), 135 • (orange, diamond), 180 • (cyan, asterisk), and for a set of twelve azimuthal angles ϕ( • ) = (0, 45, 89, 90, 135, 179, 180, 225, 269, 270, 315, 359). There is no legend for the ϕ values, because all the curves, for a given θ, are perfectly superposed. The top right, bottom left, and bottom right panels show respectively the mean intensity J (black, square), the components of the radiative flux vector F (black, square), and the components of the radiation pressure tensor P (P zz : blue, square; P xx = P yy : red, plus). See Section 8.2 for more details.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>TFig. 9 .</head><label>9</label><figDesc>Fig. 9. Test of the velocity gradient effect. The top panel represents a single plasma layer in a stellar wind, with a velocity gradient. The layer is at uniform temperature T , with one radiating species, assuming LTE and no scattering. The layer is modeled in IRIS with one cell between grid points z 1 and z 2 , with wind velocities V 1 &gt; 0 (the material approaches the observer) and V 2 &gt; V 1 . The red thick curve in the bottom left panel displays the monochromatic specific intensity I ν , due to the radiation that emerges from the layer at z 2 toward the observer, as computed by IRIS. This emission spectrum is plotted versus photon energy hν (eV) or photon wavelength λ (Å). It is obtained with a parameter ǫ D = 0.3. Too large values of ǫ D result in incorrect profiles, as shown by the following curves: cyan (ǫ D = 11), green (ǫ D = 6), orange (ǫ D = 5), blue (ǫ D = 3), grey (ǫ D = 2). The bottom right panel displays the corresponding transmission spectrum. For comparison, the black thick curve portrays the spectral line that would obtain if there was no velocity gradient (V 2 = V 1 ). See Section 8.3 for detailed explanations.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><label></label><figDesc>Fig. 9. Test of the velocity gradient effect. The top panel represents a single plasma layer in a stellar wind, with a velocity gradient. The layer is at uniform temperature T , with one radiating species, assuming LTE and no scattering. The layer is modeled in IRIS with one cell between grid points z 1 and z 2 , with wind velocities V 1 &gt; 0 (the material approaches the observer) and V 2 &gt; V 1 . The red thick curve in the bottom left panel displays the monochromatic specific intensity I ν , due to the radiation that emerges from the layer at z 2 toward the observer, as computed by IRIS. This emission spectrum is plotted versus photon energy hν (eV) or photon wavelength λ (Å). It is obtained with a parameter ǫ D = 0.3. Too large values of ǫ D result in incorrect profiles, as shown by the following curves: cyan (ǫ D = 11), green (ǫ D = 6), orange (ǫ D = 5), blue (ǫ D = 3), grey (ǫ D = 2). The bottom right panel displays the corresponding transmission spectrum. For comparison, the black thick curve portrays the spectral line that would obtain if there was no velocity gradient (V 2 = V 1 ). See Section 8.3 for detailed explanations.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><head>). Since we know the values of S and χ in three points, M u , M c , and the downwind endpoint M d , the derivatives of these quantities at M u , dS dτ u and dχ ds u , are provided by the slopes defined by Equation (12a), while the derivatives at M c , dS dτ c and dχ ds c</head><label></label><figDesc></figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><head>A i face f z : z = −∆z k</head><label></label><figDesc></figDesc><table>2 
s 2 

uc 


dχ 
ds 




u 

− 
dχ 
ds 




c 

(15) 

x 

y 

z 

A i+1 

M c 

⊥ 

x i−2 
x i−1 
x i x i+1 
y j−2 

y j−1 

y j 

y j+1 

M u 

A i-1 
A i-2 

M c 

⊥ 

y 

z 

x 

M u 

y j−2 y j−1 
y j 
y j+1 

z k−2 

z k−1 

z k 

z k+1 

</table></figure>

			<note place="foot" n="1"> AIM, CEA/DSM/IRFU, CNRS, Université Paris Diderot, 91191 Gif-sur-Yvette, France</note>
		</body>
		<back>

			<div type="acknowledgement">
			</div>

			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Auer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Quant. Spec. Radiat. Transf</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page">931</biblScope>
			<date type="published" when="1976" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Auer</surname></persName>
		</author>
		<title level="m">Astronomical Society of the Pacific Conference Series</title>
		<editor>I. Hubeny, D. Mihalas, &amp; K. Werner</editor>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="volume">288</biblScope>
			<biblScope unit="page">3</biblScope>
		</imprint>
	</monogr>
	<note>Stellar Atmosphere Modeling</note>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Auer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">F</forename><surname>Bendicho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Bueno</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">292</biblScope>
			<biblScope unit="page">599</biblScope>
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">H</forename><surname>Auer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Paletou</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">285</biblScope>
			<biblScope unit="page">675</biblScope>
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Baron</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">H</forename><surname>Hauschildt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">468</biblScope>
			<biblScope unit="page">255</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Master&apos;s thesis, Master&apos;s thesis</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Botnen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Inst. Theor. Astrophys. Oslo</title>
		<imprint>
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">W</forename><surname>Brodlie</surname></persName>
		</author>
		<title level="m">Mathematical Methods in Computer Graphics and</title>
		<editor>Design, K. W. Brodlie ed.</editor>
		<meeting><address><addrLine>London, 1</addrLine></address></meeting>
		<imprint>
			<publisher>Academic Press</publisher>
			<date type="published" when="1980" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">H M J</forename><surname>Bruls</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Vollmöller</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Schüssler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">348</biblScope>
			<biblScope unit="page">233</biblScope>
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">L</forename><surname>Bryan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">L</forename><surname>Norman</surname></persName>
		</author>
		<idno>arXiv: 9710187</idno>
		<imprint>
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Carlson</surname></persName>
		</author>
		<title level="m">Methods in Computational Physics</title>
		<editor>B. Alder, S. Fernbach, &amp; M. Rotenberg</editor>
		<imprint>
			<publisher>Academic Press</publisher>
			<date type="published" when="1963" />
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page">1</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carlsson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Uppsala Astronomical Observatory Reports</title>
		<imprint>
			<biblScope unit="page">33</biblScope>
			<date type="published" when="1986" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carlsson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physica Scripta</title>
		<imprint>
			<biblScope unit="volume">T</biblScope>
			<biblScope unit="page">14012</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carlsson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mem. Soc. Astron. Italiana</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page">606</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">I</forename><surname>Castor</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">G</forename><surname>Dykema</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">I</forename><surname>Klein</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">387</biblScope>
			<biblScope unit="page">561</biblScope>
			<date type="published" when="1992" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<monogr>
		<title level="m" type="main">IRIS, a generic 3D radiative transfer code</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><surname>Ibgui</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Chandrasekhar</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1950" />
		</imprint>
	</monogr>
	<note>Radiative transfer</note>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><forename type="middle">J</forename><surname>Cunningham</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Frank</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Varnì Ere</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Mitran</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">W</forename><surname>Jones</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJS</title>
		<imprint>
			<biblScope unit="volume">182</biblScope>
			<biblScope unit="page">519</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><forename type="middle">W</forename><surname>Davis</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Stone</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Y.-F</forename><surname>Jiang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJS</title>
		<imprint>
			<biblScope unit="volume">199</biblScope>
			<biblScope unit="page">9</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Fabiani</forename><surname>Bendicho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename></persName>
		</author>
		<title level="m">Astronomical Society of the Pacific Conference Series</title>
		<editor>I. Hubeny, D. Mihalas, &amp; K. Werner</editor>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="volume">288</biblScope>
			<biblScope unit="page">419</biblScope>
		</imprint>
	</monogr>
	<note>Stellar Atmosphere Modeling</note>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">ArXiv e-prints Fabiani Bendicho</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Fabiani</forename><surname>Bendicho</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Trujillo Bueno</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">; P</forename><surname>Trujillo Bueno</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Auer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">324</biblScope>
			<biblScope unit="page">161</biblScope>
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Feautrier</surname></persName>
		</author>
		<title level="m">Comptes Rendus Academie des Sciences (serie non specifiee)</title>
		<imprint>
			<date type="published" when="1964" />
			<biblScope unit="volume">258</biblScope>
			<biblScope unit="page">3189</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Freytag</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Steffen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Dorch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Astronomische Nachrichten</title>
		<imprint>
			<biblScope unit="volume">323</biblScope>
			<biblScope unit="page">213</biblScope>
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">N</forename><surname>Fritsch</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Butland</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM J. Sci. Stat. Comput</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">300</biblScope>
			<date type="published" when="1984" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><surname>Galsgaard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Å</forename><surname>Nordlund</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Geophys. Res</title>
		<imprint>
			<biblScope unit="volume">101</biblScope>
			<biblScope unit="page">13445</biblScope>
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>González</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Audit</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Huynh</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">464</biblScope>
			<biblScope unit="page">429</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">V</forename><surname>Gudiksen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carlsson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><forename type="middle">H</forename><surname>Hansteen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">531</biblScope>
			<biblScope unit="page">154</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><forename type="middle">H</forename><surname>Hansteen</surname></persName>
		</author>
		<title level="m">Multi-Wavelength Investigations of Solar Activity</title>
		<editor>A. V. Stepanov, E. E. Benevolenskaya, &amp; A. G. Kosovichev</editor>
		<imprint>
			<date type="published" when="2004" />
			<biblScope unit="volume">223</biblScope>
			<biblScope unit="page" from="385" to="386" />
		</imprint>
	</monogr>
	<note>IAU Symposium</note>
</biblStruct>

<biblStruct xml:id="b27">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><forename type="middle">H</forename><surname>Hansteen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carlsson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><surname>Gudiksen</surname></persName>
		</author>
		<title level="m">Astronomical Society of the Pacific Conference Series</title>
		<editor>P. Heinzel, I. Dorotovič, &amp; R. J. Rutten</editor>
		<imprint>
			<date type="published" when="2007" />
			<biblScope unit="volume">368</biblScope>
			<biblScope unit="page">107</biblScope>
		</imprint>
	</monogr>
	<note>The Physics of Chromospheric Plasmas</note>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">H</forename><surname>Hauschildt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Baron</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">451</biblScope>
			<biblScope unit="page">273</biblScope>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">H</forename><surname>Hauschildt</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">E</forename><surname>Baron</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">490</biblScope>
			<biblScope unit="page">873</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Hayek</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Asplund</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carlsson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">517</biblScope>
			<biblScope unit="page">49</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Hayek</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Asplund</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Collet</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Å</forename><surname>Nordlund</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">529</biblScope>
			<biblScope unit="page">158</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Heinemann</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">W</forename><surname>Dobler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Å</forename><surname>Nordlund</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Brandenburg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">448</biblScope>
			<biblScope unit="page">731</biblScope>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Hubeny</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computer Physics Communications</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="page">103</biblScope>
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Hubeny</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Lanz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">439</biblScope>
			<biblScope unit="page">875</biblScope>
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Ibgui</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Hubeny</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Lanz</surname></persName>
		</author>
		<title level="m">Proceedings of the Annual meeting of the French Society of Astronomy and Astrophysics</title>
		<editor>S. Boissier, P. de Laverny, N. Nardetto, R. Samadi, D. Valls-Gabaud, &amp; H. Wozniak</editor>
		<meeting>the Annual meeting of the French Society of Astronomy and Astrophysics</meeting>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="2" to="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Ibgui</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Hubeny</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Lanz</surname></persName>
		</author>
		<title level="m">ASTRONUM 2012, Astronomical Society of the Pacific Conference Series</title>
		<imprint>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Koesterke</surname></persName>
		</author>
		<title level="m">American Institute of Physics Conference Series</title>
		<editor>I. Hubeny, J. M. Stone, K. MacGregor, &amp; K. Werner</editor>
		<imprint>
			<date type="published" when="2009" />
			<biblScope unit="volume">1171</biblScope>
			<biblScope unit="page" from="73" to="84" />
		</imprint>
	</monogr>
	<note>American Institute of Physics Conference Series</note>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Koesterke</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Allende</forename><surname>Prieto</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Lambert</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">L</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">680</biblScope>
			<biblScope unit="page">764</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Kunasz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">H</forename><surname>Auer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Quant. Spec. Radiat. Transf</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page">67</biblScope>
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">B</forename><surname>Kunasz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">L</forename><surname>Olson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Quant. Spec. Radiat. Transf</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page">1</biblScope>
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">D</forename><surname>Lathrop</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">G</forename><surname>Carlson</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1965" />
			<biblScope unit="page">3186</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Leenaarts</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carlsson</surname></persName>
		</author>
		<title level="m">The Second Hinode Science Meeting: Beyond Discovery-Toward Understanding</title>
		<editor>B. Lites, M. Cheung, T. Magara, J. Mariska, &amp; K. Reeves</editor>
		<imprint>
			<date type="published" when="2009" />
			<biblScope unit="volume">415</biblScope>
			<biblScope unit="page">87</biblScope>
		</imprint>
	</monogr>
	<note>Astronomical Society of the Pacific Conference Series</note>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Leenaarts</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Carlsson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><surname>Hansteen</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>&amp;amp; Rouppe Van Der Voort</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">694</biblScope>
			<biblScope unit="page">128</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Michaut</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Stehlé</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Leygnac</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Lanz</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><surname>Boireau</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">European Physical Journal D</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page">381</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Mignone</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Bodo</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Massaglia</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJS</title>
		<imprint>
			<biblScope unit="volume">170</biblScope>
			<biblScope unit="page">228</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">; D</forename><surname>Mihalas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">L</forename><forename type="middle">H</forename><surname>Auer</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">R</forename><surname>Mihalas</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Stellar atmospheres /2nd edition/ Mihalas</title>
		<imprint>
			<date type="published" when="1978" />
			<biblScope unit="volume">220</biblScope>
			<biblScope unit="page">1001</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<analytic>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Mihalas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">W</forename><surname>Mihalas</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Foundations of radiation hydrodynamics Nordlund</title>
		<imprint>
			<date type="published" when="1982" />
			<biblScope unit="volume">107</biblScope>
			<biblScope unit="page">1</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b48">
	<analytic>
		<title level="a" type="main">A 3D MHD Code for Parallel Computers</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Å</forename><surname>Nordlund</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">; M L</forename><surname>Galsgaard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">L</forename><surname>Bryan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Astrophysics and Space Science Library</title>
		<editor>S. M. Miyama, K. Tomisaka, &amp; T. Hanawa</editor>
		<imprint>
			<biblScope unit="volume">240</biblScope>
			<biblScope unit="page">19</biblScope>
			<date type="published" when="1995" />
		</imprint>
		<respStmt>
			<orgName>Copenhagen University Norman</orgName>
		</respStmt>
	</monogr>
<note type="report_type">Tech. Rep.</note>
	<note>Numerical Astrophysics</note>
</biblStruct>

<biblStruct xml:id="b49">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">L</forename><surname>Norman</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">L</forename><surname>Bryan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Harkness</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b50">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">L</forename><surname>Olson</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><forename type="middle">B</forename><surname>Kunasz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Quant. Spec. Radiat. Transf</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page">325</biblScope>
			<date type="published" when="1987" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b51">
	<analytic>
		<title level="a" type="main">ArXiv Astrophysics e-prints Press</title>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">O&amp;apos;</forename><surname>Shea</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">B</forename><forename type="middle">W</forename><surname>Bryan</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><surname>Bordner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Numerical recipes in FORTRAN. The art of scientific computing Steffen, M</title>
		<imprint>
			<date type="published" when="1990" />
			<biblScope unit="volume">239</biblScope>
			<biblScope unit="page">443</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b52">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Stone</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">A</forename><surname>Gardiner</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Teuben</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">F</forename><surname>Hawley</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">B</forename><surname>Simon</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJS</title>
		<imprint>
			<biblScope unit="volume">178</biblScope>
			<biblScope unit="page">137</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b53">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Stone</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><surname>Mihalas</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">L</forename><surname>Norman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJS</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page">819</biblScope>
			<date type="published" when="1992" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b54">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Stone</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">L</forename><surname>Norman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJS</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page">753</biblScope>
			<date type="published" when="1992" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b55">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Stone</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">L</forename><surname>Norman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJS</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page">791</biblScope>
			<date type="published" when="1992" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b56">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><surname>Teyssier</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">385</biblScope>
			<biblScope unit="page">337</biblScope>
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b57">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Trujillo Bueno</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">P</forename><surname>Fabiani Bendicho</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">455</biblScope>
			<biblScope unit="page">646</biblScope>
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b58">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Uitenbroek</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">557</biblScope>
			<biblScope unit="page">389</biblScope>
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b59">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Uitenbroek</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Van Noort</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">I</forename><surname>Hubeny</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><surname>Lanz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">639</biblScope>
			<biblScope unit="page">1066</biblScope>
			<date type="published" when="2002" />
		</imprint>
	</monogr>
	<note>ApJ</note>
</biblStruct>

<biblStruct xml:id="b60">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Vögler</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Shelyag</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Schüssler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">429</biblScope>
			<biblScope unit="page">335</biblScope>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
