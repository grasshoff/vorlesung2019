<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2018-12-04T16:05+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">The Kepler Pixel Response Function</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2010-03-24">24 Mar 2010</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Stephen</forename><forename type="middle">T</forename><surname>Bryson</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">NASA Ames Research Center</orgName>
								<address>
									<postCode>94035</postCode>
									<settlement>Moffett Field</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Peter</forename><surname>Tenenbaum</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">SETI Institute</orgName>
								<address>
									<postCode>94043</postCode>
									<settlement>Mountain View</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jon</forename><forename type="middle">M</forename><surname>Jenkins</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">SETI Institute</orgName>
								<address>
									<postCode>94043</postCode>
									<settlement>Mountain View</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Hema</forename><surname>Chandrasekaran</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">SETI Institute</orgName>
								<address>
									<postCode>94043</postCode>
									<settlement>Mountain View</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Todd</forename><surname>Klaus</surname></persName>
							<affiliation key="aff2">
								<orgName type="institution">Orbital Sciences Inc</orgName>
								<address>
									<postCode>94035</postCode>
									<settlement>Moffett Field</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Douglas</forename><forename type="middle">A</forename><surname>Caldwell</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">SETI Institute</orgName>
								<address>
									<postCode>94043</postCode>
									<settlement>Mountain View</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Ronald</forename><forename type="middle">L</forename><surname>Gilliland</surname></persName>
							<affiliation key="aff3">
								<orgName type="institution">Space Sciences Telescope Institute</orgName>
								<address>
									<postCode>21218</postCode>
									<settlement>Baltimore</settlement>
									<region>MD</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Michael</forename><forename type="middle">R</forename><surname>Haas</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">NASA Ames Research Center</orgName>
								<address>
									<postCode>94035</postCode>
									<settlement>Moffett Field</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">Jessie</forename><forename type="middle">L</forename><surname>Dotson</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">NASA Ames Research Center</orgName>
								<address>
									<postCode>94035</postCode>
									<settlement>Moffett Field</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">David</forename><forename type="middle">G</forename><surname>Koch</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">NASA Ames Research Center</orgName>
								<address>
									<postCode>94035</postCode>
									<settlement>Moffett Field</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">William</forename><forename type="middle">J</forename><surname>Borucki</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution">NASA Ames Research Center</orgName>
								<address>
									<postCode>94035</postCode>
									<settlement>Moffett Field</settlement>
									<region>CA</region>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">The Kepler Pixel Response Function</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2010-03-24">24 Mar 2010</date>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords>Subject headings: planetary systems -techniques: photometric</keywords>
			</textClass>
			<abstract>
				<p>Kepler seeks to detect sequences of transits of Earth-size exoplanets orbiting Solar-like stars. Such transit signals are on the order of 100 ppm. The high photometric precision demanded by Kepler requires detailed knowledge of how the Kepler pixels respond to starlight during a nominal observation. This information is provided by the Kepler pixel response function (PRF), defined as the composite of Kepler&apos;s optical point spread function, integrated spacecraft pointing jitter during a nominal cadence and other systematic effects. To provide sub-pixel resolution, the PRF is represented as a piecewise-continuous polynomial on a sub-pixel mesh. This continuous representation allows the prediction of a star&apos;s flux value on any pixel given the star&apos;s pixel position. The advantages and difficulties of this polynomial representation are discussed, including characterization of spatial variation in the PRF and the smoothing of discontinuities between sub-pixel polynomial patches. On-orbit super-resolution measurements of the PRF across the Kepler field of view are described. Two uses of the PRF are presented: the selection of pixels for each star that maximizes the photometric signal to noise ratio for that star, and PRF-fitted centroids which provide robust and accurate stellar positions on the CCD, primarily used for attitude and plate scale tracking. Good knowledge of the PRF has been a critical component for the successful collection of high-precision photometry by Kepler.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>The high photometric precision demanded by <ref type="bibr">Kepler (Borucki et.al. 2010;</ref><ref type="bibr">Koch et.al. 2010</ref>) requires detailed knowledge of how pixels respond to starlight during a nominal observational interval. This is provided by the Kepler pixel response function (PRF), a super-resolution representation of the interaction of starlight with pixels that includes modulation by pointing jitter and other systematic effects during an observation (this usage of PRF differs from that in <ref type="bibr" target="#b7">(Lauer 1999)</ref>). The PRF provides a continuous representation that allows the prediction of a star's flux value on any pixel given the star's pixel position: these pixel values are samples of the PRF at the star's sub-pixel position.</p><p>The Kepler focal plane <ref type="bibr">(Argabright et.al.2008;</ref><ref type="bibr">Caldwell et.al. 2010</ref>) consists of 42 1024× 2200 CCDs, each of which is divided into two 1024 × 1100 output channels. A PRF model is defined on each of these 84 output channels, accounting for CCD tip/tilt and other channellevel variations. Due to variation in the optical PSF within an output channel, the PRF model is pixel-position dependent ( §2.1). Data is collected at a 29.4 minute cadence; we refer to this sampling interval as a "long cadence". Bandwidth limitations prevent the storage and downlinking of all 95 × 10 6 pixels at each long cadence: at most 5.4 × 10 6 pixels are downlinked per long cadence.</p><p>The PRF currently contributes to Kepler's precision by supporting the selection of optimal pixels for aperture photometry ( §4.1), and providing high-precision PRF-fitted centroids ( §4.2) for attitude determination, crucial for removing the effects of pointing jitter from photometry. These are sufficient to attain Kepler's current high precision <ref type="bibr">(Jenkins et.al. 2010a</ref>). The future use of differential image analysis will use the PRF to perform target and pixel level sensitivity corrections, including local image motion, further increasing Kepler's precision. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">The Pixel Response Function</head><p>The Kepler PRF on an output channel is represented as a continuous piece-wise polynomial function of sub-pixel position on each pixel, providing a super-resolution image of the light of a star falling on the pixels. Pixel values are determined by evaluating the PRF given the pixel and sub-pixel position of a star: the pixel position determines where the PRF is placed in the output channel's pixel array, while the sub-pixel position determines the pixel values. <ref type="figure">Figure 1</ref> shows two example PRFs and corresponding pixel values.</p><p>Computation of the PRF from stellar images requires knowing where those images fall on the focal plane. Each star's coordinates are provided by the Kepler Input Catalog 1 (KIC), and the physical location of the CCDs relative to each other provided by the focal plane geometry (FPG) model ( §2.2). Determination of the FPG model, however, requires PRF-fitted stellar centroids ( §4.2), so FPG and PRF are mutually dependent. Therefore we determine both FPG and PRF in an iterative process ( §3.3).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.">Representation of the PRF</head><p>A Kepler PRF is defined on a grid of n × n pixels called the PRF pixel array, where n is large enough to capture the full PRF. Each pixel in the PRF pixel array is sub-divided into m × m sub-pixel regions. Each sub-pixel region is assigned a two-dimensional polynomial PRF i,j,s,t (x, y), where (i, j) are the pixels indices in the n × n PRF pixel array and (s, t) are the sub-pixel indices in the m × m sub-pixel grid on pixel (i, j). Therefore there are n 2 × m 2 two-dimensional polynomials associated with a PRF on an output channel. For most channels n = 11 is sufficient to capture the PRF, while for some channels n = 15 is required. We find m = 6 provides sufficient sub-pixel detail. The order of each of these polynomials is determined by a maximal information criterion ( §3.2). PRF polynomials are determined independently of each other, so they will not match at sub-pixel boundaries. We handle the resulting discontinuities using two strategies: (1) the discontinuities are minimized by fitting the PRF using data that extends into adjacent sub-pixel regions as described in 3.2 and (2) the remaining discontinuities are smoothed when evaluating the PRF as described in §2.3.</p><p>A position-dependent PRF is implemented by measuring five PRFs on each output channel: one at each corner and one at the center. Linear interpolation on the resulting triangles as described in §2.3 provides an interpolated PRF at any point in the output channel. This model neglects pixel-level variations, which are treated during calibration <ref type="bibr">(Jenkins et.al. 2010b</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.">Focal Plane Geometry</head><p>The focal plane geometry (FPG) model represents each of the 42 CCDs on the Kepler focal plane via the center position, rotation angle, and plate scale of each CCD. Prior to launch the CCD positions were known with an accuracy of ±3 pixels; the FPG model provides the required accuracy of ±0.1 pixels. The input to the FPG model computation is a two dimensional polynomial which maps right ascension and declination to pixel location. These motion polynomials are derived via a fit to the observed pixel positions of known stars via PRF centroiding ( §4.2), and serve as a smoothing filter, reducing the impact of observational errors of individual stars.</p><p>FPG computation determines the CCD locations of a set of sky coordinates in two ways: via the raDec2Pix library, which uses the FPG model; and via the motion polynomials, which do not use the FPG model. The FPG model parameters are adjusted via a Levenberg-Marquardt non-linear least squares algorithm until the differences between the model and observation are minimized. The FPG model computation also provides the spacecraft attitude.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.">From PRF to Pixel Values</head><p>The PRF provides expected pixel values for a given star with a given magnitude and sky location. The output channel and pixel position of the star is determined via the raDec2Pix library. This pixel position determines which triangle contains the star's central pixel, which determines which three (of five) PRFs are used to compute the star's final image.</p><p>Pixel values for the star are determined from each of the three PRFs by evaluating the PRF polynomials at the sub-pixel position of the star. On each pixel in the PRF pixel array the sub-pixel region containing the star's sub-pixel coordinates is chosen. The polynomial in that sub-pixel region is evaluated at the star's sub-pixel location, providing the relative flux for that pixel. This results in an array of n × n pixels reflecting the relative flux of the star based on that PRF.</p><p>When the sub-pixel location of a star is close to the boundary between sub-pixel patches, the following method smoothes out inter-patch discontinuities. The pixel value is evaluated using all nearby polynomial patches (two patches near an edge, four patches near a corner). Adjacent polynomial patches can be evaluated at these positions because patches are defined using data that extend into adjacent patches ( §3.2). For simplicity we consider the case of an edge, where we have two values v 1 and v 2 from the two polynomial patches adjacent at that edge. These values are smoothly interpolated using the distance z of the star's sub-pixel position from the edge with the formula v = w (z) v 1 + (1 − w (z)) v 2 . Here the weight w (z) is given, assuming z is normalized so that it ranges from 0 on one side of the edge to 1 on the other side of the edge, by <ref type="bibr" target="#b8">(Warner 1983)</ref> </p><formula xml:id="formula_0">w (z) = f (z) f (z) + f (1 − z) , f (z) = exp (−1/z a ) z &gt; 0 0 z ≤ 0.<label>(1)</label></formula><p>The scale factor a determines the steepness of the exponential curve. w (z) has the property that it is equal to 0 for z ≤ 0, equal to 1 for z ≥ 1, and equal to 0.5 for z = 0.5. Further, w (z) has continuous derivatives of all order, even at z = 0 and z = 1. This approach smoothly eliminates the discontinuity at the boundary between the polynomial patches.</p><p>The above process is repeated for all three PRFs defined on the triangle containing the star's central pixel, giving three n × n pixel arrays, one at the location of each PRF. These pixel arrays are linearly interpolated in the plane of the triangle, giving the final relative pixel values for this star. These relative pixel values are multiplied by the total flux of the star in the Kepler bandpass via the Kepler magnitude given by the Kepler input catalog. The final pixel array is then placed in the output channel pixel array in the location corresponding to the pixel position of the star. Repeating this process for every star on an output channel results in a synthetic image that should match the actual image observed in flight, assuming the KIC is accurate <ref type="figure">(Figure 2</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Measurement of the PRF</head><p>The PRF was measured during the commissioning phase of the Kepler mission, after the photometer was brought into final focus. The PRF measurement strategy was to collect observations of bright, uncrowded, unsaturated stars, which are used to fit the PRF polynomial patches.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">In-flight Observations</head><p>The PRF measurement used 19,189 stars in the Kepler field with magnitudes between 12 and 13 that did not have significant (&gt; 30%) flux from other stars in a 21 × 21 pixel aperture centered on the star. These stars were observed for 242 cadences of 14.7 minute duration, half a long cadence, to reduce the time required to perform the observations. Data for the PRF measurement were obtained from each odd cadence, while the spacecraft slewed to a new dither location during the even cadences. These 121 PRF data cadences visited the achieved locations shown in <ref type="figure">Figure 3</ref>, which were used in the PRF computation. The order of visitation of this pattern was randomized to minimize the impact of time-varying systematics.</p><p>The pixel values for each star are converted to relative pixel values by normalizing by the total flux from that star. The pixels from each star measurement of the 121 data cadences are treated as independent data points, resulting in 2,321,869 observations distributed on 84 output channels. The distribution was uneven, with some channels having many more stars than others.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2.">The PRF Computation</head><p>Two types of PRF are computed for each output channel: a single PRF using all targets, and a set of five PRFs to capture intra-channel PRF variation as described in §2.3. When computing the five-PRF set, the data for each of the five PRFs are selected from a region near where that PRF is defined. For each corner PRF the data is selected from a square extending from that corner into the input channel. For the central PRF the data is selected from a square centered on the output channel. The size of each square is set to include a specified minimum number of targets, so the squares on a crowded channel will be smaller than the squares on a channel with fewer stars. We find that ten stars is sufficient to create PRFs that capture the cores with good quality.</p><p>Once the data for a particular PRF is selected, the pixel data is grouped in two ways: (1) The integer pixel coordinates of each pixel are registered onto the n × n PRF pixel array so that the central pixel of the star corresponds to the central pixel of the PRF pixel array. (2) Each star's pixel is placed into a sub-pixel bin corresponding to the sub-pixel region containing that star. The sub-pixel bin covers a larger area than the sub-pixel region, providing overlapping data used for the polynomial fit, minimizing discontinuities between adjacent polynomial patches. For each pixel in the PRF pixel array, and for each sub-pixel region in that pixel, the kth pixel value p k is collected with its sub-pixel coordinates (x k , y k ). The PRF polynomial patch PRF (x k , y k ) for that sub-pixel region is the polynomial that minimizes</p><formula xml:id="formula_1">χ 2 = N k=1 1 σ k (p k − PRF (x k , y k )) 2 .<label>(2)</label></formula><p>Here N is the number of pixel values in this sub-pixel region for this pixel, and σ k is the uncertainty in the measurement of p k <ref type="figure" target="#fig_3">(Figure 4</ref>).</p><p>The order of the polynomial is determined by the modified Akaike information criterion <ref type="bibr" target="#b0">(Akaike 1974)</ref>. If</p><formula xml:id="formula_2">µ (o) = 1 N N k=1 (p k − PRF o (x k , y k )) 2 .<label>(3)</label></formula><p>is the mean square error of the polynomial fit PRF o for a given order o, then Akaike's modified information criterion selects the order that minimizes</p><formula xml:id="formula_3">2c + N log (µ (o)) + 2c (c − 1) N − c − 1 (4)</formula><p>where c is the number of coefficients in the polynomial PRF o for order o. The polynomial order will vary from sub-pixel region to sub-pixel region. The minimal solution to equation <ref type="formula" target="#formula_1">(2)</ref> is found using a fitting method that is robust against outliers.</p><p>A difficulty was encountered when computing PRFs in a five-PRF set. While the data was sufficient to capture the core of the PRF, the far wings were highly vulnerable to background pollution from dim background stars due to the small number of targets used. In contrast, the single PRFs computed on the same output channel using all the targets had, for the most part, well-behaved wings (we occasionally hand-edited the single PRF far wings to remove obvious background pollution). The solution was to replace polynomials in the far wings of the PRFs in the 5-PRF set with those from the corresponding pixel and subpixel regions from the single PRF. The region of replacement was determined by computing a contour of a manually determined background value that encloses the PRF core in each PRF of the five-PRF set. All polynomial patches outside that contour were replaced by polynomials from the single PRF. The resulting discontinuities were of the same magnitude as the discontinuities that already existed between polynomial patches.</p><p>The resulting PRFs do a good job of simulating pixel flux from the stars in the KIC, as shown in <ref type="figure">Figure 2</ref>. We find that central pixel energies vary across the Kepler focal plane, with 11% of the output channels having central pixel energies less than 0.3, 20% between 0.3 and 0.4, 37% between 0.4 and 0.5, 28% between 0.5 and 0.6, and 4% between 0.6 and 0.7.</p><p>There are several possible sources of PRF error, including:</p><p>• Changes in the statistics of spacecraft pointing jitter. This has remained stationary over time but is being monitored.</p><p>• Focus has changed slightly but measurably over time due to water desorption and thermal variations <ref type="bibr">(Jenkins et.al. 2010a</ref>).</p><p>• KIC errors, including variable stars and blends, can distort the measured PRF and cause errors for individual stars.</p><p>• CCD non-uniformities.</p><p>• The PRF computation did not attempt to include effects due to star color. Pre-flight simulated PRFs based on Code V simulations of the optical PSF from Ball Aerospace and Technologies Corporation indicate that color can have a non-trivial effect on the PRF.</p><p>The impact and mitigation of these errors is an area of active investigation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3.">The FPG/PRF Iteration</head><p>The computation described in §3.2 assumes that the pixel data have been calibrated, had their background removed, and that that Kepler attitude and FPG model are known. Pixel data calibration and background removal are performed by the same software from the Kepler SOC pipeline that is used to process Kepler science data <ref type="bibr">(Jenkins et.al. 2010b</ref>). The Kepler attitude and FPG model, however, are based on PRF centroiding ( §4.2). Therefore an iterative approach is required.</p><p>Two SOC modules are used: CAL, which performs pixel-level calibration, and PA which performs background characterization and removal as well as stellar centroiding and computation of motion polynomials (PA also performs aperture photometry during Kepler science processing, but PRF does not use this feature). Background-removed pixels are not persisted in the SOC pipeline, so the background removal function of PA must be called with each iteration.</p><p>PRF processing begins with a non-iterative bootstrap phase: Pixel data is calibrated by CAL, then PA is called with a pre-launch estimate of the PRF and FPG models that are used for centroiding and motion polynomial creation. At this point the iterative loop is entered: the FPG calculation provides an updated FPG model and attitude solution; PA performs background removal; the PRF computation described in §3.2 is performed; PA performs centroiding and motion polynomial computation using the updated PRF. The iteration is repeated until the FPG model is observed to converge.</p><p>To obtain convergence, it was necessary to "pin" the centroid of the PRF computed in §3.2 to a specific location because both PRF and FPG can move the location of a star image on a CCD. We chose to constrain the PRF so that the value-weighted centroid of all input pixel values is at the center of the PRF array.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">PRF Applications</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">Optimal Pixel Selection</head><p>There is a limit of 5.4 × 10 6 pixels per Kepler long cadence. Among these pixels are those chosen for stellar Kepler targets <ref type="bibr">(Bathala et.al. 2010</ref>). These pixels are selected to support high-precision aperture photometry of these targets: for each stellar target those pixels are selected which maximize the signal-to-noise ratio (SNR) for that target.</p><p>The selection process relies on synthetic images generated using the PRF, KIC and a zodiacal light model. For each target, two synthetic images are created: 1) an image that contains the target star only ("target") and 2) all stars except the target star, plus zodiacal light ("scene"). Both images include effects of saturation, charge transfer efficiency and smear induced by the lack of a shutter. The noise for each pixel p (in electrons) contains contributions from shot, read (σ read ) and quantization noise (σ quant ) <ref type="bibr">(Caldwell et.al. 2010)</ref> and is computed as σ = p target + p scene + σ 2 read + σ 2 quant . The SNR of the pixel is p target /σ.</p><p>The pixels are sorted in decreasing order of SNR. Starting with the first pixel, as each pixel is added the SNR of the collection of pixels is computed, and the collection of pixels that maximize the collection's SNR defines the optimal aperture for this target. Margin against PRF and KIC errors is provided by a ring of pixels placed around the optimal aperture, as well as a column of pixels on the left for undershoot correction ( <ref type="bibr" target="#b4">Haas et al. 2010</ref>). The result is the requested aperture for storage and downlinking.</p><p>Software on the Kepler spacecraft supports 1024 arbitrarily shaped spacecraft apertures, far fewer than the number of requested apertures. Therefore each requested aperture is assigned to the spacecraft aperture with the smallest number of pixels that contains the requested aperture. <ref type="figure">Figure 5</ref> shows example optimal and spacecraft apertures.</p><p>A synthetic image containing all stars in the KIC is used to determine background pixels that are stored, downlinked and used to build and remove a background model in SOC processing of the science targets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2.">Stellar Centroids</head><p>Centroid locations for unsaturated, sufficiently bright target stars are determined by PRF fitting: a non-linear fit is performed which varies the location and flux of the PRF, minimizing the χ 2 of the pixel-wise difference of the PRF-based pixel image ( §2.3) and the flight pixel values for that target. The resulting centroids show high stability, with changes over time of about 0.1 millipixels (after removing systematic effects). Errors in the PRF model induce local biases, which exhibit a median of about 1 millipixel and median absolute deviation of 22 millipixels pixels, across the focal plane.  </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>A</head><label></label><figDesc>star's position on the Kepler focal plane is computed with the software package raDec2Pix, developed by the Kepler Science Operations Center (SOC). This package uses the Kepler Focal Plane Geometry (FPG) model ( §2.2), as well as Kepler optical, nominal spacecraft attitude, and velocity aberration models.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>Each pixel of the PRF pixel array gives the flux on that pixel from a star whose location is in the central pixel of the PRF pixel array. Thus the central pixel represents the peak of the star's PRF while pixels towards the edge represent the flux in the wings of that star's PRF. The values of these fluxes depend on the sub-pixel position of the star.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 1 .Fig. 2 .Fig. 3 .sub</head><label>123</label><figDesc>Fig. 1.-Two example PRFs. Left column: a PRF near the edge of the focal plane. Right column: a PRF near the focal plane center. Top row: the PRF model contours. Bottom row: the PRF converted into pixel values for a star centered on a pixel.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4.-An example of a PRF polynomial patch fitted to data. The domain of the data is larger than the domain of the patch to reduce the size of discontinuities between patches.</figDesc></figure>

			<note place="foot" n="1"> http://archive.stsci.edu/kepler/kepler fov/search.php</note>
		</body>
		<back>
			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">H</forename><surname>Akaike</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Automatic Control</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page">716</biblScope>
			<date type="published" when="1974" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">V</forename><forename type="middle">S</forename><surname>Argabright</surname></persName>
		</author>
		<idno>SPIE 7010</idno>
		<imprint>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><surname>Bathala</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">327</biblScope>
			<biblScope unit="issue">5968</biblScope>
			<biblScope unit="page">977</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>ApJ</note>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">A</forename><surname>Caldwell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>in press</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><forename type="middle">R</forename><surname>Haas</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>in press</note>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Jenkins</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>in press</note>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">M</forename><surname>Jenkins</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>ApJ. in press</note>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">T</forename><forename type="middle">R</forename><surname>Lauer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PASP</title>
		<imprint>
			<biblScope unit="volume">111</biblScope>
			<biblScope unit="issue">765</biblScope>
			<biblScope unit="page">1434</biblScope>
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">W</forename><surname>Warner</surname></persName>
		</author>
		<title level="m">Foundations of Differentiable Manifolds and Lie Groups</title>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="1983" />
		</imprint>
	</monogr>
	<note>This preprint was prepared with the AAS L A T E X macros v5.2</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
