<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /mnt/ResearchCloud/Projects/ExoPlanets/notebooks/grobid/grobid-0.5.2/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.5.2" ident="GROBID" when="2018-12-04T16:20+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">BGLS: A Bayesian formalism for the generalised Lomb-Scargle periodogram</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014-12-02">December 2, 2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Mortier</surname></persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">SUPA</orgName>
								<orgName type="department" key="dep2">School of Physics and Astronomy</orgName>
								<orgName type="institution">University of St Andrews</orgName>
								<address>
									<postCode>KY16 9SS</postCode>
									<settlement>St Andrews</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Centro de Astrofísica</orgName>
								<orgName type="institution">Universidade do Porto</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">P</forename><surname>Faria</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Centro de Astrofísica</orgName>
								<orgName type="institution">Universidade do Porto</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Instituto de Astrofísica e Ciências do Espaço</orgName>
								<orgName type="institution" key="instit1">Universidade do Porto</orgName>
								<orgName type="institution" key="instit2">CAUP</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="department" key="dep1">Departamento de Física e Astronomia</orgName>
								<orgName type="department" key="dep2">Faculdade de Ciências</orgName>
								<orgName type="institution">Universidade do Porto</orgName>
								<address>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><forename type="middle">M</forename><surname>Correia</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Centro de Astrofísica</orgName>
								<orgName type="institution">Universidade do Porto</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Instituto de Astrofísica e Ciências do Espaço</orgName>
								<orgName type="institution" key="instit1">Universidade do Porto</orgName>
								<orgName type="institution" key="instit2">CAUP</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Santerne</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Centro de Astrofísica</orgName>
								<orgName type="institution">Universidade do Porto</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Instituto de Astrofísica e Ciências do Espaço</orgName>
								<orgName type="institution" key="instit1">Universidade do Porto</orgName>
								<orgName type="institution" key="instit2">CAUP</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">C</forename><surname>Santos</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Centro de Astrofísica</orgName>
								<orgName type="institution">Universidade do Porto</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Instituto de Astrofísica e Ciências do Espaço</orgName>
								<orgName type="institution" key="instit1">Universidade do Porto</orgName>
								<orgName type="institution" key="instit2">CAUP</orgName>
								<address>
									<addrLine>Rua das Estrelas</addrLine>
									<postCode>4150-762</postCode>
									<settlement>Porto</settlement>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="department" key="dep1">Departamento de Física e Astronomia</orgName>
								<orgName type="department" key="dep2">Faculdade de Ciências</orgName>
								<orgName type="institution">Universidade do Porto</orgName>
								<address>
									<country key="PT">Portugal</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">BGLS: A Bayesian formalism for the generalised Lomb-Scargle periodogram</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2014-12-02">December 2, 2014</date>
						</imprint>
					</monogr>
					<note>Astronomy &amp; Astrophysics manuscript no. 24908_ap c ESO 2014 Received ...; Accepted ...</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords>Methods: data analysis -Methods: statistical</keywords>
			</textClass>
			<abstract>
				<p>Context. Frequency analyses are very important in astronomy today, not least in the ever-growing field of exoplanets, where short-period signals in stellar radial velocity data are investigated. Periodograms are the main (and powerful) tools for this purpose. However, recovering the correct frequencies and assessing the probability of each frequency is not straightforward. Aims. We provide a formalism that is easy to implement in a code, to describe a Bayesian periodogram that includes weights and a constant offset in the data. The relative probability between peaks can be easily calculated with this formalism. We discuss the differences and agreements between the various periodogram formalisms with simulated examples. Methods. We used the Bayesian probability theory to describe the probability that a full sine function (including weights derived from the errors on the data values and a constant offset) with a specific frequency is present in the data. Results. From the expression for our Baysian generalised Lomb-Scargle periodogram (BGLS), we can easily recover the expression for the non-Bayesian version. In the simulated examples we show that this new formalism recovers the underlying periods better than previous versions. A Python-based code is available for the community.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Analysing unevenly sampled data in search for a periodic signal is very important in astronomy today. In the evergrowing search for exoplanets, for example, scientists search for periodicities in the radial velocity data of a star to detect a signal that can be attributed to an orbiting planet. When analysing the intensity of stellar activity, we also search for periodic signals, for example in the activity indicator log(R HK ), or in the photometric light curves (e.g. <ref type="bibr" target="#b5">Dumusque et al. 2012;</ref><ref type="bibr" target="#b1">Bastien et al. 2014</ref>). In the field of asteroseismology, correctly finding periodic signals in the data is of great importance as well (e.g. <ref type="bibr" target="#b0">Aerts et al. 2010)</ref>.</p><p>From a historical point of view, one of the main tools used in the frequency analysis of unevenly spaced time series is the Lomb-Scargle periodogram <ref type="bibr">(LS -Lomb 1976;</ref><ref type="bibr" target="#b8">Scargle 1982)</ref>. This LS periodogram, although useful, suffers from several drawbacks. First, it does not weigh the data points in any way. Secondly, it does not include a constant offset in the data. These two points, however, are very important when handling real observational data where some data points may be more precise than others due to observing conditions, for instance. The zeropoint of the data is typically not known exactly, either, https://www.astro.up.pt/exoearths/tools.html which is very important in the case of irregularly sampled data. These problems were already accounted for by e.g. <ref type="bibr" target="#b6">Ferraz-Mello (1981)</ref>, <ref type="bibr" target="#b4">Cumming et al. (1999)</ref>, <ref type="bibr" target="#b9">Zechmeister &amp; Kürster (2009)</ref>, resulting in a generalised LS periodogram (GLS) including weights and an offset.</p><p>The final drawback of the LS is also still present in the GLS. Both periodograms are expressed in an arbitrary power, which makes it difficult to compare one peak to another. To better assess the relative probability between two peaks, Bretthorst (2001) generalised the LS periodogram by using Bayesian probability theory. The resulting Bayesian LS periodogram (BLS) is in many ways similar to the regular LS periodogram, but the probability resulting from the BLS is much more informative than the arbitrary power in the LS.</p><p>In this work, we follow the formalisms of <ref type="bibr" target="#b3">Bretthorst (2001)</ref> and <ref type="bibr" target="#b9">Zechmeister &amp; Kürster (2009)</ref> to extend the GLS one step further by using Bayesian probability theory. This results in a Bayesian generalised Lomb-Scargle periodogram (BGLS). In Sect. 2 we derive the equations needed for the BGLS, with a special case described in Sect. 3. Section 4 gives two examples based on simulated data to show the differences and agreements between the four discussed periodograms (LS, BLS, GLS, BGLS). We conclude in Sect. 5. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Formalism</head><p>A periodic signal in time series data can be described by a full sine function, including an offset and the errors on the observations. The model we used for the data is</p><formula xml:id="formula_0">d(t i ) = d i = A cos(2πf t i − θ) + B sin(2πf t i − θ) + γ + i , (1)</formula><p>where d i is the data point taken at time t i , A and B are the cosine and sine amplitudes, f is the signal frequency, θ is an arbitrary phase offset that we defined below, γ is the data offset, and i is the noise at time t i . This noise is per time t i Gaussian-distributed around 0 with a standard deviation of σ i , which is the estimated uncertainty on the data at time t i ( i ∼ N (0, σ i )).</p><p>We are interested in the posterior probability of the frequency given the data D and our prior knowledge I, P (f |D, I). By marginalisation, we can write this (posterior) probability function as</p><formula xml:id="formula_1">P (f |D, I) = P (f ABγ|D, I) dA dB dγ,<label>(2)</label></formula><p>where the frequency probability is calculated from the joint posterior probability of the three parameters A, B, and γ. By applying Bayes theorem (Bayes &amp; Price 1763), we can write that</p><formula xml:id="formula_2">P (f ABγ|D, I) = P (D|f ABγ, I)P (f ABγ|I) P (D|I) .<label>(3)</label></formula><p>The evidence, P (D|I), is a constant, and since we are only interested in the relative probability between frequencies, we can ignore this normalising factor. Furthermore, for the priors, P (f ABγ|I), we assume that all the parameters f, A, B, and γ are independent, and we take the prior probability for each parameter as uniform. This assumption leads to an equal treatment of all possible signals in the data. With these assumptions, we can use the product rule for joint probabilities:</p><formula xml:id="formula_3">P (f ABγ|I) = P (f |I)P (A|I)P (B|I)P (γ|I) = ct,<label>(4)</label></formula><p>with ct a constant that we can again ignore. This all leads to the fact that our posterior probability function is proportional to the integrated likelihood:</p><formula xml:id="formula_4">P (f |D, I) ∝ P (D|f ABγ, I) dA dB dγ.<label>(5)</label></formula><p>To describe this likelihood analytically, we use the fact that the probability of the data is the same as the probability of the noise. This noise is normally distributed around 0, with the standard deviation σ i for each time t i . We derive</p><formula xml:id="formula_5">P (D|f ABγ, I) = N i=1 1 √ 2πσ i exp − 2 i 2σ 2 i (6) = N i=1 1 √ 2πσ i exp − 1 2 N i=1 i σ i 2 . (7)</formula><p>The first factor in this expression can again be ignored and placed into the normalising factor. We use the standard deviations σ i to assign the weights of the datapoints. The weight w i can be written as</p><formula xml:id="formula_6">w i = 1 σ 2 i .<label>(8)</label></formula><p>The noise i can be written in terms of the observables by using Eq. 1. To simplify the expressions, we introduce some definitions. We try to use the same expressions as in <ref type="bibr" target="#b9">Zechmeister &amp; Kürster (2009)</ref> so that it is easy to compare between the two formalisms.</p><formula xml:id="formula_7">W = N i=1 w i (9) Y = N i=1 w i d i (10) Y Y = N i=1 w i d 2 i (11) Y C = N i=1 w i d i cos(2πf t i − θ) (12) Y S = N i=1 w i d i sin(2πf t i − θ) (13) C = N i=1 w i cos(2πf t i − θ)<label>(14)</label></formula><formula xml:id="formula_8">S = N i=1 w i sin(2πf t i − θ) (15) CC = N i=1 w i cos 2 (2πf t i − θ) (16) SS = N i=1 w i sin 2 (2πf t i − θ).<label>(17)</label></formula><p>Furthermore, we define θ such that the cosine and sine functions are orthogonal (for the proof, see Appendix A):</p><formula xml:id="formula_9">θ = 1 2 tan −1 w i sin(4πf t i ) w i cos(4πf t i ) .<label>(18)</label></formula><p>Using all these definitions, we find that</p><formula xml:id="formula_10">N i=1 i σ i 2 = Y Y − 2A Y C − 2B Y S − 2γY + A 2 CC + B 2 SS + γ 2 W + 2AγC + 2BγS .<label>(19)</label></formula><p>Using this expression, we can now split the integrals from Eq. 5 into three separate integrals. First, we consider the integrals in A and B. These can be written as </p><formula xml:id="formula_11">+∞ −∞ exp − CCA 2 − 2 Y CA + 2γCA 2 dA (20) +∞ −∞ exp − SSB 2 − 2 Y SB + 2γSB 2 dB.<label>(21)</label></formula><p>From now on, we assume that CC and SS are strictly positive. Since cos 2 x ≥ 0 and sin 2 x ≥ 0, it follows that these expressions are positive. We explore the special cases where one of them is zero in Sect. 3. If they are strictly positive, we can easily solve the integrals in A and B using</p><formula xml:id="formula_12">+∞ −∞ e −ax 2 e −2bx dx = π a exp b 2 a .<label>(22)</label></formula><p>Finally, only the integral in γ remains, and our posterior probability function is proportional to</p><formula xml:id="formula_13">P (f |D, I) ∝ 1 CC SS exp(Kγ 2 + Lγ + M )dγ,<label>(23)</label></formula><p>where we have introduced the following functions of the frequency f :</p><formula xml:id="formula_14">K = C 2 SS + S 2 CC − W CC SS 2 CC SS (24) L = Y CC SS − C Y C SS − S Y S CC CC SS (25) M = Y C 2 SS + Y S 2 CC 2 CC SS .<label>(26)</label></formula><p>To solve the integral in Eq. 23, we can again use Eq. 22 since K &lt; 0. For data sets with N ≥ 3 (a frequency analysis is only useful for datasets with at least three datapoints) and unevenly spaced datapoints, this is always the case. We then finally obtain that</p><formula xml:id="formula_15">P (f |D, I) ∝ 1 |K| CC SS exp M − L 2 4K .<label>(27)</label></formula><p>As can be seen from <ref type="bibr">Eq. 20 in Zechmeister &amp; Kürster (2009)</ref>, the power calculated in the GLS is proportional to M . The probability calculated by the BGLS is related to the GLS as it gives an exponential where part of the exponent is exactly the power from the GLS. The BGLS is thus very similar to the GLS, just as the BLS is similar to the LS (see discussion in Bretthorst 2001).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Special case</head><p>In the previous section, we have assumed that CC and SS are strictly positive. Now, we consider the case when one of them is zero 1 . This can be the case if, for a specific frequency f , all datapoints t i can be expressed as</p><formula xml:id="formula_16">2f t i = 2f t 1 + k, k ∈ Z.<label>(28)</label></formula><p>1 They cannot be zero at the same time.</p><p>Basically, this means that the data are equally spaced, while gaps without observations are allowed. From Eq. 18 we can then derive that</p><formula xml:id="formula_17">θ = 2πf t 1 + k π 2 , k ∈ Z.<label>(29)</label></formula><p>By placing these two expressions together, we obtain that</p><formula xml:id="formula_18">2πf t i − θ = k π 2 , k ∈ Z.<label>(30)</label></formula><p>Now, CC and SS will be zero if k is odd or even, respectively. If k is even, we see that</p><formula xml:id="formula_19">SS = S = Y S = 0.<label>(31)</label></formula><p>With these simplified expressions, we find that the integral in B is proportional to a constant. The integral in A can still be solved, and we can follow the same reasoning as in the previous section. Accordingly, the BGLS can be expressed as</p><formula xml:id="formula_20">P (f |D, I) ∝ 1 |K C | CC exp M C − L 2 C 4K C ,<label>(32)</label></formula><p>where we have used the following definitions:</p><formula xml:id="formula_21">K C = C 2 − W CC 2 CC<label>(33)</label></formula><formula xml:id="formula_22">L C = Y CC − C Y C CC (34) M C = Y C 2 2 CC .<label>(35)</label></formula><p>For the case where k in Equation 30 is odd, we can reason the same way, but now all the terms with cosines are zero and the terms with sines are left (introducing the three functions K S , L S , and M S ).</p><p>These cases may occur for equally spaced data sets (even if they have gaps). With real ground-based observations, it is very unlikely that these cases would ever occur. However, this is more likely for space-based surveys, where the observations are made at fixed times following the spacecraft clock. Therefore the frequencies for which these special cases apply need to be checked always.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Simulated examples</head><p>In this section we provide two examples of simulated data sets that expose the differences between the LS, the GLS and their Bayesian versions.</p><p>The main difference between the non-Bayesian and the Bayesian periodograms lies in the peak comparison, as already mentioned in the introduction. Non-Bayesian periodograms use an arbitrary power, which makes it difficult to assess the importance of specific periods over other periods in the data. Bayesian periodograms, on the other hand, express the probability that a signal with a specific period Simulated data (black points) to show the effect of weighting the datapoints using the errorbars. The real underlying signal with a period of 105 days and a semi-amplitude of 1 is represented by the black curve.</p><p>is present in the data. The relative probability between two periods can then be easily assessed. In the examples below, we show that the Baysian periodograms typically have one very clear peak (probability-wise), in contrast to their non-Bayesian versions.</p><p>Differences between the non-generalised and the generalised periodograms always have to do with the fact that the (B)GLS includes weights and a possible offset in the data. Below, we give an example of the effect of each of these additions using simulated data 2 . For every example we provide the LS and GLS expressed in the arbitrary power and the BLS and BGLS expressed in a normalised probability (so that the highest peak represents 100% probability). We show the Bayesian periodograms on a linear scale and on a logscale, where it is clearer that they are indeed linked to their non-Bayesian versions. Note that the plots on logscale show a horizontal offset between the BLS and BGLS. This is due to the normalisation of the highest peak to 100%.</p><p>To consider the weighting of the data points, we simulated 100 unevenly spaced data points over a range of 180 days. The real underlying signal in these data has a period of 105 days and a semi-amplitude of 1. Half of the points have a mean error bar of 0.4, the other half have a mean error bar of 1.1. Furthermore, by this addition of random white noise, the less precise points also deviate more from the underlying periodic signal. In real observations, this can easily occur because the precision of measurements strongly depends on the observing conditions (e.g. seeing, exposure time, instrument setup), and periodic signals hidden in the data often have semi-amplitudes of the order of the error bars.</p><p>The simulated data and the real underlying signal are shown in <ref type="figure">Fig. 1</ref>. The resulting periodograms are shown in <ref type="figure" target="#fig_2">Fig. 2</ref>. While the 105-day period signal is clearly detected by the (B)GLS, the (B)LS does not single out that period as the most significant. Instead, it settles on a period of around 50 days. In both the non-Bayesian and Bayesian <ref type="bibr">2</ref> We chose to label the ordinates as RV and they are expressed in arbitrary units. periodograms, this is clear. Furthermore, the second peak in the (B)LS lies not exactly at 105 days either, but more towards a slightly shorter period.</p><p>Including a constant offset in the data analysis allows for the mean of the data to be different from the mean of the fitted sine function. These two means can be very different depending on the sampling of the data. For real observations, especially if they are ground-based, the sampling is constrained by the observation opportunities (night versus day, weather conditions, seasonal visibility, etc.). To illustrate the effect of this periodic sampling and thus the inclusion of an offset, we simulated 100 unevenly spaced data points over a range of 170 days. The real underlying signal in these data has a period of 50 days, a semi-amplitude of 1, and a mean of zero. The data were chosen so that most points lie above −0.3 thus creating large gaps in the data of almost no observations.</p><p>The simulated data are shown in <ref type="figure">Fig. 3</ref> together with the underlying sine function. The data have a mean of 0.5484, substantially different from the mean of the underlying sine function, which is zero. The resulting periodograms are shown in <ref type="figure" target="#fig_3">Fig. 4</ref>. It is immediately clear that only the GLS and BGLS are able to correctly identify the true period. It is also interesting to note that the GLS shows two peaks of about the same height at 50 and 25 days. By using the GLS alone, it would not be possible to know unambiguously which period is the real one in the data. In the BGLS, on the other hand, it is very clear that the longer period (which is the true one) is about 10 1 0 times more probable than the other period.</p><p>If the data are randomly sampled and include an offset, the mean of the data will be close enough to the value of this offset so that it can easily be subtracted. In this case, all four periodograms we discussed will identify the correct period. More details can be found in Appendix B.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Conclusion</head><p>We formulated an expression for calculating the Bayesian generalised Lomb-Scargle periodogram (given in Eq. 27). Part of the exponent in that expression is the power for the GLS as given by <ref type="bibr" target="#b9">Zechmeister &amp; Kürster (2009)</ref>, clearly linking the two expressions. A Python-based code is available for the community at https://www.astro.up.pt/ exoearths/tools.html.</p><p>This expression is valid for all unevenly sampled datasets for which Eq. 30 does not hold for all even or all odd values of k. If these equations would hold anyway, we provided the corresponding (simplified) expressions in Sect. 3.</p><p>We repeat that this formalism was reached by making some assumptions. First, we assumed that the parameters f , A, B, and γ are independent. Second, we assumed uniform priors for these parameters. The same assumptions were made in <ref type="bibr" target="#b3">Bretthorst (2001)</ref>. If different assumptions were used, the formalisms in either works are no longer valid.</p><p>We simulated two datasets to show the differences between the LS, BLS, GLS, and BGLS. We showed that the generalised periodograms work best for recovering the correct frequencies. Furthermore, we showed that for two peaks with similar heights in the GLS, the BGLS can clarify which peak is the more probable and by how much. We therefore conclude that the BGLS is the most powerful way to explore periodicities in unevenly spaced datasets.</p><p>As a final note, we caution that the four periodograms we described and used all assume a single-frequency signal in the data. If multiple frequencies are present in the data (with similar or different amplitudes), all of these formalisms can fail in detecting the correct frequencies. There are some codes in the literature to make multi-frequency periodograms (e.g. <ref type="bibr">Baluev 2013</ref>). However, these also rely on single-frequency periodograms for an initial assessment of the possible frequencies since correctly calculating a multifrequency periodogram needs too much computing time <ref type="bibr">(Baluev 2013</ref>). Furthermore, we note that a periodogram gives no information about the physical nature of the signal it detects, and one should always be careful with using the periodogram output.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix A: Proof for equation 18</head><p>If the cosine and sine functions are orthogonal, it holds that</p><formula xml:id="formula_23">N i=1 w i sin(2πf t i − θ) cos(2πf t i − θ) = 0. (A.1)</formula><p>We can evaluate the sine and the cosine by using the trigonometric addition formulae:</p><formula xml:id="formula_24">sin(2πf t i − θ) = sin(2πf t i ) cos θ − cos(2πf t i ) sin θ (A.2) cos(2πf t i − θ) = cos(2πf t i ) cos θ + sin(2πf t i ) sin θ. (A.3)</formula><p>The product of the sine and cosine then becomes</p><formula xml:id="formula_25">sin(2πf t i ) cos(2πf t i ) cos 2 θ + sin 2 (2πf t i ) sin θ cos θ − sin(2πf t i ) cos(2πf t i ) sin 2 θ − cos 2 (2πf t i ) sin θ cos θ. (A.4)</formula><p>Now we can use the double-angle formulae to derive that Eq. A.1 can be written as</p><formula xml:id="formula_26">N i=1 w i sin(4πf t i ) cos(2θ) = N i=1 w i cos(4πf t i ) sin(2θ). (A.5)</formula><p>From here it easily follows that</p><formula xml:id="formula_27">tan(2θ) = w i sin(4πf t i ) w i cos(4πf t i ) , (A.6)</formula><p>and thus that Eq. 18 holds,</p><formula xml:id="formula_28">θ = 1 2 tan −1 w i sin(4πf t i ) w i cos(4πf t i ) . (A.7)</formula><p>Appendix B: Example with offset on randomly sampled data</p><p>To illustrate the effect of an offset if the data are randomly sampled, we include here an additional example. We simulated 100 unevenly spaced, but randomly sampled data points over a range of 180 days. The real underlying signal in these data has a period of 50 days, a semi-amplitude of 1, and an offset of 2.5. To calculate the LS and the BLS, the mean of the data is subtracted first. In this case, the mean is 2.42, thus very close to the offset value. The simulated data, including the offset, is shown in <ref type="figure">Fig. B.1</ref> together with the underlying sine function, which includes no offset. The resulting periodograms are shown in <ref type="figure" target="#fig_2">Fig. B.2</ref>. As expected, the four periodograms all identify the same (and correct) period. From the Bayesian periodograms, it is clear that the identified period is more probable using the BGLS than it is using the BLS (though both are highly significant). This is because the mean of the data is very close to the offset value, but not exactly the offset value. Simulated data (black points) to show the effect of an offset (of 2.5) on randomly sampled data. The underlying signal with a period of 50 days and a semi-amplitude of 1 is represented without the offset (black curve). </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>Fig. 1. Simulated data (black points) to show the effect of weighting the datapoints using the errorbars. The real underlying signal with a period of 105 days and a semi-amplitude of 1 is represented by the black curve.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Periodograms of the simulated data from Fig. 1. The top panel shows the non-Bayesian versions, the middle and bottom panels show the Bayesian versions on a linear and logscale.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Periodograms of the simulated data from Fig. 3. The top panel shows the non-Bayesian versions, the middle and bottom panels show the Bayesian versions on a linear and logscale.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><label></label><figDesc>Fig. B.1. Simulated data (black points) to show the effect of an offset (of 2.5) on randomly sampled data. The underlying signal with a period of 50 days and a semi-amplitude of 1 is represented without the offset (black curve).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><label></label><figDesc>Fig. B.2. Periodograms of the simulated data from Fig. B.1. The top panel shows the non-Bayesian versions, the middle and bottom panel show the Bayesian versions on a linear and logscale.</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Aerts</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Christensen-Dalsgaard</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">D</forename><forename type="middle">W</forename><surname>Kurtz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Asteroseismology Baluev, R. V</title>
		<imprint>
			<biblScope unit="volume">436</biblScope>
			<biblScope unit="page">807</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>MNRAS</note>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><forename type="middle">A</forename><surname>Bastien</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">K</forename><forename type="middle">G</forename><surname>Stassun</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><surname>Pepper</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">AJ</title>
		<imprint>
			<biblScope unit="volume">147</biblScope>
			<biblScope unit="page">29</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Bayes</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Price</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Philosophical Transactions</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page">370</biblScope>
			<date type="published" when="1763" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
				<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">L</forename><surname>Bretthorst</surname></persName>
		</author>
		<title level="m">Bayesian Inference and Maximum Entropy Methods in Science and Engineering</title>
		<editor>A. Mohammad-Djafari</editor>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="volume">568</biblScope>
			<biblScope unit="page" from="241" to="245" />
		</imprint>
	</monogr>
	<note>American Institute of Physics Conference Series</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">A</forename><surname>Cumming</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">G</forename><forename type="middle">W</forename><surname>Marcy</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">R</forename><forename type="middle">P</forename><surname>Butler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">526</biblScope>
			<biblScope unit="page">890</biblScope>
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">X</forename><surname>Dumusque</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">F</forename><surname>Pepe</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">C</forename><surname>Lovis</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">491</biblScope>
			<biblScope unit="page">207</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">S</forename><surname>Ferraz-Mello</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">AJ</title>
		<imprint>
			<biblScope unit="volume">86</biblScope>
			<biblScope unit="page">619</biblScope>
			<date type="published" when="1981" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">N</forename><forename type="middle">R</forename><surname>Lomb</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ap&amp;SS</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page">447</biblScope>
			<date type="published" when="1976" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">J</forename><forename type="middle">D</forename><surname>Scargle</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ApJ</title>
		<imprint>
			<biblScope unit="volume">263</biblScope>
			<biblScope unit="page">835</biblScope>
			<date type="published" when="1982" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title/>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Zechmeister</surname></persName>
		</author>
		<author>
			<persName xmlns="http://www.tei-c.org/ns/1.0"><forename type="first">M</forename><surname>Kürster</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">A&amp;A</title>
		<imprint>
			<biblScope unit="volume">496</biblScope>
			<biblScope unit="page">577</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
